---
title: Tek kapsayıcı dağıtma .NET Core Web uygulamaları Linux veya Windows Nano sunucu konaklarına göre
description: Kapsayıcılı .NET uygulamaları için .NET mikro hizmet mimarisi | Tek kapsayıcı dağıtma .NET Core Web uygulamaları Linux veya Windows Nano sunucu konaklarına göre
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 06/27/2018
ms.openlocfilehash: 45be99a86a52ed450b795ca5f91c01ab82c7da47
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43539705"
---
# <a name="deploying-single-container-based-net-core-web-applications-on-linux-or-windows-nano-server-hosts"></a><span data-ttu-id="1f5b9-103">Linux veya Windows Nano sunucu konaklarına tek kapsayıcı tabanlı .NET Core Web uygulamaları dağıtma</span><span class="sxs-lookup"><span data-stu-id="1f5b9-103">Deploying Single-Container-Based .NET Core Web Applications on Linux or Windows Nano Server Hosts</span></span>

<span data-ttu-id="1f5b9-104">_Docker kapsayıcıları tek parça daha basit web uygulamaları dağıtımını için kullanabilirsiniz. Bu artırır sürekli tümleştirme ve sürekli dağıtım işlem hatları ve üretim için dağıtım başarı elde etmenize yardımcı olur. Daha fazla "neden üretimde çalışmaz makineme çalışır?"_</span><span class="sxs-lookup"><span data-stu-id="1f5b9-104">_You can use Docker containers for monolithic deployment of simpler web applications. This improves continuous integration and continuous deployment pipelines and helps achieve deployment-to-production success. No more “It works in my machine, why does it not work in production?”_</span></span>

<span data-ttu-id="1f5b9-105">Bir mikro hizmet tabanlı mimariye pek çok faydası vardır, ancak bu avantajlar bulunan artan karmaşıklık bedeli.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-105">A microservices-based architecture has many benefits, but those benefits come at a cost of increased complexity.</span></span> <span data-ttu-id="1f5b9-106">Bazı durumlarda, maliyetleri ağır basıyor ve bir veya birkaç kapsayıcılarda çalıştırılan bir tek parçalı dağıtım uygulaması daha iyi bir seçenektir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-106">In some cases, the costs outweigh the benefits and a monolithic deployment application running in one or a few containers is a better option.</span></span>

<span data-ttu-id="1f5b9-107">Tek parça bir uygulamayı kolayca iyi ayrılmış mikro hizmetler halinde decomposable olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-107">A monolithic application might not be easily decomposable into well-separated microservices.</span></span> <span data-ttu-id="1f5b9-108">Bu mikro işlevi tarafından bölümlendirilmelidir öğrendiniz: karşı daha dayanıklı bir uygulama sağlamak için birbirinden çalışması gerekir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-108">You've learned that these microservices should be partitioned by function: they should work independently of each other to provide a more resilient application.</span></span> <span data-ttu-id="1f5b9-109">Uygulamanın özellik dilimleri teslim edilemiyor, bu ayırma karmaşıklık yalnızca ekler.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-109">If you can't deliver feature slices of the application, separating it only adds complexity.</span></span>

<span data-ttu-id="1f5b9-110">Bir uygulama, özelliklerin bağımsız olarak ölçeklendirme henüz gerekmeyebilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-110">An application might not yet need to scale features independently.</span></span> <span data-ttu-id="1f5b9-111">Erken aşamalarında varsayalım, `eShopOnContainers` başvuru uygulaması, trafik farklı mikro hizmetler halinde özellikleri ayırma Yasla alamadık.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-111">Let’s suppose that in the early stages of the `eShopOnContainers` reference application, the traffic didn't justify separating features into different microservices.</span></span> <span data-ttu-id="1f5b9-112">Trafiği bir hizmet için kaynak ekleme, genellikle tüm hizmetler için kaynak ekleme geliyordu kadar küçük.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-112">Traffic was small enough that adding resources to one service typically meant adding resources to all services.</span></span> <span data-ttu-id="1f5b9-113">Ayrık Hizmetleri uygulamasına ayırmak için ek iş en az bir avantaj sağladı.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-113">The additional work to separate the application into discrete services provided minimal benefit.</span></span>

<span data-ttu-id="1f5b9-114">Ayrıca, bir uygulamanın erken geliştirme, dair NET bir fikir doğal işlevsel sınırları nerede sahip olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-114">Also, early in the development of an application you might not have a clear idea where the natural functional boundaries are.</span></span> <span data-ttu-id="1f5b9-115">En düşük uygun bir ürün geliştirirken, doğal ayrımı henüz çıkmıştır değil.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-115">As you develop a minimum viable product, the natural separation might not yet have emerged.</span></span>

<span data-ttu-id="1f5b9-116">Bu koşullar bazıları geçici olabilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-116">Some of these conditions might be temporary.</span></span> <span data-ttu-id="1f5b9-117">Tek parça bir uygulamayı oluşturun ve daha sonra bazı özellikleri geliştirilen ve mikro hizmet dağıtılan ayrı.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-117">You might start by creating a monolithic application, and later separate some features to be developed and deployed as microservices.</span></span> <span data-ttu-id="1f5b9-118">Diğer koşullar, uygulamanın birden fazla mikro hizmetler halinde hiçbir zaman bozuk durumda, yani, uygulamanın sorun alanı için gerekli olabilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-118">Other conditions might be essential to the application’s problem space, meaning that the application might never be broken into multiple microservices.</span></span>

<span data-ttu-id="1f5b9-119">Bir uygulamaya birçok ayrı işlemler ayırma yükü tanıtır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-119">Separating an application into many discrete processes also introduces overhead.</span></span> <span data-ttu-id="1f5b9-120">Özellikler farklı işlemlere ayırmak daha karmaşık yoktur.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-120">There's more complexity in separating features into different processes.</span></span> <span data-ttu-id="1f5b9-121">İletişim protokolleri, daha karmaşık hale gelir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-121">The communication protocols become more complex.</span></span> <span data-ttu-id="1f5b9-122">Yerine yöntem çağrılarını, hizmetler arasında zaman uyumsuz iletişim kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-122">Instead of method calls, you must use asynchronous communications between services.</span></span> <span data-ttu-id="1f5b9-123">Bir mikro hizmet mimarisi için taşırken, mikro hizmetler sürümünde yapılan yapı taşlarını birçoğu eklemenize gerek `eShopOnContainers` uygulama: olay veri yolu işleme, ileti dayanıklılık ve yeniden denemeler, nihai tutarlılığa kadar giden ve daha fazla.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-123">As you move to a microservices architecture, you need to add many of the building blocks implemented in the microservices version of the `eShopOnContainers` application: event bus handling, message resiliency and retries, eventual consistency, and more.</span></span>

<span data-ttu-id="1f5b9-124">Hizmetine daha basitleştirilmiş bir sürümünü (adlı [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) ve aynı GitHub deposunda dahil) tek parça bir MVC uygulaması çalışır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-124">A much-simplified version of eShopOnContainers (named [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) and included in the same GitHub repository) runs as a monolithic MVC application.</span></span> <span data-ttu-id="1f5b9-125">Açıklandığı gibi bu tasarım seçiminin tarafından sunulan avantajları vardır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-125">As described, there are advantages offered by that design choice.</span></span> <span data-ttu-id="1f5b9-126">Bu uygulama kaynağını Github'dan indirip yerel olarak çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-126">You can download the source for this application from GitHub and run it locally.</span></span> <span data-ttu-id="1f5b9-127">Tek parça bu uygulama bir kapsayıcı ortamında dağıtılan fayda sağlar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-127">Even this monolithic application benefits from being deployed in a container environment.</span></span>

<span data-ttu-id="1f5b9-128">Biri için kapsayıcı dağıtımı uygulamanın her örneği aynı ortamda çalıştığı anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-128">For one, the containerized deployment means that every instance of the application runs in the same environment.</span></span> <span data-ttu-id="1f5b9-129">Bu, burada erken test ve geliştirme gerçekleşmesi Geliştirici ortamı içerir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-129">This includes the developer environment where early testing and development take place.</span></span> <span data-ttu-id="1f5b9-130">Geliştirme ekibi, uygulamayı üretim ortamına eşleşen bir kapsayıcı ortamında çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-130">The development team can run the application in a containerized environment that matches the production environment.</span></span>

<span data-ttu-id="1f5b9-131">Ayrıca, kapsayıcılı uygulamaların ölçeklendirme daha düşük maliyetle.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-131">Also, containerized applications scale out at lower cost.</span></span> <span data-ttu-id="1f5b9-132">Daha önce bahsettiğim gibi kapsayıcı ortamınızı geleneksel VM ortamları paylaşımı büyük kaynak sağlar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-132">As you saw earlier, the container environment enables greater resource sharing than traditional VM environments.</span></span>

<span data-ttu-id="1f5b9-133">Son olarak, ASP.NET'in, iş mantığı ve depolama sunucusu arasında bir ayrım zorlar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-133">Finally, containerizing the application forces a separation between the business logic and the storage server.</span></span> <span data-ttu-id="1f5b9-134">Uygulama Ölçeklendirmesi eşitlenene gibi çeşitli kapsayıcıları tek bir fiziksel depolama bir ortamda tüm güvenirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-134">As the application scales out, the various containers will all rely on a single physical storage medium.</span></span> <span data-ttu-id="1f5b9-135">Bu depolama genelde bir SQL Server veritabanı çalıştıran bir yüksek kullanılabilirlik sunucusu olacaktır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-135">This storage would typically be a high-availability server running a SQL Server database.</span></span>

## <a name="application-tour"></a><span data-ttu-id="1f5b9-136">Uygulama turu</span><span class="sxs-lookup"><span data-stu-id="1f5b9-136">Application tour</span></span>

<span data-ttu-id="1f5b9-137">[EShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) bazı tek parça bir uygulamayı çalıştıran hizmetine uygulama uygulamasını temsil eder: .NET Core üzerinde çalışan bir ASP.NET Core MVC tabanlı uygulama.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-137">The [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) application represents some of the eShopOnContainers application running as a monolithic application — an ASP.NET Core MVC-based application running on .NET Core.</span></span> <span data-ttu-id="1f5b9-138">Esas olarak, önceki bölümlerde açıklandığı gibi göz atma özellikleri Kataloğu sağlar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-138">It mainly provides the catalog browsing capabilities as described in earlier sections.</span></span>

<span data-ttu-id="1f5b9-139">Uygulama Kataloğu depolama alanı için bir SQL Server veritabanını kullanır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-139">The application uses a SQL Server database for the catalog storage.</span></span> <span data-ttu-id="1f5b9-140">Kapsayıcı tabanlı dağıtımlarda, bu tek parça bir uygulamayı mikro hizmet tabanlı uygulama aynı veri deposuna erişebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-140">In container-based deployments, this monolithic application can access the same data store as the microservices-based application.</span></span> <span data-ttu-id="1f5b9-141">Uygulama, bir kapsayıcıdaki tek parça bir uygulamayı yanı sıra SQL Server çalıştırmak için yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-141">The application is configured to run SQL Server in a container alongside the monolithic application.</span></span> <span data-ttu-id="1f5b9-142">Bir üretim ortamında, SQL Server, Docker konağının dışında bir yüksek kullanılabilirlik makinede çalıştırılır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-142">In a production environment, SQL Server would run on a high-availability machine, outside of the Docker host.</span></span> <span data-ttu-id="1f5b9-143">Geliştirme veya test ortamında, kolaylık sağlamak için SQL Server kendi kapsayıcısında çalıştırılması önerilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-143">For convenience, in a development or test environment, running SQL Server in its own container is recommended.</span></span>

<span data-ttu-id="1f5b9-144">Yalnızca ilk özelliği, katalog taramayı etkinleştirir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-144">The initial feature set only enables browsing the catalog.</span></span> <span data-ttu-id="1f5b9-145">Güncelleştirmeleri kapsayıcılı uygulama tüm özellik kümesini etkinleştirir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-145">Updates would enable the full feature set of the containerized application.</span></span> <span data-ttu-id="1f5b9-146">Tek parça bir web uygulaması mimarisi daha gelişmiş bir açıklanan [ASP.NET Web uygulaması mimarisi yöntemler](https://aka.ms/webappebook) e-kitap ve ilgili [eShopOnWeb örnek uygulama](https://aka.ms/WebAppArchitecture).</span><span class="sxs-lookup"><span data-stu-id="1f5b9-146">A more advanced monolithic web application architecture is described in the [ASP.NET Web Application architecture practices](https://aka.ms/webappebook) e-book and related [eShopOnWeb sample application](https://aka.ms/WebAppArchitecture).</span></span>

## <a name="docker-support"></a><span data-ttu-id="1f5b9-147">Docker desteği</span><span class="sxs-lookup"><span data-stu-id="1f5b9-147">Docker support</span></span>

<span data-ttu-id="1f5b9-148">EShopOnWeb proje .NET Core üzerinde çalışır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-148">The eShopOnWeb project runs on .NET Core.</span></span> <span data-ttu-id="1f5b9-149">Linux tabanlı veya Windows tabanlı kapsayıcılarda çalıştırabilirsiniz anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-149">That means it can run in either Linux-based or Windows-based containers.</span></span> <span data-ttu-id="1f5b9-150">Aynı ana bilgisayar türü için SQL Server kullanmak istediğiniz bir dağıtım için Docker unutmayın.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-150">Note that for Docker deployment, you want to use the same host type for SQL Server.</span></span> <span data-ttu-id="1f5b9-151">Linux tabanlı kapsayıcılar bir daha küçük kaplama alanı izin ve tercih edilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-151">Linux-based containers allow a smaller footprint and are preferred.</span></span>

<span data-ttu-id="1f5b9-152">Visual Studio için Docker desteği ekleyen bir çözüme bir proje şablonu sağlar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-152">Visual Studio provides a project template that adds support for Docker to a solution.</span></span> <span data-ttu-id="1f5b9-153">Projeye sağ tıklayın, tıklayın **Ekle** ardından **Docker desteği**.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-153">You right-click the project, click **Add** followed by **Docker Support**.</span></span> <span data-ttu-id="1f5b9-154">Projenizi ve yeni bir şablon bir Dockerfile ekler **docker-compose** bir Başlatıcısı sağlayan proje *docker-compose.yml* dosya.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-154">The template adds a Dockerfile to your project, and a new **docker-compose** project that provides a starter *docker-compose.yml* file.</span></span> <span data-ttu-id="1f5b9-155">Bu adım, Github'dan indirilen eShopOnWeb projede zaten yapılmıştır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-155">This step has already been done in the eShopOnWeb project downloaded from GitHub.</span></span> <span data-ttu-id="1f5b9-156">Çözüm içerdiğini görebilirsiniz **eShopOnWeb** proje ve **docker-compose** proje Şekil 6-1'de gösterildiği gibi.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-156">You can see that the solution contains the **eShopOnWeb** project and the **docker-compose** project as shown in Figure 6-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="1f5b9-157">**Şekil 6-1**.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-157">**Figure 6-1**.</span></span> <span data-ttu-id="1f5b9-158">**Docker-compose** tek kapsayıcı web uygulaması projesinde</span><span class="sxs-lookup"><span data-stu-id="1f5b9-158">The **docker-compose** project in a single-container web application</span></span>

<span data-ttu-id="1f5b9-159">Bu dosyalar standart docker-compose dosyası, herhangi bir Docker projesi ile tutarlı.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-159">These files are standard docker-compose files, consistent with any Docker project.</span></span> <span data-ttu-id="1f5b9-160">Bunları, Visual Studio ile veya komut satırından kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-160">You can use them with Visual Studio or from the command line.</span></span> <span data-ttu-id="1f5b9-161">Bu uygulama, .NET Core üzerinde çalışır ve Linux kapsayıcıları kullanır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-161">This application runs on .NET Core and uses Linux containers.</span></span> <span data-ttu-id="1f5b9-162">Bu nedenle, kod, derleme da bir Mac veya Linux makine üzerinde çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-162">So, you can also code, build, and run it on a Mac or on a Linux machine.</span></span>

<span data-ttu-id="1f5b9-163">*Docker-compose.yml* dosya ne oluşturmak için görüntüler ve başlatmak için hangi kapsayıcıları hakkında bilgiler içerir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-163">The *docker-compose.yml* file contains information about what images to build and what containers to launch.</span></span> <span data-ttu-id="1f5b9-164">Şablonları nasıl oluşturulacağını belirtin `eshopweb` görüntü ve uygulamanın kapsayıcılar'ı başlatın.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-164">The templates specify how to build the `eshopweb` image and launch the application’s containers.</span></span> <span data-ttu-id="1f5b9-165">Görüntü ekleyerek SQL Server'da bağımlılık eklemeniz gerekir (örneğin, `mssql-server-linux`) ve bir hizmet oluşturmak ve bu kapsayıcısı başlatmak Docker için sql.data görüntüsü.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-165">You need to add the dependency on SQL Server by including an image for it (for example, `mssql-server-linux`), and a service for the sql.data image for Docker to build and launch that container.</span></span> <span data-ttu-id="1f5b9-166">Bu ayarlar, aşağıdaki örnekte gösterilmiştir:</span><span class="sxs-lookup"><span data-stu-id="1f5b9-166">These settings are shown in the following example:</span></span>

```yml
version: '2'

services:
  eshopweb:
    image: eshop/web
    build:
    context: ./eShopWeb
    dockerfile: Dockerfile
    depends_on:
      - sql.data

  sql.data:
    image: microsoft/mssql-server-linux
```

<span data-ttu-id="1f5b9-167">`depends_on` Yönergesi Docker eShopWeb görüntü sql.data görüntüye bağlı olduğunu bildirir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-167">The `depends_on` directive tells Docker that the eShopWeb image depends on the sql.data image.</span></span> <span data-ttu-id="1f5b9-168">Aşağıdaki satırları `depends_on` etiketli bir görüntüsünü oluşturmak için yönergeler `sql.data` kullanarak `microsoft/mssql-server-linux` görüntü.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-168">The lines below `depends_on` are the instructions to build an image tagged `sql.data` using the `microsoft/mssql-server-linux` image.</span></span>

<span data-ttu-id="1f5b9-169">**Docker-compose** proje ana altındaki diğer docker-compose dosyaları görüntüler *docker-compose.yml* düğümü bu dosyaların ilişkili olduğunu görsel bir gösterge sağlar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-169">The **docker-compose** project displays the other docker-compose files under the main *docker-compose.yml* node to provide a visual indication that these files are related.</span></span> <span data-ttu-id="1f5b9-170">*Docker compose override.yml* dosya bağlantı dizelerini ve diğer uygulama ayarları gibi her iki hizmet ayarlarını içerir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-170">The *docker-compose-override.yml* file contains settings for both services, such as connection strings and other application settings.</span></span>

<span data-ttu-id="1f5b9-171">Aşağıdaki örnekte gösterildiği *docker compose.vs.debug.yml* dosyasını Visual Studio'da hata ayıklama için kullanılan ayarları içerir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-171">The following example shows the *docker-compose.vs.debug.yml* file, which contains settings used for debugging in Visual Studio.</span></span> <span data-ttu-id="1f5b9-172">Bu dosyada, kendisine eklenmiş geliştirme etiketi eshopweb görüntü sahiptir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-172">In that file, the eshopweb image has the dev tag appended to it.</span></span> <span data-ttu-id="1f5b9-173">Böylece hata ayıklama bilgileri yanlışlıkla bir üretim ortamına dağıtmanıza gerek yoktur, sürüm görüntülerden ayrı hata ayıklama yardımcı olur:</span><span class="sxs-lookup"><span data-stu-id="1f5b9-173">That helps separate debug from release images so that you don't accidentally deploy the debug information to a production environment:</span></span>

```yml
version: '2'

services:
  eshopweb:
    image: eshop/web:dev
    build:
    args:
    source: ${DOCKER_BUILD_SOURCE}
    environment:
      - DOTNET_USE_POLLING_FILE_WATCHER=1
    volumes:
      - ./eShopWeb:/app
      - ~/.nuget/packages:/root/.nuget/packages:ro
      - ~/clrdbg:/clrdbg:ro
    entrypoint: tail -f /dev/null
    labels:
      - "com.microsoft.visualstudio.targetoperatingsystem=linux"
```

<span data-ttu-id="1f5b9-174">Eklenen son dosya *docker-compose.ci.build.yml*.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-174">The last file added is *docker-compose.ci.build.yml*.</span></span> <span data-ttu-id="1f5b9-175">Komut satırından bu dosya bir CI sunucudan projeyi oluşturmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-175">This file would be used from the command line to build the project from a CI server.</span></span> <span data-ttu-id="1f5b9-176">Bu compose dosyasının, uygulamanız için gereken bir görüntü oluşturur bir Docker kapsayıcısı başlatır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-176">This compose file starts a Docker container that builds the images needed for your application.</span></span> <span data-ttu-id="1f5b9-177">Aşağıdaki örnek, içeriğini gösterir *docker-compose.ci.build.yml* dosyası:</span><span class="sxs-lookup"><span data-stu-id="1f5b9-177">The following example shows the contents of the *docker-compose.ci.build.yml* file:</span></span>

```yml
version: '2'

services:
  ci-build:
    image: microsoft/aspnetcore-build:latest
    volumes:
      - .:/src
    working_dir: /src
  command: /bin/bash -c "dotnet restore ./eShopWeb.sln && dotnet publish  ./eShopWeb.sln -c Release -o ./obj/Docker/publish"
```

> [!NOTE]
> <span data-ttu-id="1f5b9-178">.NET Core SDK 2.0 ile başlayarak [dotnet restore](../../../core/tools/dotnet-restore.md) komutu yürütür otomatik olarak zaman [dotnet yayımlama](../../../core/tools/dotnet-publish.md) yürütülür.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-178">Starting with .NET Core SDK 2.0, the [dotnet restore](../../../core/tools/dotnet-restore.md) command executes automatically when [dotnet publish](../../../core/tools/dotnet-publish.md) is executed.</span></span>

<span data-ttu-id="1f5b9-179">Görüntünün bir ASP.NET Core derleme görüntü olduğuna dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-179">Notice that the image is an ASP.NET Core build image.</span></span> <span data-ttu-id="1f5b9-180">Bu görüntüyü, uygulamanızı yapılandırmak ve gerekli görüntüleri oluşturmak için SDK'sı ve derleme araçları içerir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-180">That image includes the SDK and build tools to build your application and create the required images.</span></span> <span data-ttu-id="1f5b9-181">Çalışan **docker-compose** proje bu dosyayı kullanan derleme kapsayıcı görüntüsünden başlatılır ve ardından kapsayıcıdaki uygulamanızın görüntü oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-181">Running the **docker-compose** project using this file starts the build container from the image, then builds your application’s image in that container.</span></span> <span data-ttu-id="1f5b9-182">Belirttiğiniz *docker-compose* uygulamanızı bir Docker kapsayıcısında oluşturun ve ardından başlatmak için komut satırının bir parçası olarak dosya.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-182">You specify that *docker-compose* file as part of the command line to build your application in a Docker container, then launch it.</span></span>

<span data-ttu-id="1f5b9-183">Visual Studio'da seçerek uygulamanızı Docker kapsayıcılarında çalıştırabilirsiniz **docker-compose** projesini başlangıç projesi olarak ve ardından (hata ayıklamak için F5), Ctrl + F5 tuşlarına basarak herhangi bir uygulama ile yapabildiğiniz gibi.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-183">In Visual Studio, you can run your application in Docker containers by selecting the **docker-compose** project as the startup project, and then pressing Ctrl+F5 (F5 to debug), as you can with any other application.</span></span> <span data-ttu-id="1f5b9-184">Başladığınızda **docker-compose** proje, Visual Studio çalıştırmaları **docker-compose** kullanarak *docker-compose.yml* dosyası  *docker-compose.override.yml* dosyası ve bir docker-compose.vs.\* dosyaları.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-184">When you start the **docker-compose** project, Visual Studio runs **docker-compose** using the *docker-compose.yml* file, the *docker-compose.override.yml* file, and one of the docker-compose.vs.\* files.</span></span> <span data-ttu-id="1f5b9-185">Uygulama başlatıldıktan sonra Visual Studio tarayıcı başlatılır.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-185">Once the application has started, Visual Studio launches the browser for you.</span></span>

<span data-ttu-id="1f5b9-186">Visual Studio hata ayıklayıcı uygulamasını başlatın, Docker uygulama çalışırken ekler.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-186">If you launch the application in the debugger, Visual Studio attaches to the running application in Docker.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="1f5b9-187">Sorun giderme</span><span class="sxs-lookup"><span data-stu-id="1f5b9-187">Troubleshooting</span></span>

<span data-ttu-id="1f5b9-188">Bu bölümde ortaya çıkabilecek bazı sorunlar açıklanmaktadır, yerel olarak çalıştırma kapsayıcılarınızı ve bazı düzeltmeler önerir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-188">This section describes a few issues that might arise when your run containers locally and suggests some fixes.</span></span>

### <a name="stop-docker-containers"></a><span data-ttu-id="1f5b9-189">Docker kapsayıcıları Durdur</span><span class="sxs-lookup"><span data-stu-id="1f5b9-189">Stop Docker containers</span></span>

<span data-ttu-id="1f5b9-190">Kapsayıcılı uygulama başlattıktan sonra kapsayıcıları bile hata ayıklama durdurduktan sonra çalışmaya devam edin.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-190">After you launch the containerized application, the containers continue to run, even after you have stopped debugging.</span></span> <span data-ttu-id="1f5b9-191">Çalıştırabileceğiniz `docker ps` çalışan kapsayıcıları görmek için komut satırından komutu.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-191">You can run the `docker ps` command from the command line to see which containers are running.</span></span> <span data-ttu-id="1f5b9-192">`docker stop` Komut Şekil 6-2'de gösterildiği gibi bir çalışan kapsayıcıya durdurur.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-192">The `docker stop` command stops a running container, as shown in Figure 6-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="1f5b9-193">**Şekil 6-2**.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-193">**Figure 6-2**.</span></span> <span data-ttu-id="1f5b9-194">Listeleme ve kapsayıcılar docker ps ve docker durdurma CLI komutları ile durduruluyor</span><span class="sxs-lookup"><span data-stu-id="1f5b9-194">Listing and stopping containers with the docker ps and docker stop CLI commands</span></span>

<span data-ttu-id="1f5b9-195">Çalışan işlemleri farklı yapılandırmalar arasında geçiş yaptığınızda durdurmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-195">You might need to stop running processes when you switch between different configurations.</span></span> <span data-ttu-id="1f5b9-196">Aksi takdirde, web uygulamasını çalıştıran kapsayıcıyı uygulamanız için bağlantı noktasını kullanıyorsa (Bu örnekte 5106).</span><span class="sxs-lookup"><span data-stu-id="1f5b9-196">Otherwise, the container that is running the web application is using the port for your application (5106 in this example).</span></span>

### <a name="add-docker-to-your-projects"></a><span data-ttu-id="1f5b9-197">Docker, projenize ekleyin.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-197">Add Docker to your projects</span></span>

<span data-ttu-id="1f5b9-198">Docker desteği ekler Sihirbazı çalışan Docker işlemi ile iletişim kurar.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-198">The wizard that adds Docker support communicates with the running Docker process.</span></span> <span data-ttu-id="1f5b9-199">Sihirbazı başlattığınızda Docker çalışmıyorsa, sihirbaz düzgün çalışmıyor.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-199">If Docker isn't running when you start the wizard, the wizard won't run correctly.</span></span> <span data-ttu-id="1f5b9-200">Sihirbazın geçerli kapsayıcı seçiminizi doğru Docker desteği Ekle inceler.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-200">The wizard examines your current container choice to add the correct Docker support.</span></span> <span data-ttu-id="1f5b9-201">Windows kapsayıcıları için destek eklemek için Windows yapılandırılmış kapsayıcılarla çalışan Docker varken Sihirbazı'nı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-201">To add support for Windows Containers, run the wizard while you have Docker running with Windows Containers configured.</span></span> <span data-ttu-id="1f5b9-202">Linux kapsayıcıları için destek eklemek üzere yapılandırılmış Linux kapsayıcıları ile çalışan Docker varken Sihirbazı'nı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="1f5b9-202">To add support for Linux containers, run the wizard while you have Docker running with Linux containers configured.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="1f5b9-203">[Önceki](../docker-application-development-process/docker-app-development-workflow.md)
[İleri](../containerize-net-framework-applications/index.md)</span><span class="sxs-lookup"><span data-stu-id="1f5b9-203">[Previous](../docker-application-development-process/docker-app-development-workflow.md)
[Next](../containerize-net-framework-applications/index.md)</span></span>
