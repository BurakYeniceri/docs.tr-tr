---
title: "İş akışlarında iptal davranışı modelleme"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d48f6cf3-cdde-4dd3-8265-a665acf32a03
caps.latest.revision: "11"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 912694eb07a5f95b42f3a0f0cf39f25db1313e69
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/02/2017
---
# <a name="modeling-cancellation-behavior-in-workflows"></a><span data-ttu-id="e87ec-102">İş akışlarında iptal davranışı modelleme</span><span class="sxs-lookup"><span data-stu-id="e87ec-102">Modeling Cancellation Behavior in Workflows</span></span>
<span data-ttu-id="e87ec-103">Etkinlikler iptal edilemez bir iş akışı içinde örneğin tarafından bir <xref:System.Activities.Statements.Parallel> tamamlanmamış dalları iptal etme Etkinlik zaman kendi <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> değerlendiren `true`, veya konak çağırırsa iş akışını dışında <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-103">Activities can be canceled inside a workflow, for example by a <xref:System.Activities.Statements.Parallel> activity canceling incomplete branches when its <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> evaluates to `true`, or from outside the workflow, if the host calls <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span> <span data-ttu-id="e87ec-104">İptalleri işleme sağlamak için iş akışı yazarları kullanabilirsiniz <xref:System.Activities.Statements.CancellationScope> etkinliği <xref:System.Activities.Statements.CompensableActivity> etkinliği veya iptal mantığın özel etkinlikler oluşturun.</span><span class="sxs-lookup"><span data-stu-id="e87ec-104">To provide cancellation handling, workflow authors can use the <xref:System.Activities.Statements.CancellationScope> activity, the <xref:System.Activities.Statements.CompensableActivity> activity, or create custom activities that provide cancellation logic.</span></span> <span data-ttu-id="e87ec-105">Bu konu, iş akışlarında iptal genel bir bakış sağlar.</span><span class="sxs-lookup"><span data-stu-id="e87ec-105">This topic provides an overview of cancellation in workflows.</span></span>  
  
## <a name="cancellation-compensation-and-transactions"></a><span data-ttu-id="e87ec-106">İptal, maaş ve işlemleri</span><span class="sxs-lookup"><span data-stu-id="e87ec-106">Cancellation, Compensation, and Transactions</span></span>  
 <span data-ttu-id="e87ec-107">İşlemler, uygulamanızın (geri dön) işlem işleminin herhangi bir bölümü sırasında herhangi bir hata oluşursa işlem içinde yürütülen tüm değişiklikleri iptal etmek için kabiliyeti sağlar.</span><span class="sxs-lookup"><span data-stu-id="e87ec-107">Transactions give your application the ability to abort (roll back) all changes executed within the transaction if any errors occur during any part of the transaction process.</span></span> <span data-ttu-id="e87ec-108">Ancak, iptal edildi veya geri gerekebilir tüm iş uzun süre çalışan iş veya işlem kaynakları içermeyen çalışma gibi işlemler için uygundur.</span><span class="sxs-lookup"><span data-stu-id="e87ec-108">However, not all work that may need to be canceled or undone is appropriate for transactions, such as long-running work or work that does not involve transactional resources.</span></span> <span data-ttu-id="e87ec-109">İş akışında bir sonraki hata olduğunda maaş geri alma önceden tamamlanmış işlemsel olmayan iş için bir model sağlar.</span><span class="sxs-lookup"><span data-stu-id="e87ec-109">Compensation provides a model for undoing previously completed non-transactional work if there is a subsequent failure in the workflow.</span></span> <span data-ttu-id="e87ec-110">İptali iş akışı için bir model sağlar ve işlemsel olmayan işlemek için etkinlik yazarlar, tamamlanmadığını çalışır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-110">Cancellation provides a model for workflow and activity authors to handle non-transactional work that was not completed.</span></span> <span data-ttu-id="e87ec-111">Varsa, iptal mantığını bir etkinlik yürütülmesinin tamamlanmadı ve iptal edilir, çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-111">If an activity has not completed its execution and it is canceled, its cancellation logic will be invoked if it is available.</span></span>  
  
> [!NOTE]
>  [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="e87ec-112">işlemler ve maaş, bkz: [işlemleri](../../../docs/framework/windows-workflow-foundation/workflow-transactions.md) ve [maaş](../../../docs/framework/windows-workflow-foundation/compensation.md).</span><span class="sxs-lookup"><span data-stu-id="e87ec-112"> transactions and compensation, see [Transactions](../../../docs/framework/windows-workflow-foundation/workflow-transactions.md) and [Compensation](../../../docs/framework/windows-workflow-foundation/compensation.md).</span></span>  
  
## <a name="using-cancellationscope"></a><span data-ttu-id="e87ec-113">CancellationScope kullanma</span><span class="sxs-lookup"><span data-stu-id="e87ec-113">Using CancellationScope</span></span>  
 <span data-ttu-id="e87ec-114"><xref:System.Activities.Statements.CancellationScope> Etkinlik alt etkinlikler içeren iki bölümü vardır: <xref:System.Activities.Statements.CancellationScope.Body%2A> ve <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-114">The <xref:System.Activities.Statements.CancellationScope> activity has two sections that can contain child activities: <xref:System.Activities.Statements.CancellationScope.Body%2A> and <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>.</span></span> <span data-ttu-id="e87ec-115"><xref:System.Activities.Statements.CancellationScope.Body%2A> Etkinlik mantığı oluşturan etkinlikler yerleştirildiği olduğu ve <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> etkinliğini iptal mantığın etkinlikleri yerleştirildiği olduğu.</span><span class="sxs-lookup"><span data-stu-id="e87ec-115">The <xref:System.Activities.Statements.CancellationScope.Body%2A> is where the activities that make up the logic of the activity are placed, and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> is where the activities that provide cancellation logic for the activity are placed.</span></span> <span data-ttu-id="e87ec-116">Tamamlanmadı yalnızca, bir etkinlik iptal edilebilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-116">An activity can be canceled only if it has not completed.</span></span> <span data-ttu-id="e87ec-117">Durumunda <xref:System.Activities.Statements.CancellationScope> etkinliği tamamlama etkinlikler tamamlandığında başvurduğu <xref:System.Activities.Statements.CancellationScope.Body%2A>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-117">In the case of the <xref:System.Activities.Statements.CancellationScope> activity, completion refers to the completion of the activities in the <xref:System.Activities.Statements.CancellationScope.Body%2A>.</span></span> <span data-ttu-id="e87ec-118">İptal isteği zamanlanırsa ve etkinlikleri <xref:System.Activities.Statements.CancellationScope.Body%2A> tamamlamadıysanız, sonra <xref:System.Activities.Statements.CancellationScope> olarak işaretlenmiş <xref:System.Activities.ActivityInstanceState.Canceled> ve <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> etkinlikleri yürütülür.</span><span class="sxs-lookup"><span data-stu-id="e87ec-118">If a cancellation request is scheduled and the activities in the <xref:System.Activities.Statements.CancellationScope.Body%2A> have not completed, then the <xref:System.Activities.Statements.CancellationScope> will be marked as <xref:System.Activities.ActivityInstanceState.Canceled> and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> activities will be executed.</span></span>  
  
### <a name="canceling-a-workflow-from-the-host"></a><span data-ttu-id="e87ec-119">Ana bilgisayardan bir iş akışı iptal etme</span><span class="sxs-lookup"><span data-stu-id="e87ec-119">Canceling a Workflow from the Host</span></span>  
 <span data-ttu-id="e87ec-120">Bir ana iş akışı çağırarak iptal edebilirsiniz <xref:System.Activities.WorkflowApplication.Cancel%2A> yöntemi <xref:System.Activities.WorkflowApplication> iş akışı barındırma örneği.</span><span class="sxs-lookup"><span data-stu-id="e87ec-120">A host can cancel a workflow by calling the <xref:System.Activities.WorkflowApplication.Cancel%2A> method of the <xref:System.Activities.WorkflowApplication> instance that is hosting the workflow.</span></span> <span data-ttu-id="e87ec-121">Sahip bir iş akışı oluşturulur aşağıdaki örnekte bir <xref:System.Activities.Statements.CancellationScope>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-121">In the following example a workflow is created that has a <xref:System.Activities.Statements.CancellationScope>.</span></span> <span data-ttu-id="e87ec-122">İş akışı çağrılır ve ardından ana bilgisayar için bir çağrı yapar <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-122">The workflow is invoked, and then the host makes a call to <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span> <span data-ttu-id="e87ec-123">İş akışı ana yürütülmesi durdurulduğunda, <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> , <xref:System.Activities.Statements.CancellationScope> çağrılır, ve ardından iş akışını durumuyla tamamlandığında <xref:System.Activities.ActivityInstanceState.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-123">The main execution of the workflow is stopped, the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> of the <xref:System.Activities.Statements.CancellationScope> is invoked, and then the workflow completes with a status of <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#35](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#35)]  
  
 <span data-ttu-id="e87ec-124">Bu iş akışı çağrıldığında, aşağıdaki çıktıyı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-124">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e87ec-125">**İş akışı başlatılıyor.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-125">**Starting the workflow.**</span></span>  
<span data-ttu-id="e87ec-126">**CancellationHandler çağrılır.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-126">**CancellationHandler invoked.** </span></span>  
<span data-ttu-id="e87ec-127">**İş akışı b30ebb30-df46-4d90-a211-e31c38d8db3c iptal edildi.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-127">**Workflow b30ebb30-df46-4d90-a211-e31c38d8db3c Canceled.**</span></span>    
> [!NOTE]
>  <span data-ttu-id="e87ec-128">Zaman bir <xref:System.Activities.Statements.CancellationScope> etkinliği iptal edilir ve <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> çağrılır, bunu uygun iptal mantığı sağlamak için daha önce yaptığınız iptal edilmiş etkinliği iptal edildi ilerlemesini belirlemek için iş akışı yazarı sorumluluğundadır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-128">When a <xref:System.Activities.Statements.CancellationScope> activity is canceled and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> invoked, it is the responsibility of the workflow author to determine the progress that the canceled activity made before it was canceled in order to provide the appropriate cancellation logic.</span></span> <span data-ttu-id="e87ec-129"><xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> İptal edilmiş etkinliğin ilerleme durumu ile ilgili herhangi bir bilgi sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="e87ec-129">The <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> does not provide any information about the progress of the canceled activity.</span></span>  
  
 <span data-ttu-id="e87ec-130">İşlenmeyen bir özel durum iş akışı kök köpürür, bir iş akışı ana bilgisayardan iptal edilebilir ve <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> işleyicisini döndürür <xref:System.Activities.UnhandledExceptionAction.Cancel>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-130">A workflow can also be canceled from the host if an unhandled exception bubbles up past the root of the workflow and the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler returns <xref:System.Activities.UnhandledExceptionAction.Cancel>.</span></span> <span data-ttu-id="e87ec-131">Bu örnekte, iş akışı başlatıldığında'ı ve ardından oluşturur bir <xref:System.ApplicationException>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-131">In this example the workflow starts and then throws an <xref:System.ApplicationException>.</span></span> <span data-ttu-id="e87ec-132">Bu özel iş akışı tarafından işlenmeyen ve böylece <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> işleyici çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-132">This exception is unhandled by the workflow and so the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is invoked.</span></span> <span data-ttu-id="e87ec-133">İş akışı iptal etmek için çalışma zamanı işleyici bildirir ve <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> şu anda yürütülmekte olan <xref:System.Activities.Statements.CancellationScope> etkinlik çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-133">The handler instructs the runtime to cancel the workflow, and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> of the currently executing <xref:System.Activities.Statements.CancellationScope> activity is invoked.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#36](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#36)]  
  
 <span data-ttu-id="e87ec-134">Bu iş akışı çağrıldığında, aşağıdaki çıktıyı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-134">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e87ec-135">**İş akışı başlatılıyor.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-135">**Starting the workflow.**</span></span>  
<span data-ttu-id="e87ec-136">**İş akışı 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9 OnUnhandledException** </span><span class="sxs-lookup"><span data-stu-id="e87ec-136">**OnUnhandledException in Workflow 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9** </span></span>  
<span data-ttu-id="e87ec-137">**Bir ApplicationException bir durum oluştu.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-137">**An ApplicationException was thrown.** </span></span>  
<span data-ttu-id="e87ec-138">**CancellationHandler çağrılır.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-138">**CancellationHandler invoked.** </span></span>  
<span data-ttu-id="e87ec-139">**İş akışı 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9 iptal edildi.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-139">**Workflow 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9 Canceled.**</span></span>    
### <a name="canceling-an-activity-from-inside-a-workflow"></a><span data-ttu-id="e87ec-140">Bir iş akışı içinde bir etkinlikten iptal etme</span><span class="sxs-lookup"><span data-stu-id="e87ec-140">Canceling an Activity from Inside a Workflow</span></span>  
 <span data-ttu-id="e87ec-141">Bir etkinlik üst tarafından iptal edilebilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-141">An activity can also be canceled by its parent.</span></span> <span data-ttu-id="e87ec-142">Örneğin, varsa bir <xref:System.Activities.Statements.Parallel> etkinlik sahip birden çok yürütme dalları ve kendi <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> değerlendiren `true` tamamlanmamış dalları iptal edilecek sonra.</span><span class="sxs-lookup"><span data-stu-id="e87ec-142">For example, if a <xref:System.Activities.Statements.Parallel> activity has multiple executing branches and its <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> evaluates to `true` then its incomplete branches will be canceled.</span></span> <span data-ttu-id="e87ec-143">Bu örnekte bir <xref:System.Activities.Statements.Parallel> etkinlik iki dalı olan oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="e87ec-143">In this example a <xref:System.Activities.Statements.Parallel> activity is created that has two branches.</span></span> <span data-ttu-id="e87ec-144">Kendi <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> ayarlanır `true` böylece <xref:System.Activities.Statements.Parallel> onun dallandırır herhangi biri tamamlandıktan hemen sonra tamamlar.</span><span class="sxs-lookup"><span data-stu-id="e87ec-144">Its <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> is set to `true` so the <xref:System.Activities.Statements.Parallel> completes as soon as any one of its branches is completed.</span></span> <span data-ttu-id="e87ec-145">Bu örnekte, şube 2 tamamlandıktan ve bu nedenle şube 1 iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-145">In this example branch 2 completes, and so branch 1 is canceled.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#37](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#37)]  
  
 <span data-ttu-id="e87ec-146">Bu iş akışı çağrıldığında, aşağıdaki çıktıyı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-146">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e87ec-147">**1 başlangıç dal.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-147">**Branch 1 starting.**</span></span>  
<span data-ttu-id="e87ec-148">**Dal 2 tamamlandı.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-148">**Branch 2 complete.** </span></span>  
<span data-ttu-id="e87ec-149">**Dal 1 iptal edildi.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-149">**Branch 1 canceled.** </span></span>  
<span data-ttu-id="e87ec-150">**İş akışı e0685e24-18ef-4a47-acf3-5c638732f3be tamamlandı.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-150">**Workflow e0685e24-18ef-4a47-acf3-5c638732f3be Completed.**</span></span>  <span data-ttu-id="e87ec-151">Bir özel durum yukarı etkinlik kök köpürür ancak iş akışı içinde daha yüksek düzeyde ele etkinlikleri de iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-151">Activities are also canceled if an exception bubbles up past the root of the activity but is handled at a higher level in the workflow.</span></span> <span data-ttu-id="e87ec-152">Bu örnekte, iş akışı ana mantığını oluşan bir <xref:System.Activities.Statements.Sequence> etkinlik.</span><span class="sxs-lookup"><span data-stu-id="e87ec-152">In this example, the main logic of the workflow consists of a <xref:System.Activities.Statements.Sequence> activity.</span></span> <span data-ttu-id="e87ec-153"><xref:System.Activities.Statements.Sequence> Olarak belirtilen <xref:System.Activities.Statements.CancellationScope.Body%2A> , bir <xref:System.Activities.Statements.CancellationScope> tarafından bulunan etkinliği bir <xref:System.Activities.Statements.TryCatch> etkinlik.</span><span class="sxs-lookup"><span data-stu-id="e87ec-153">The <xref:System.Activities.Statements.Sequence> is specified as the <xref:System.Activities.Statements.CancellationScope.Body%2A> of a <xref:System.Activities.Statements.CancellationScope> activity which is contained by a <xref:System.Activities.Statements.TryCatch> activity.</span></span> <span data-ttu-id="e87ec-154">Gövdesinden bir özel durum <xref:System.Activities.Statements.Sequence>, üst öğe tarafından işlenen <xref:System.Activities.Statements.TryCatch> etkinliği ve <xref:System.Activities.Statements.Sequence> iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-154">An exception is thrown from the body of the <xref:System.Activities.Statements.Sequence>, is handled by the parent <xref:System.Activities.Statements.TryCatch> activity, and the <xref:System.Activities.Statements.Sequence> is canceled.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#39](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#39)]  
  
 <span data-ttu-id="e87ec-155">Bu iş akışı çağrıldığında, aşağıdaki çıktıyı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-155">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e87ec-156">**Başlangıç dizisi.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-156">**Sequence starting.**</span></span>  
<span data-ttu-id="e87ec-157">**Sıra iptal edildi.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-157">**Sequence canceled.** </span></span>  
<span data-ttu-id="e87ec-158">**Özel durum oluştu.** </span><span class="sxs-lookup"><span data-stu-id="e87ec-158">**Exception caught.** </span></span>  
<span data-ttu-id="e87ec-159">**İş akışı e3c18939-121e-4c43-af1c-ba1ce977ce55 tamamlandı.**</span><span class="sxs-lookup"><span data-stu-id="e87ec-159">**Workflow e3c18939-121e-4c43-af1c-ba1ce977ce55 Completed.**</span></span>   
### <a name="throwing-exceptions-from-a-cancellationhandler"></a><span data-ttu-id="e87ec-160">Bir CancellationHandler özel durumları atma</span><span class="sxs-lookup"><span data-stu-id="e87ec-160">Throwing Exceptions from a CancellationHandler</span></span>  
 <span data-ttu-id="e87ec-161">Gelen karşılaşılan özel durumlar <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> , bir <xref:System.Activities.Statements.CancellationScope> iş akışı için önemli olan.</span><span class="sxs-lookup"><span data-stu-id="e87ec-161">Any exceptions thrown from the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> of a <xref:System.Activities.Statements.CancellationScope> are fatal to the workflow.</span></span> <span data-ttu-id="e87ec-162">Gelen kaçış özel durumlar olasılığını ise bir <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>, kullanan bir <xref:System.Activities.Statements.TryCatch> içinde <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> yakalamak ve bu özel durumları işlemek için.</span><span class="sxs-lookup"><span data-stu-id="e87ec-162">If there is a possibility of exceptions escaping from a <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>, use a <xref:System.Activities.Statements.TryCatch> in the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> to catch and handle these exceptions.</span></span>  
  
### <a name="cancellation-using-compensableactivity"></a><span data-ttu-id="e87ec-163">İptal CompensableActivity kullanma</span><span class="sxs-lookup"><span data-stu-id="e87ec-163">Cancellation using CompensableActivity</span></span>  
 <span data-ttu-id="e87ec-164">Gibi <xref:System.Activities.Statements.CancellationScope> etkinliği <xref:System.Activities.Statements.CompensableActivity> sahip bir <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-164">Like the <xref:System.Activities.Statements.CancellationScope> activity, the <xref:System.Activities.Statements.CompensableActivity> has a <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A>.</span></span> <span data-ttu-id="e87ec-165">Varsa bir <xref:System.Activities.Statements.CompensableActivity> iptal edilir, hiç etkinlik kendi <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A> çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-165">If a <xref:System.Activities.Statements.CompensableActivity> is canceled, any activities in its <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A> are invoked.</span></span> <span data-ttu-id="e87ec-166">Kısmen tamamlanan geri alma compensable iş için yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-166">This can be useful for undoing partially completed compensable work.</span></span> <span data-ttu-id="e87ec-167">Nasıl kullanılacağı hakkında bilgi için <xref:System.Activities.Statements.CompensableActivity> maaş ve iptal için bkz: [maaş](../../../docs/framework/windows-workflow-foundation/compensation.md).</span><span class="sxs-lookup"><span data-stu-id="e87ec-167">For information about how to use <xref:System.Activities.Statements.CompensableActivity> for compensation and cancellation, see [Compensation](../../../docs/framework/windows-workflow-foundation/compensation.md).</span></span>  
  
## <a name="cancellation-using-custom-activities"></a><span data-ttu-id="e87ec-168">Özel etkinlikleri kullanarak iptal</span><span class="sxs-lookup"><span data-stu-id="e87ec-168">Cancellation using Custom Activities</span></span>  
 <span data-ttu-id="e87ec-169">Özel Etkinlik yazarlar, kendi özel etkinliklerine birkaç farklı şekillerde iptal mantığı uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e87ec-169">Custom activity authors can implement cancellation logic into their custom activities in several different ways.</span></span> <span data-ttu-id="e87ec-170">Öğesinden türetilen özel etkinlikler <xref:System.Activities.Activity> koyarak iptal mantığı uygulayabilirsiniz bir <xref:System.Activities.Statements.CancellationScope> veya iptal mantığını etkinliği gövdesinde içeren diğer özel etkinlik.</span><span class="sxs-lookup"><span data-stu-id="e87ec-170">Custom activities that derive from <xref:System.Activities.Activity> can implement cancellation logic by placing a <xref:System.Activities.Statements.CancellationScope> or other custom activity that contains cancellation logic in the body of the activity.</span></span> <span data-ttu-id="e87ec-171"><xref:System.Activities.AsyncCodeActivity>ve <xref:System.Activities.NativeActivity> türetilmiş etkinlikleri kendi ilgili kılabilirsiniz <xref:System.Activities.NativeActivity.Cancel%2A> yöntemi ve iptal mantığı sağlar.</span><span class="sxs-lookup"><span data-stu-id="e87ec-171"><xref:System.Activities.AsyncCodeActivity> and <xref:System.Activities.NativeActivity> derived activities can override their respective <xref:System.Activities.NativeActivity.Cancel%2A> method and provide cancellation logic there.</span></span> <span data-ttu-id="e87ec-172"><xref:System.Activities.CodeActivity>türetilen etkinlikleri herhangi sağlamak için İptali çalışma zamanı aradığında, iş yürütme tek olarak veri bloğu içinde yapıldığından sağlamaz <xref:System.Activities.CodeActivity.Execute%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e87ec-172"><xref:System.Activities.CodeActivity> derived activities do not provide any provision for cancellation because all their work is performed in a single burst of execution when the runtime calls the <xref:System.Activities.CodeActivity.Execute%2A> method.</span></span> <span data-ttu-id="e87ec-173">Execute yöntemi henüz çağrılmadıysa varsa ve <xref:System.Activities.CodeActivity> göre etkinlik iptal edilir, etkinlik durumu olan kapatır <xref:System.Activities.ActivityInstanceState.Canceled> ve <xref:System.Activities.CodeActivity.Execute%2A> yöntemi çağrılmaz.</span><span class="sxs-lookup"><span data-stu-id="e87ec-173">If the execute method has not yet been called and a <xref:System.Activities.CodeActivity> based activity is canceled, the activity closes with a status of <xref:System.Activities.ActivityInstanceState.Canceled> and the <xref:System.Activities.CodeActivity.Execute%2A> method is not called.</span></span>  
  
### <a name="cancellation-using-nativeactivity"></a><span data-ttu-id="e87ec-174">İptal NativeActivity kullanma</span><span class="sxs-lookup"><span data-stu-id="e87ec-174">Cancellation using NativeActivity</span></span>  
 <span data-ttu-id="e87ec-175"><xref:System.Activities.NativeActivity>türetilen etkinlikleri kılabilirsiniz <xref:System.Activities.NativeActivity.Cancel%2A> yöntemi özel iptal mantığı sağlar.</span><span class="sxs-lookup"><span data-stu-id="e87ec-175"><xref:System.Activities.NativeActivity> derived activities can override the <xref:System.Activities.NativeActivity.Cancel%2A> method to provide custom cancellation logic.</span></span> <span data-ttu-id="e87ec-176">Bu yöntem geçersiz değil, varsayılan iş akışı iptal mantığı uygulanır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-176">If this method is not overridden, then the default workflow cancellation logic is applied.</span></span> <span data-ttu-id="e87ec-177">Varsayılan iptal işlemidir için oluşan bir <xref:System.Activities.NativeActivity> , geçersiz <xref:System.Activities.NativeActivity.Cancel%2A> yöntemi veya özelliği <xref:System.Activities.NativeActivity.Cancel%2A> yöntemini çağırır temel <xref:System.Activities.NativeActivity> <xref:System.Activities.NativeActivity.Cancel%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e87ec-177">Default cancellation is the process that occurs for a <xref:System.Activities.NativeActivity> that does not override the <xref:System.Activities.NativeActivity.Cancel%2A> method or whose <xref:System.Activities.NativeActivity.Cancel%2A> method calls the base <xref:System.Activities.NativeActivity> <xref:System.Activities.NativeActivity.Cancel%2A> method.</span></span> <span data-ttu-id="e87ec-178">Bir etkinlik iptal ettiğinizde, çalışma zamanı iptal etkinliğini bayraklar ve belirli temizleme otomatik olarak işler.</span><span class="sxs-lookup"><span data-stu-id="e87ec-178">When an activity is canceled, the runtime flags the activity for cancellation and automatically handles certain cleanup.</span></span> <span data-ttu-id="e87ec-179">Etkinlik bekleyen yer işaretleri yalnızca sahip yer işaretleri kaldırılacak ve etkinlik olarak işaretlenmiş <xref:System.Activities.ActivityInstanceState.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-179">If the activity only has outstanding bookmarks, the bookmarks will be removed and the activity will be marked as <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span> <span data-ttu-id="e87ec-180">İptal edilen etkinliğin tüm bekleyen alt etkinlikleri sırayla iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-180">Any outstanding child activities of the canceled activity will in turn be canceled.</span></span> <span data-ttu-id="e87ec-181">Ek alt etkinlikler zamanlamak için her türlü girişim yoksayılıyor denemesi neden olur ve etkinlik olarak işaretlenmiş <xref:System.Activities.ActivityInstanceState.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-181">Any attempt to schedule additional child activities will result in the attempt being ignored and the activity will be marked as <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span> <span data-ttu-id="e87ec-182">Herhangi bir bekleyen alt etkinliği tamamlarsa <xref:System.Activities.ActivityInstanceState.Canceled> veya <xref:System.Activities.ActivityInstanceState.Faulted> durum etkinlik olarak işaretlenmiş sonra <xref:System.Activities.ActivityInstanceState.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-182">If any outstanding child activity completes in the <xref:System.Activities.ActivityInstanceState.Canceled> or <xref:System.Activities.ActivityInstanceState.Faulted> state, then the activity will be marked as <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span> <span data-ttu-id="e87ec-183">İptal isteği yoksayılabilir unutmayın.</span><span class="sxs-lookup"><span data-stu-id="e87ec-183">Note that a cancellation request can be ignored.</span></span> <span data-ttu-id="e87ec-184">Bir etkinlik herhangi bir bekleyen yer işaretleri veya yürütülen alt etkinlikler yok ve herhangi bir ek iş öğesini iptalleri işaretlenen sonra zamanlayamazsınız, başarıyla tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-184">If an activity does not have any outstanding bookmarks or executing child activities and does not schedule any additional work items after being flagged for cancellation, it will complete successfully.</span></span> <span data-ttu-id="e87ec-185">Bu varsayılan iptal birçok senaryoları için son eklerini, ancak ek iptal mantığı gerekiyorsa, daha sonra yerleşik iptal etkinlikleri veya özel etkinlikler kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-185">This default cancellation suffices for many scenarios, but if additional cancellation logic is needed, then the built-in cancellation activities or custom activities can be used.</span></span>  
  
 <span data-ttu-id="e87ec-186">Aşağıdaki örnekte, <xref:System.Activities.NativeActivity.Cancel%2A> , geçersiz bir <xref:System.Activities.NativeActivity> özel dayalı `ParallelForEach` etkinlik tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-186">In the following example, the <xref:System.Activities.NativeActivity.Cancel%2A> override of a <xref:System.Activities.NativeActivity> based custom `ParallelForEach` activity is defined.</span></span> <span data-ttu-id="e87ec-187">Etkinlik iptal ettiğinizde, bu geçersiz kılma iptal mantığını etkinliği işler.</span><span class="sxs-lookup"><span data-stu-id="e87ec-187">When the activity is canceled, this override handles the cancellation logic for the activity.</span></span> <span data-ttu-id="e87ec-188">Bu örneğin parçasıdır [olmayan genel ParallelForEach](../../../docs/framework/windows-workflow-foundation/samples/non-generic-parallelforeach.md) örnek.</span><span class="sxs-lookup"><span data-stu-id="e87ec-188">This example is part of the [Non-Generic ParallelForEach](../../../docs/framework/windows-workflow-foundation/samples/non-generic-parallelforeach.md) sample.</span></span>  
  
```csharp  
protected override void Cancel(NativeActivityContext context)  
{  
    // If we do not have a completion condition then we can just  
    // use default logic.  
    if (this.CompletionCondition == null)  
    {  
        base.Cancel(context);  
    }  
    else  
    {  
        context.CancelChildren();  
    }  
}  
```  
  
 <span data-ttu-id="e87ec-189"><xref:System.Activities.NativeActivity>türetilen etkinlikleri inceleyerek iptal istedi olmadığını belirleyebilir <xref:System.Activities.NativeActivityContext.IsCancellationRequested%2A> özelliği ve kendilerini çağırarak iptal olarak işaretle <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e87ec-189"><xref:System.Activities.NativeActivity> derived activities can determine if cancellation has been requested by inspecting the <xref:System.Activities.NativeActivityContext.IsCancellationRequested%2A> property, and mark themselves as canceled by calling the <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> method.</span></span> <span data-ttu-id="e87ec-190">Çağırma <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> hemen etkinlik tamamlanmazsa.</span><span class="sxs-lookup"><span data-stu-id="e87ec-190">Calling <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> does not immediately complete the activity.</span></span> <span data-ttu-id="e87ec-191">Her zamanki gibi çalışma zamanı etkinliği artık bekleyen iş olduğunda ancak tamamlayacak <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> son adlı durumu olacaktır <xref:System.Activities.ActivityInstanceState.Canceled> yerine <xref:System.Activities.ActivityInstanceState.Closed>.</span><span class="sxs-lookup"><span data-stu-id="e87ec-191">As usual, the runtime will complete the activity when it has no more outstanding work, but if <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> is called the final state will be <xref:System.Activities.ActivityInstanceState.Canceled> instead of <xref:System.Activities.ActivityInstanceState.Closed>.</span></span>  
  
### <a name="cancellation-using-asynccodeactivity"></a><span data-ttu-id="e87ec-192">İptal AsyncCodeActivity kullanma</span><span class="sxs-lookup"><span data-stu-id="e87ec-192">Cancellation using AsyncCodeActivity</span></span>  
 <span data-ttu-id="e87ec-193"><xref:System.Activities.AsyncCodeActivity>bağlı etkinlikler de sağlayabilir özel iptal mantığı kılarak <xref:System.Activities.AsyncCodeActivity.Cancel%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e87ec-193"><xref:System.Activities.AsyncCodeActivity> based activities can also provide custom cancellation logic by overriding the <xref:System.Activities.AsyncCodeActivity.Cancel%2A> method.</span></span> <span data-ttu-id="e87ec-194">Bu yöntem kılınmayan, etkinlik iptal edilirse hiçbir iptalleri işleme gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-194">If this method is not overridden, then no cancellation handling is performed if the activity is canceled.</span></span> <span data-ttu-id="e87ec-195">Aşağıdaki örnekte, <xref:System.Activities.AsyncCodeActivity.Cancel%2A> , geçersiz bir <xref:System.Activities.AsyncCodeActivity> özel dayalı `ExecutePowerShell` etkinlik tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="e87ec-195">In the following example, the <xref:System.Activities.AsyncCodeActivity.Cancel%2A> override of an <xref:System.Activities.AsyncCodeActivity> based custom `ExecutePowerShell` activity is defined.</span></span> <span data-ttu-id="e87ec-196">Etkinlik iptal ettiğinizde, istenen iptal davranışı gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="e87ec-196">When the activity is canceled, it performs the desired cancellation behavior.</span></span> <span data-ttu-id="e87ec-197">Bu örneğin parçasıdır [InvokePowerShell etkinliğini kullanarak](../../../docs/framework/windows-workflow-foundation/samples/using-the-invokepowershell-activity.md) örnek.</span><span class="sxs-lookup"><span data-stu-id="e87ec-197">This example is part of the [Using the InvokePowerShell Activity](../../../docs/framework/windows-workflow-foundation/samples/using-the-invokepowershell-activity.md) sample.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#1020](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#1020)]  
  
 <span data-ttu-id="e87ec-198"><xref:System.Activities.AsyncCodeActivity>türetilen etkinlikleri inceleyerek iptal istedi olmadığını belirleyebilir <xref:System.Activities.AsyncCodeActivityContext.IsCancellationRequested%2A> özelliği ve kendilerini çağırarak iptal olarak işaretle <xref:System.Activities.AsyncCodeActivityContext.MarkCanceled%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e87ec-198"><xref:System.Activities.AsyncCodeActivity> derived activities can determine if cancellation has been requested by inspecting the <xref:System.Activities.AsyncCodeActivityContext.IsCancellationRequested%2A> property, and mark themselves as canceled by calling the <xref:System.Activities.AsyncCodeActivityContext.MarkCanceled%2A> method.</span></span>
