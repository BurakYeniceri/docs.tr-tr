---
title: "Windows Workflow Foundation 4 performansı"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 67d2b3e8-3777-49f8-9084-abbb33b5a766
caps.latest.revision: "9"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 49851de93df43c409b3110a0fdac39d73b61672c
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/18/2017
---
# <a name="windows-workflow-foundation-4-performance"></a><span data-ttu-id="aac71-102">Windows Workflow Foundation 4 performansı</span><span class="sxs-lookup"><span data-stu-id="aac71-102">Windows Workflow Foundation 4 Performance</span></span>
<span data-ttu-id="aac71-103">Dustin Metzgar</span><span class="sxs-lookup"><span data-stu-id="aac71-103">Dustin Metzgar</span></span>  
  
 <span data-ttu-id="aac71-104">Wenlong Dong</span><span class="sxs-lookup"><span data-stu-id="aac71-104">Wenlong Dong</span></span>  
  
 <span data-ttu-id="aac71-105">Microsoft Corporation ' ın Eylül 2010</span><span class="sxs-lookup"><span data-stu-id="aac71-105">Microsoft Corporation, September 2010</span></span>  
  
 <span data-ttu-id="aac71-106">Microsoft [!INCLUDE[netfx40_long](../../../includes/netfx40-long-md.md)] önemli bir sürümünü içeren [!INCLUDE[wf](../../../includes/wf-md.md)] performansı yoğun yatırım ile.</span><span class="sxs-lookup"><span data-stu-id="aac71-106">Microsoft [!INCLUDE[netfx40_long](../../../includes/netfx40-long-md.md)] includes a major revision of the [!INCLUDE[wf](../../../includes/wf-md.md)] with heavy investments in performance.</span></span>  <span data-ttu-id="aac71-107">Bu yeni bir düzeltme önemli tasarım değişiklikleri önceki sürümlerinden tanıtır [!INCLUDE[wf1](../../../includes/wf1-md.md)] .NET Framework 3.0 bir parçası olarak gönderilen ve [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="aac71-107">This new revision introduces significant design changes from the previous versions of [!INCLUDE[wf1](../../../includes/wf1-md.md)] that shipped as part of .NET Framework 3.0 and [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)].</span></span> <span data-ttu-id="aac71-108">Programlama modeli, çalışma zamanı ve performansını ve kullanılabilirliğini önemli ölçüde artırmak için araç çekirdek yeniden tasarlanmış olmuştur.</span><span class="sxs-lookup"><span data-stu-id="aac71-108">It has been re-architected from the core of the programming model, runtime, and tooling to greatly improve performance and usability.</span></span> <span data-ttu-id="aac71-109">Bu konu, bu düzeltmeleri önemli performans özelliklerini gösterir ve bu önceki sürüm karşı karşılaştırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-109">This topic shows the important performance characteristics of these revisions and compares them against those of the previous version.</span></span>  
  
 <span data-ttu-id="aac71-110">Büyüklük WF3 WF4 arasındaki tarafından ayrı ayrı iş akışı bileşen performansı artar.</span><span class="sxs-lookup"><span data-stu-id="aac71-110">Individual workflow component performance has increased by orders of magnitude between WF3 and WF4.</span></span>  <span data-ttu-id="aac71-111">Bu, elle kodlanmış arasında boşluk bırakır [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] Hizmetleri ve [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] oldukça küçük olacak şekilde iş akışı hizmetleri.</span><span class="sxs-lookup"><span data-stu-id="aac71-111">This leaves the gap between hand-coded [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] services and [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] workflow services to be quite small.</span></span>  <span data-ttu-id="aac71-112">İş akışı gecikme süresi içinde WF4 önemli ölçüde düşürdü.</span><span class="sxs-lookup"><span data-stu-id="aac71-112">Workflow latency has been significantly reduced in WF4.</span></span>  <span data-ttu-id="aac71-113">2.5-3.0 faktörüyle Kalıcılık performans artar.</span><span class="sxs-lookup"><span data-stu-id="aac71-113">Persistence performance has increased by a factor of 2.5 - 3.0.</span></span>  <span data-ttu-id="aac71-114">İş akışı izleme yoluyla sistem durumu izleme önemli ölçüde daha az yüke sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-114">Health monitoring by means of workflow tracking has significantly less overhead.</span></span>  <span data-ttu-id="aac71-115">Bu, geçiş veya WF4 uygulamalarınızda benimsemek için nedenleri çekici.</span><span class="sxs-lookup"><span data-stu-id="aac71-115">These are compelling reasons to migrate to or adopt WF4 in your applications.</span></span>  
  
## <a name="terminology"></a><span data-ttu-id="aac71-116">Terminoloji</span><span class="sxs-lookup"><span data-stu-id="aac71-116">Terminology</span></span>  
 <span data-ttu-id="aac71-117">Sürümü [!INCLUDE[wf1](../../../includes/wf1-md.md)] sunulan [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] için bu konunun geri kalanı için WF4 anılacaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-117">The version of [!INCLUDE[wf1](../../../includes/wf1-md.md)] introduced in [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] will be referred to as WF4 for the rest of this topic.</span></span>  [!INCLUDE[wf1](../../../includes/wf1-md.md)]<span data-ttu-id="aac71-118">.NET 3.0 sunulmuştur ve birkaç küçük düzeltmeden vardı [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] SP1.</span><span class="sxs-lookup"><span data-stu-id="aac71-118"> was introduced in .Net 3.0 and had a few minor revisions through [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] SP1.</span></span> <span data-ttu-id="aac71-119">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] Workflow Foundation sürümü bulunulabilir için WF3 bu konunun geri kalanı için.</span><span class="sxs-lookup"><span data-stu-id="aac71-119">The [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] version of Workflow Foundation will be referred to as WF3 for the rest of this topic.</span></span> <span data-ttu-id="aac71-120">WF3 gönderildiği [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] yana birimi WF4 ile.</span><span class="sxs-lookup"><span data-stu-id="aac71-120">WF3 is shipped in [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] side-by-side with WF4.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="aac71-121">WF4 geçirme WF3 yapılara bkz: [Windows Workflow Foundation 4 Geçiş Kılavuzu](http://go.microsoft.com/fwlink/?LinkID=153313)</span><span class="sxs-lookup"><span data-stu-id="aac71-121"> migrating WF3 artifacts to WF4 see: [Windows Workflow Foundation 4 Migration Guide](http://go.microsoft.com/fwlink/?LinkID=153313)</span></span>  
  
 [!INCLUDE[indigo1](../../../includes/indigo1-md.md)]<span data-ttu-id="aac71-122">Hizmet odaklı uygulamalar oluşturmak için Microsoft'un programlama modelidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-122"> is Microsoft’s unified programming model for building service-oriented applications.</span></span> <span data-ttu-id="aac71-123">İlk .net 3.0 WF3 birlikte bir parçası olarak sunulmuştur ve şimdi anahtar bileşenlerinden biri olan [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="aac71-123">It was first introduced as part of .Net 3.0 together with WF3 and now is one of the key components of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span>  
  
 <span data-ttu-id="aac71-124">Windows Server AppFabric oluşturulmasını, ölçeklenmesini ve Web ve IIS'de çalışan bileşik uygulamaları yönetmek kolaylaştıran bir tümleşik teknoloji kümesidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-124">Windows Server AppFabric is a set of integrated technologies that make it easier to build, scale and manage Web and composite applications that run on IIS.</span></span> <span data-ttu-id="aac71-125">İzleme ve Hizmetleri ve iş akışlarını yönetmek için araçlar sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-125">It provides tools for monitoring and managing services and workflows.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="aac71-126">[Windows Server AppFabric](http://msdn.microsoft.com/windowsserver/ee695849.aspx)</span><span class="sxs-lookup"><span data-stu-id="aac71-126"> [Windows Server AppFabric](http://msdn.microsoft.com/windowsserver/ee695849.aspx)</span></span>  
  
## <a name="goals"></a><span data-ttu-id="aac71-127">Hedefleri</span><span class="sxs-lookup"><span data-stu-id="aac71-127">Goals</span></span>  
 <span data-ttu-id="aac71-128">Bu konuda farklı senaryolar için ölçülen verilerle WF4 performans özelliklerini göstermek için hedefidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-128">The goal of this topic is to show the performance characteristics of WF4 with data measured for different scenarios.</span></span> <span data-ttu-id="aac71-129">Ayrıca WF4 WF3 arasındaki ayrıntılı karşılaştırmaları sağlar ve böylece bu yeni düzeltmede yapılan harika geliştirmeleri gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-129">It also provides detailed comparisons between WF4 and WF3, and thus shows the great improvements that have been made in this new revision.</span></span> <span data-ttu-id="aac71-130">Senaryolar ve bu makalede sunulan veri WF4 ve WF3 farklı yönlerini temel maliyetini ölçme.</span><span class="sxs-lookup"><span data-stu-id="aac71-130">The scenarios and data presented in this article quantify the underlying cost of different aspects of WF4 and WF3.</span></span> <span data-ttu-id="aac71-131">Bu veriler WF4 performans özelliklerini anlamak yararlı olur ve WF4 WF3 kümesinden planlama veya uygulama geliştirme WF4 kullanılarak yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-131">This data is useful in understanding the performance characteristics of WF4 and can be helpful in planning migrations from WF3 to WF4 or using WF4 in application development.</span></span> <span data-ttu-id="aac71-132">Ancak, bu makaledeki sunulan verilerden çizilmiş sonuçları dikkatli olunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-132">However, care should be taken in the conclusions drawn from the data presented in this article.</span></span> <span data-ttu-id="aac71-133">Yüksek oranda bağımlı iş akışının nasıl uygulandığını ve farklı bir bileşik iş akışı uygulamanın performansını bileşenleri ile tümleştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="aac71-133">The performance of a composite workflow application is highly dependent on how the workflow is implemented and how different components are integrated.</span></span> <span data-ttu-id="aac71-134">Bir uygulama performans özelliklerini belirlemek için her bir uygulama ölçmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="aac71-134">One must measure each application to determine the performance characteristics of that application.</span></span>  
  
## <a name="overview-of-wf4-performance-enhancements"></a><span data-ttu-id="aac71-135">WF4 performans geliştirmeleri genel bakış</span><span class="sxs-lookup"><span data-stu-id="aac71-135">Overview of WF4 Performance Enhancements</span></span>  
 <span data-ttu-id="aac71-136">WF4 dikkatli bir şekilde tasarlanmış ve yüksek performans ve aşağıdaki bölümlerde açıklanan ölçeklenebilirlik ile uygulanmıştır.</span><span class="sxs-lookup"><span data-stu-id="aac71-136">WF4 was carefully designed and implemented with high performance and scalability which are described in the following sections.</span></span>  
  
### <a name="wf-runtime"></a><span data-ttu-id="aac71-137">WF çalışma zamanı</span><span class="sxs-lookup"><span data-stu-id="aac71-137">WF Runtime</span></span>  
 <span data-ttu-id="aac71-138">En [!INCLUDE[wf1](../../../includes/wf1-md.md)] çalışma zamanı olan bir iş akışında etkinliklerin yürütülmesini sürücüleri zaman uyumsuz bir zamanlayıcı.</span><span class="sxs-lookup"><span data-stu-id="aac71-138">At the core of the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime is an asynchronous scheduler that drives the execution of the activities in a workflow.</span></span> <span data-ttu-id="aac71-139">Bu kullanıcı, etkinlikler için öngörülebilir yürütme ortamı sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-139">It provides a performant, predictable execution environment for activities.</span></span> <span data-ttu-id="aac71-140">Ortam iyi tanımlanmış bir sözleşme yürütme, devamlılık, tamamlama, iptal, özel durumlar ve tahmin edilebilir bir iş parçacığı modeli vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-140">The environment has a well-defined contract for execution, continuation, completion, cancellation, exceptions, and a predictable threading model.</span></span>  
  
 <span data-ttu-id="aac71-141">WF3 kıyasla daha verimli bir zamanlayıcı WF4 çalışma zamanı yok.</span><span class="sxs-lookup"><span data-stu-id="aac71-141">In comparison to WF3, the WF4 runtime has a more efficient scheduler.</span></span> <span data-ttu-id="aac71-142">İçin kullanılan g/ç iş parçacığı havuzu yararlanır [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], iş öğelerini toplu yürütme en çok verimli olduğu.</span><span class="sxs-lookup"><span data-stu-id="aac71-142">It leverages the same I/O thread pool that is used for [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], which is very efficient at executing batched work items.</span></span> <span data-ttu-id="aac71-143">İç iş öğesi Zamanlayıcı sıranın en yaygın kullanım desenlerini için optimize edilmiştir.</span><span class="sxs-lookup"><span data-stu-id="aac71-143">The internal work item scheduler queue is optimized for most common usage patterns.</span></span> <span data-ttu-id="aac71-144">WF4 çalışma zamanı en az eşitleme ve olay ağır olay kaydı ve karmaşık eşitleme için durumu geçişleri gerçekleştirmek için çağrısının WF3 bağlıdır sırada mantığı, işleme sahip çok hafif şekilde yürütme durumları da yönetir.</span><span class="sxs-lookup"><span data-stu-id="aac71-144">The WF4 runtime also manages the execution states in a very light-weight way with minimal synchronization and event handling logic, while WF3 depends on heavy-weight event registration and invocation to perform complex synchronization for state transitions.</span></span>  
  
### <a name="data-storage-and-flow"></a><span data-ttu-id="aac71-145">Veri depolama ve akış</span><span class="sxs-lookup"><span data-stu-id="aac71-145">Data Storage and Flow</span></span>  
 <span data-ttu-id="aac71-146">WF3 içinde bir etkinlikle ilişkili veri türü tarafından uygulanan bağımlılık özellikleri aracılığıyla modellenir <xref:System.Windows.DependencyProperty>.</span><span class="sxs-lookup"><span data-stu-id="aac71-146">In WF3, data associated with an activity is modeled through dependency properties implemented by the type <xref:System.Windows.DependencyProperty>.</span></span> <span data-ttu-id="aac71-147">Bağımlılık özelliği düzeni sunulmuştur [!INCLUDE[avalon1](../../../includes/avalon1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="aac71-147">The dependency property pattern was introduced in [!INCLUDE[avalon1](../../../includes/avalon1-md.md)].</span></span> <span data-ttu-id="aac71-148">Genel olarak, bu deseni kolay veri bağlama ve diğer kullanıcı Arabirimi özelliklerini desteklemek için çok esnektir.</span><span class="sxs-lookup"><span data-stu-id="aac71-148">In general, this pattern is very flexible to support easy data binding and other UI features.</span></span> <span data-ttu-id="aac71-149">Ancak, düzeni iş akışı tanımı statik alanlar olarak tanımlanması için özellikleri gerektirir.</span><span class="sxs-lookup"><span data-stu-id="aac71-149">However, the pattern requires the properties to be defined as static fields in the workflow definition.</span></span> <span data-ttu-id="aac71-150">Her [!INCLUDE[wf1](../../../includes/wf1-md.md)] özellik değerlerini alır veya ayarlar çalışma zamanı, son derece ağırlıklı arama mantığı içerir.</span><span class="sxs-lookup"><span data-stu-id="aac71-150">Whenever the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime sets or gets the property values, it involves heavily-weighted look-up logic.</span></span>  
  
 <span data-ttu-id="aac71-151">WF4 mantığı kapsamı Temizle verileri veri akışında nasıl işlendiğini büyük ölçüde artırmak için kullanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-151">WF4 uses clear data scoping logic to greatly improve how data is handled in a workflow.</span></span> <span data-ttu-id="aac71-152">İki farklı kavram kullanarak etkinlik sınırları boyunca akan verilerden bir etkinlikte depolanan verileri ayırır: değişkenleri ve bağımsız değişkenler.</span><span class="sxs-lookup"><span data-stu-id="aac71-152">It separates the data stored in an activity from the data that is flowing across the activity boundaries by using two different concepts: variables and arguments.</span></span> <span data-ttu-id="aac71-153">Değişkenleri ve "İçinde/çıkış/InOut" bağımsız değişkenler için temizleyin hiyerarşik bir kapsam kullanarak etkinlikler için verileri kullanım karmaşıklığını önemli ölçüde azalır ve veri ömrü da otomatik olarak kapsamlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-153">By using a clear hierarchical scope for variables and "In/Out/InOut" arguments, the data usage complexity for activities is dramatically reduced and the lifetime of the data is also automatically scoped.</span></span> <span data-ttu-id="aac71-154">Etkinlikler değişkenlerinin tarafından açıklanan iyi tanımlanmış bir imzaya sahip.</span><span class="sxs-lookup"><span data-stu-id="aac71-154">Activities have a well-defined signature described by its arguments.</span></span> <span data-ttu-id="aac71-155">Bir etkinlik inceleyerek almak için bekliyor hangi verilerin ve hangi verilerin tarafından yürütülmesinin sonucu olarak üretilecek belirleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aac71-155">By simply inspecting an activity you can determine what data it expects to receive and what data will be produced by it as the result of its execution.</span></span>  
  
 <span data-ttu-id="aac71-156">Bir iş akışı oluşturduğunuzda WF3 etkinlikleri başlatılan.</span><span class="sxs-lookup"><span data-stu-id="aac71-156">In WF3 activities were initialized when a workflow was created.</span></span> <span data-ttu-id="aac71-157">Yalnızca ilgili etkinlikleri yürütülürken WF 4'te etkinlikleri başlatılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-157">In WF 4 activities are initialized only when the corresponding activities are executing.</span></span> <span data-ttu-id="aac71-158">Bu yeni bir iş akışı örneği oluşturulduğunda ve bu nedenle daha fazla verimlilik elde ettiği başlatma/UnInitialize işlemlerini gerçekleştirme olmadan daha basit bir etkinlik yaşam döngüsü sağlar</span><span class="sxs-lookup"><span data-stu-id="aac71-158">This allows a simpler activity lifecycle without performing Initialize/Uninitialize operations when a new workflow instance is created, and thus has achieved more efficiency</span></span>  
  
### <a name="control-flow"></a><span data-ttu-id="aac71-159">Denetim Akışı</span><span class="sxs-lookup"><span data-stu-id="aac71-159">Control Flow</span></span>  
 <span data-ttu-id="aac71-160">Herhangi bir programlama dili olduğu gibi yalnızca [!INCLUDE[wf1](../../../includes/wf1-md.md)] döngü, sıralama, dallanma ve diğer desenler için denetim akışı etkinlikleri kümesi tanımlayarak Denetim Akışları iş akışı tanımları için destek sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-160">Just as in any programming language, [!INCLUDE[wf1](../../../includes/wf1-md.md)] provides support for control flows for workflow definitions by introducing a set of control flow activities for sequencing, looping, branching and other patterns.</span></span> <span data-ttu-id="aac71-161">Aynı etkinlik, yeni bir yeniden yürütülmesi gerektiğinde WF3 içinde <xref:System.Workflow.ComponentModel.ActivityExecutionContext> oluşturulur ve etkinlik dayalı bir ağır seri hale getirme ve seri durumdan çıkarma mantığı üzerinden kopyalanması <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter>.</span><span class="sxs-lookup"><span data-stu-id="aac71-161">In WF3, when the same activity needs to be re-executed, a new <xref:System.Workflow.ComponentModel.ActivityExecutionContext> is created and the activity is cloned through a heavy-weight serialization and deserialization logic based on <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter>.</span></span> <span data-ttu-id="aac71-162">Genellikle performans yinelemeli denetim akışları için etkinlikler dizisini yürütme daha yavaştır.</span><span class="sxs-lookup"><span data-stu-id="aac71-162">Usually the performance for iterative control flows is much slower than executing a sequence of activities.</span></span>  
  
 <span data-ttu-id="aac71-163">WF4 bu oldukça farklı bir şekilde işler.</span><span class="sxs-lookup"><span data-stu-id="aac71-163">WF4 handles this quite differently.</span></span> <span data-ttu-id="aac71-164">Etkinlik şablonu alır, yeni bir ActivityInstance nesnesi oluşturur ve Zamanlayıcı kuyruğa ekler.</span><span class="sxs-lookup"><span data-stu-id="aac71-164">It takes the activity template, creates a new ActivityInstance object, and adds it to the scheduler queue.</span></span> <span data-ttu-id="aac71-165">Tüm bu işlem yalnızca açık nesne oluşturma içerir ve çok hafif.</span><span class="sxs-lookup"><span data-stu-id="aac71-165">This whole process only involves explicit object creation and is very light-weight.</span></span>  
  
### <a name="asynchronous-programming"></a><span data-ttu-id="aac71-166">Zaman uyumsuz programlama</span><span class="sxs-lookup"><span data-stu-id="aac71-166">Asynchronous Programming</span></span>  
 <span data-ttu-id="aac71-167">Uygulamalar genellikle daha iyi performans ve ölçeklenebilirlik g/ç gibi uzun süren durdurma işlemlerini veya dağıtılmış bilgi işlem işlemleri için zaman uyumsuz programlama ile sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-167">Applications usually have better performance and scalability with asynchronous programming for long running blocking operations such as I/O or distributed computing operations.</span></span> <span data-ttu-id="aac71-168">Temel etkinlik türleri üzerinden zaman uyumsuz desteği sağlar. WF4 <xref:System.Activities.AsyncCodeActivity>, <xref:System.Activities.AsyncCodeActivity%601>.</span><span class="sxs-lookup"><span data-stu-id="aac71-168">WF4 provides asynchronous support through base activity types <xref:System.Activities.AsyncCodeActivity>, <xref:System.Activities.AsyncCodeActivity%601>.</span></span> <span data-ttu-id="aac71-169">Çalışma zamanı yerel olarak zaman uyumsuz etkinlikleri anlar ve zaman uyumsuz iş bekleyen olsa da bu nedenle otomatik olarak örnek no-persist bölgesinde koyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aac71-169">The runtime natively understands asynchronous activities and therefore can automatically put the instance in a no-persist zone while the asynchronous work is outstanding.</span></span> <span data-ttu-id="aac71-170">Özel etkinlikler iş akışı Zamanlayıcı iş parçacığı tutan ve paralel olarak çalıştırılabilmesi için hiç etkinlik engelleme olmadan zaman uyumsuz işlemleri gerçekleştirmesi için bu türlerinden türetmesine.</span><span class="sxs-lookup"><span data-stu-id="aac71-170">Custom activities can derive from these types to perform asynchronous work without holding the workflow scheduler thread and blocking any activities that may be able to run in parallel.</span></span>  
  
### <a name="messaging"></a><span data-ttu-id="aac71-171">İleti</span><span class="sxs-lookup"><span data-stu-id="aac71-171">Messaging</span></span>  
 <span data-ttu-id="aac71-172">Başlangıçta WF3 çok olan dış olayları veya web üzerinden sınırlı Mesajlaşma Destek Hizmetleri çağrılarını.</span><span class="sxs-lookup"><span data-stu-id="aac71-172">Initially WF3 had very limited messaging support through external events or web services invocations.</span></span> <span data-ttu-id="aac71-173">.NET 3.5, iş akışları olarak uygulanabilir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] istemcileri veya olarak sunulan [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] aracılığıyla Hizmetleri <xref:System.Workflow.Activities.SendActivity> ve <xref:System.Workflow.Activities.ReceiveActivity>.</span><span class="sxs-lookup"><span data-stu-id="aac71-173">In .Net 3.5, workflows could be implemented as [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] clients or exposed as [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services through <xref:System.Workflow.Activities.SendActivity> and <xref:System.Workflow.Activities.ReceiveActivity>.</span></span> <span data-ttu-id="aac71-174">WF4 içinde iş akışı tabanlı Mesajlaşma programlama kavramı daha fazla ile sıkı tümleştirme güçlendirilmiş [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] mantığı WF Mesajlaşma.</span><span class="sxs-lookup"><span data-stu-id="aac71-174">In WF4, the concept of workflow-based messaging programming has been further strengthened through the tight integration of [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] messaging logic into WF.</span></span>  
  
 <span data-ttu-id="aac71-175">Sağlanan birleştirilmiş ileti işleme ardışık düzen [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] .Net 4 önemli ölçüde daha iyi performans ve ölçeklenebilirlik WF3 daha WF4 Hizmetleri yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="aac71-175">The unified message processing pipeline provided in [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] in .Net 4 helps WF4 services to have significantly better performance and scalability than WF3.</span></span> <span data-ttu-id="aac71-176">WF4 karmaşık ileti Exchange desenleri (MEPs) model daha zengin Mesajlaşma programlama desteği de sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-176">WF4 also provides richer messaging programming support that can model complex Message Exchange Patterns (MEPs).</span></span> <span data-ttu-id="aac71-177">Geliştiriciler ya da yazılı Hizmet sözleşmeleri kolay programlama veya seri hale getirme maliyetleri ödeme olmadan daha iyi performans elde etmek için türsüz Hizmet sözleşmeleri elde etmek için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aac71-177">Developers can use either typed service contracts to achieve easy programming or un-typed service contracts to achieve better performance without paying serialization costs.</span></span> <span data-ttu-id="aac71-178">İstemci tarafı önbelleğe alma desteğini kanal <xref:System.ServiceModel.Activities.SendMessageChannelCache> WF4 sınıfında geliştiricileri en az çaba ile hızlı uygulamalar oluşturmanıza yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="aac71-178">The client-side channel caching support through the <xref:System.ServiceModel.Activities.SendMessageChannelCache> class in WF4 helps developers build fast applications with minimal effort.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="aac71-179">[Düzeyleri gönderme işlemleri için önbellek paylaşımı değiştirme](../../../docs/framework/wcf/feature-details/changing-the-cache-sharing-levels-for-send-activities.md).</span><span class="sxs-lookup"><span data-stu-id="aac71-179"> [Changing the Cache Sharing Levels for Send Activities](../../../docs/framework/wcf/feature-details/changing-the-cache-sharing-levels-for-send-activities.md).</span></span>  
  
### <a name="declarative-programming"></a><span data-ttu-id="aac71-180">Bildirim temelli programlama</span><span class="sxs-lookup"><span data-stu-id="aac71-180">Declarative Programming</span></span>  
 <span data-ttu-id="aac71-181">WF4 bir temiz ve basit bildirim temelli programlama çerçevesi model iş süreçlerini ve hizmetleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-181">WF4 provides a clean and simple declarative programming framework to model business processes and services.</span></span> <span data-ttu-id="aac71-182">Tam bildirim temelli birleşim ile hiçbir kod-iş akışı yazma büyük ölçüde basitleştirir yanında, etkinliklerin programlama modelini destekler.</span><span class="sxs-lookup"><span data-stu-id="aac71-182">The programming model supports fully declarative composition of activities, with no code-beside, greatly simplifying workflow authoring.</span></span> <span data-ttu-id="aac71-183">İçinde [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)], XAML tabanlı bildirim temelli programlama çerçevesini tek derlemeye WPF ve WF desteklemek için System.Xaml.dll birleşik.</span><span class="sxs-lookup"><span data-stu-id="aac71-183">In [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)], the XAML-based declarative programming framework has been unified into the single assembly System.Xaml.dll to support both WPF and WF.</span></span>  
  
 <span data-ttu-id="aac71-184">WF4, XAML gerçekten bildirim temelli bir deneyim sağlar ve etkinlikleri ve .NET kullanarak yerleşik türleri başvuran tüm iş akışı tanımı için XML biçimlendirmede tanımlanmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="aac71-184">In WF4, XAML provides a truly declarative experience and allows for the entire definition of the workflow to be defined in XML markup, referencing activities and types built using .NET.</span></span> <span data-ttu-id="aac71-185">Bu, özel arka plan kodu mantığı karıştırılmaksızın içinde WF3 XOML biçimi ile yapmak zordu.</span><span class="sxs-lookup"><span data-stu-id="aac71-185">This was difficult to do in WF3 with XOML format without involving custom code-behind logic.</span></span> <span data-ttu-id="aac71-186">Yeni XAML yığını .net 4'te seri hale getirme/iş akışı yapıları seri durumdan Çıkarmada çok daha iyi performans var ve bildirim temelli programlama daha çekici ve sağlam hale getirin.</span><span class="sxs-lookup"><span data-stu-id="aac71-186">The new XAML-stack in .Net 4 has much better performance in serializing/deserializing workflow artifacts and makes declarative programming more attractive and solid.</span></span>  
  
### <a name="workflow-designer"></a><span data-ttu-id="aac71-187">İş Akışı Tasarımcısı</span><span class="sxs-lookup"><span data-stu-id="aac71-187">Workflow Designer</span></span>  
 <span data-ttu-id="aac71-188">Tam bildirim temelli programlama desteği WF4 açıkça tasarım sırasında performansı büyük iş akışları için daha yüksek gereksinimleri getirir.</span><span class="sxs-lookup"><span data-stu-id="aac71-188">Fully declarative programming support for WF4 explicitly imposes higher requirements for design time performance for large workflows.</span></span> <span data-ttu-id="aac71-189">İş Akışı Tasarımcısı'nda WF4 WF3 için çok büyük iş akışları için daha iyi ölçeklenebilirlik daha vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-189">The Workflow designer in WF4 has much better scalability for large workflows than that for WF3.</span></span> <span data-ttu-id="aac71-190">Bir iş akışı birkaç yüz etkinliklerin WF3 Tasarımcısı ile yüklemek neredeyse imkansız olsa UI sanallaştırma desteği ile Tasarımcı kolayca 1000 etkinliklerin büyük bir iş akışı birkaç saniye içinde yükleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aac71-190">With UI virtualization support, the designer can easily load a large workflow of 1000 activities in a few seconds, while it is almost impossible to load a workflow of a few hundred activities with the WF3 designer.</span></span>  
  
## <a name="component-level-performance-comparisons"></a><span data-ttu-id="aac71-191">Bileşen düzeyinde performans karşılaştırmaları</span><span class="sxs-lookup"><span data-stu-id="aac71-191">Component-level Performance Comparisons</span></span>  
 <span data-ttu-id="aac71-192">Bu bölümde WF3 ve WF4 iş akışlarında etkinlikler arasında doğrudan karşılaştırmaları verilerini içerir.</span><span class="sxs-lookup"><span data-stu-id="aac71-192">This section contains data on direct comparisons between individual activities in WF3 and WF4 workflows.</span></span>  <span data-ttu-id="aac71-193">Kalıcılık gibi önemli alanlar performans tek tek etkinlikleri Bileşenler'den daha çok büyük bir etkisi vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-193">Key areas like persistence have a more profound impact on performance than the individual activity components.</span></span>  <span data-ttu-id="aac71-194">WF4 bileşenleri tek tek deki performans iyileştirmeleri, ancak bileşenler şimdi orchestration el kodlanmış mantığı karşı Karşılaştırılacak hızlı olduğu için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-194">The performance improvements in individual components in WF4 are important though because the components are now fast enough to be compared against hand-coded orchestration logic.</span></span>  <span data-ttu-id="aac71-195">Bir örneği bir sonraki bölümde ele alınmıştır: "Hizmet birleşim senaryosu."</span><span class="sxs-lookup"><span data-stu-id="aac71-195">An example of which is covered in the next section: "Service Composition Scenario."</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="aac71-196">Ortam Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-196">Environment Setup</span></span>  
 <span data-ttu-id="aac71-197">![İş akışı performansı sınama ortamı](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-197">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
 <span data-ttu-id="aac71-198">Yukarıdaki şekilde, bileşen düzeyinde performans ölçümü için kullanılan makine yapılandırmasını gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-198">The above figure shows the machine configuration used for component-level performance measurement.</span></span> <span data-ttu-id="aac71-199">Tek bir sunucu ve beş istemciler üzerinde bir 1 GB/sn Ethernet ağ arabirim bağlı.</span><span class="sxs-lookup"><span data-stu-id="aac71-199">A single server and five clients connected over one 1-Gbps Ethernet network interface.</span></span> <span data-ttu-id="aac71-200">Kolay ölçümler için sunucunun Windows Server 2008 x86 çalıştıran bir çift proc/dört çekirdek sunucusunun tek bir çekirdek kullanacak şekilde yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-200">For easy measurements, the server is configured to use a single core of a dual-proc/quad-core server  running Windows Server 2008 x86.</span></span> <span data-ttu-id="aac71-201">CPU kullanımı sistem yaklaşık % 100 oranında korunur.</span><span class="sxs-lookup"><span data-stu-id="aac71-201">The system CPU utilization is maintained at nearly 100%.</span></span>  
  
### <a name="test-details"></a><span data-ttu-id="aac71-202">Test Ayrıntıları</span><span class="sxs-lookup"><span data-stu-id="aac71-202">Test Details</span></span>  
 <span data-ttu-id="aac71-203">WF3 <xref:System.Workflow.Activities.CodeActivity> büyük olasılıkla WF3 iş akışı içinde kullanılabilecek en basit bir etkinliktir.</span><span class="sxs-lookup"><span data-stu-id="aac71-203">The WF3 <xref:System.Workflow.Activities.CodeActivity> is likely the simplest activity that can be used in a WF3 workflow.</span></span>  <span data-ttu-id="aac71-204">Etkinlik, iş akışı programcı özel kod içine koyabilirsiniz arka plan kod içinde bir yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-204">The activity calls a method in the code-behind that the workflow programmer can put custom code into.</span></span>  <span data-ttu-id="aac71-205">WF4 içinde WF3 için hiçbir doğrudan analog olduğundan <xref:System.Workflow.Activities.CodeActivity> aynı işlevselliği sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-205">In WF4, there is no direct analog to the WF3 <xref:System.Workflow.Activities.CodeActivity> that provides the same functionality.</span></span>  <span data-ttu-id="aac71-206">Unutmayın bir <xref:System.Activities.CodeActivity> temel WF3 ilgili olmayan WF4 sınıfında <xref:System.Workflow.Activities.CodeActivity>.</span><span class="sxs-lookup"><span data-stu-id="aac71-206">Note that there is a <xref:System.Activities.CodeActivity> base class in WF4 that is not related to the WF3 <xref:System.Workflow.Activities.CodeActivity>.</span></span>  <span data-ttu-id="aac71-207">İş akışı yazarları özel etkinlikler ve yalnızca XAML iş akışları oluşturmak için önerilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-207">Workflow authors are encouraged to create custom activities and build XAML-only workflows.</span></span>  <span data-ttu-id="aac71-208">Bir etkinlik testlerinde adlı `Comment` yerine boş bir kullanılan <xref:System.Workflow.Activities.CodeActivity> WF4 iş akışlarında.</span><span class="sxs-lookup"><span data-stu-id="aac71-208">In the tests below, an activity called `Comment` is used in place of an empty <xref:System.Workflow.Activities.CodeActivity> in WF4 workflows.</span></span>  <span data-ttu-id="aac71-209">Kodda `Comment` etkinlik aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="aac71-209">The code in the `Comment` activity is as follows:</span></span>  
  
```  
[ContentProperty("Body")]  
    public sealed class Comment : CodeActivity  
    {  
        public Comment()  
            : base()  
        {  
        }  
  
        [DefaultValue(null)]  
        public Activity Body  
        {  
            get;  
            set;  
        }  
  
        protected override void Execute(CodeActivityContext context)  
        {  
        }  
    }  
```  
  
### <a name="empty-workflow"></a><span data-ttu-id="aac71-210">Boş iş akışı</span><span class="sxs-lookup"><span data-stu-id="aac71-210">Empty Workflow</span></span>  
 <span data-ttu-id="aac71-211">Bu test, hiçbir alt etkinliklerle bir sıralı iş akışı kullanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-211">This test uses a sequence workflow with no child activities.</span></span>  
  
### <a name="single-activity"></a><span data-ttu-id="aac71-212">Tek etkinliği</span><span class="sxs-lookup"><span data-stu-id="aac71-212">Single Activity</span></span>  
 <span data-ttu-id="aac71-213">Bir alt etkinliğini içeren bir sıralı iş akışı iş akışıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-213">The workflow is a sequence workflow containing one child activity.</span></span>  <span data-ttu-id="aac71-214">Etkinliği bir <xref:System.Workflow.Activities.CodeActivity> WF3 durumda kod olmadan ve `Comment` etkinlik WF4 durumda.</span><span class="sxs-lookup"><span data-stu-id="aac71-214">The activity is a <xref:System.Workflow.Activities.CodeActivity> with no code in the WF3 case and a `Comment` activity in the WF4 case.</span></span>  
  
### <a name="while-with-1000-iterations"></a><span data-ttu-id="aac71-215">While 1000 yineleme ile</span><span class="sxs-lookup"><span data-stu-id="aac71-215">While with 1000 Iterations</span></span>  
 <span data-ttu-id="aac71-216">Sıralı iş akışı içeriyor <xref:System.Activities.Statements.While> herhangi bir iş gerçekleştirmez döngüsünde bir alt aktivitesiyle etkinlik.</span><span class="sxs-lookup"><span data-stu-id="aac71-216">The sequence workflow contains one <xref:System.Activities.Statements.While> activity with one child activity in the loop that does not perform any work.</span></span>  
  
### <a name="replicator-compared-to-parallelforeach"></a><span data-ttu-id="aac71-217">Çoğaltıcı ParallelForEach için karşılaştırma</span><span class="sxs-lookup"><span data-stu-id="aac71-217">Replicator compared to ParallelForEach</span></span>  
 <span data-ttu-id="aac71-218"><xref:System.Workflow.Activities.ReplicatorActivity>içinde WF3 sıralı ve Paralel yürütme modu vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-218"><xref:System.Workflow.Activities.ReplicatorActivity> in WF3 has sequential and parallel execution modes.</span></span>  <span data-ttu-id="aac71-219">Sıralı modunda etkinliğe ilişkin performans benzer <xref:System.Workflow.Activities.WhileActivity>.</span><span class="sxs-lookup"><span data-stu-id="aac71-219">In sequential mode, the activity’s performance is similar to the <xref:System.Workflow.Activities.WhileActivity>.</span></span>  <span data-ttu-id="aac71-220"><xref:System.Workflow.Activities.ReplicatorActivity> Paralel yürütme için kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-220">The <xref:System.Workflow.Activities.ReplicatorActivity> is most useful for parallel execution.</span></span>  <span data-ttu-id="aac71-221">Bu WF4 analog olduğu <xref:System.Activities.Statements.ParallelForEach%601> etkinlik.</span><span class="sxs-lookup"><span data-stu-id="aac71-221">The WF4 analog for this is the <xref:System.Activities.Statements.ParallelForEach%601> activity.</span></span>  
  
 <span data-ttu-id="aac71-222">Aşağıdaki diyagramda bu test için kullanılan iş akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="aac71-222">The following diagram shows the workflows used for this test.</span></span> <span data-ttu-id="aac71-223">WF3 iş akışı solda ve WF4 iş akışı sağ tarafta.</span><span class="sxs-lookup"><span data-stu-id="aac71-223">The WF3 workflow is on the left and the WF4 workflow is on the right.</span></span>  
  
 <span data-ttu-id="aac71-224">![WF3 ReplicatorActivity ve WF4 ParallelForEach](../../../docs/framework/windows-workflow-foundation/media/replicatorandparallelforeach.gif "ReplicatorAndParallelForEach")</span><span class="sxs-lookup"><span data-stu-id="aac71-224">![WF3 ReplicatorActivity and WF4 ParallelForEach](../../../docs/framework/windows-workflow-foundation/media/replicatorandparallelforeach.gif "ReplicatorAndParallelForEach")</span></span>  
  
### <a name="sequential-workflow-with-five-activities"></a><span data-ttu-id="aac71-225">Beş etkinliklerle sıralı iş akışı</span><span class="sxs-lookup"><span data-stu-id="aac71-225">Sequential Workflow with Five Activities</span></span>  
 <span data-ttu-id="aac71-226">Bu test bir sırayla yürütmek çeşitli etkinlikler kullanılmasının etkisini göstermek için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="aac71-226">This test is meant to show the effect of having several activities execute in sequence.</span></span>  <span data-ttu-id="aac71-227">Sıralı etkinlikler beş vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-227">There are five activities in the sequence.</span></span>  
  
### <a name="transaction-scope"></a><span data-ttu-id="aac71-228">İşlem kapsamı</span><span class="sxs-lookup"><span data-stu-id="aac71-228">Transaction Scope</span></span>  
 <span data-ttu-id="aac71-229">Her yineleme için yeni bir iş akışı örneği oluşturulmamış işlem kapsam test diğer testlerden biraz farklıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-229">The transaction scope test differs from the other tests slightly in that a new workflow instance is not created for every iteration.</span></span>  <span data-ttu-id="aac71-230">Bunun yerine, iş akışı biraz ile yapılandırılmış döngü içeren bir <xref:System.Activities.Statements.TransactionScope> hiçbir iş olmadığından tek bir etkinlik içeren etkinlik.</span><span class="sxs-lookup"><span data-stu-id="aac71-230">Instead, the workflow is structured with a while loop containing a <xref:System.Activities.Statements.TransactionScope> activity containing a single activity that does no work.</span></span>  <span data-ttu-id="aac71-231">Her çalışma bir toplu işlemin while aracılığıyla 50 tekrar döngü tek bir işlem olarak kabul edilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-231">Each run of a batch of 50 iterations through the while loop is counted as a single operation.</span></span>  
  
### <a name="compensation"></a><span data-ttu-id="aac71-232">Maaş</span><span class="sxs-lookup"><span data-stu-id="aac71-232">Compensation</span></span>  
 <span data-ttu-id="aac71-233">Adlı tek bir üst öğesi dengelenebilir etkinlik WF3 iş akışı sahip `WorkScope`.</span><span class="sxs-lookup"><span data-stu-id="aac71-233">The WF3 workflow has a single compensatable activity named `WorkScope`.</span></span>  <span data-ttu-id="aac71-234">Yalnızca etkinlik uygulayan <xref:System.Workflow.ComponentModel.ICompensatableActivity> arabirimi:</span><span class="sxs-lookup"><span data-stu-id="aac71-234">The activity simply implements the <xref:System.Workflow.ComponentModel.ICompensatableActivity> interface:</span></span>  
  
```  
class WorkScope :   
        CompositeActivity, ICompensatableActivity  
    {  
        public WorkScope() : base() { }  
  
        public WorkScope(string name)  
        {  
            this.Name = name;  
        }  
  
        public ActivityExecutionStatus Compensate(  
            ActivityExecutionContext executionContext)  
        {  
            return ActivityExecutionStatus.Closed;  
        }  
    }  
```  
  
 <span data-ttu-id="aac71-235">Hataya işleyici hedefleri `WorkScope` etkinlik. Eşit oranda simplistic WF4 akışıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-235">The fault handler targets the `WorkScope` activity.The WF4 workflow is equally simplistic.</span></span>  <span data-ttu-id="aac71-236">A <xref:System.Activities.Statements.CompensableActivity> gövde ve bir dengeleme işleyicisini sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-236">A <xref:System.Activities.Statements.CompensableActivity> has a body and a compensation handler.</span></span>  <span data-ttu-id="aac71-237">Bir açık compensate sırayla sonraki ' dir.</span><span class="sxs-lookup"><span data-stu-id="aac71-237">An explicit compensate is next in the sequence.</span></span>  <span data-ttu-id="aac71-238">Gövde ve maaş işleyici etkinliğiyle hem boş uygulamaları şunlardır:</span><span class="sxs-lookup"><span data-stu-id="aac71-238">The body activity and compensation handler activity are both empty implementations:</span></span>  
  
```  
public sealed class CompensableActivityEmptyCompensation : CodeActivity  
    {  
        public CompensableActivityEmptyCompensation()  
            : base() { }  
  
        public Activity Body { get; set; }  
  
        protected override void Execute(CodeActivityContext context) { }  
    }  
    public sealed class CompensableActivityEmptyBody : CodeActivity  
    {  
        public CompensableActivityEmptyBody()  
            : base() { }  
  
        public Activity Body { get; set; }  
  
        protected override void Execute(CodeActivityContext context) { }  
    }  
```  
  
 <span data-ttu-id="aac71-239">![WF3 ve WF iş akışları temel maaş](../../../docs/framework/windows-workflow-foundation/media/basiccompensationworkflows.gif "BasicCompensationWorkflows")</span><span class="sxs-lookup"><span data-stu-id="aac71-239">![WF3 and WF basic compensation workflows](../../../docs/framework/windows-workflow-foundation/media/basiccompensationworkflows.gif "BasicCompensationWorkflows")</span></span>  
  
 <span data-ttu-id="aac71-240">Şekil 2 – WF3 (sol) ve WF4 (sağdaki) temel Maaş iş akışları</span><span class="sxs-lookup"><span data-stu-id="aac71-240">Figure 2 – WF3 (left) and WF4 (right) basic compensation workflows</span></span>  
  
### <a name="performance-test-results"></a><span data-ttu-id="aac71-241">Performans testi sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-241">Performance Test Results</span></span>  
 <span data-ttu-id="aac71-242">![Performans testi sonuçları](../../../docs/framework/windows-workflow-foundation/media/performancedata.gif "performans")</span><span class="sxs-lookup"><span data-stu-id="aac71-242">![Performance Test Results](../../../docs/framework/windows-workflow-foundation/media/performancedata.gif "PerformanceData")</span></span>  
  
 <span data-ttu-id="aac71-243">![Performans testi veri grafiği](../../../docs/framework/windows-workflow-foundation/media/performancetestchart.gif "PerformanceTestChart")</span><span class="sxs-lookup"><span data-stu-id="aac71-243">![Performance Test Data Graph](../../../docs/framework/windows-workflow-foundation/media/performancetestchart.gif "PerformanceTestChart")</span></span>  
  
 <span data-ttu-id="aac71-244">Tüm testler, iş akışlarında işlem kapsam test dışında saniyede ölçülür.</span><span class="sxs-lookup"><span data-stu-id="aac71-244">All tests are measured in workflows per second with the exception of the transaction scope test.</span></span>  <span data-ttu-id="aac71-245">Yukarıdaki görüldüğü gibi [!INCLUDE[wf1](../../../includes/wf1-md.md)] çalışma zamanı performans geliştirilmiş panosunda, özellikle while gibi aynı etkinliğin birden çok yürütmeleri gerektiren alanlar arasında döngü.</span><span class="sxs-lookup"><span data-stu-id="aac71-245">As can be seen above, the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime performance has improved across the board, especially in areas that require multiple executions of the same activity like the while loop.</span></span>  
  
## <a name="service-composition-scenario"></a><span data-ttu-id="aac71-246">Hizmet oluşturma senaryosu</span><span class="sxs-lookup"><span data-stu-id="aac71-246">Service Composition Scenario</span></span>  
 <span data-ttu-id="aac71-247">"Bileşen düzeyinde performans karşılaştırmaları" önceki bölümde gösterildiği gibi önemli ölçüde azalma WF3 WF4 arasındaki yükündeki açıldı.</span><span class="sxs-lookup"><span data-stu-id="aac71-247">As is shown in the previous section, "Component-level Performance Comparisons," there has been a significant reduction in overhead between WF3 and WF4.</span></span>  [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]<span data-ttu-id="aac71-248">İş akışı Hizmetleri artık neredeyse aynı el kodlanmış performansını [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] hizmetleri hala ancak sahip tüm avantajlarını [!INCLUDE[wf1](../../../includes/wf1-md.md)] çalışma zamanı.</span><span class="sxs-lookup"><span data-stu-id="aac71-248"> workflow services can now almost match the performance of hand-coded [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services but still have all the benefits of the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime.</span></span>  <span data-ttu-id="aac71-249">Bu test senaryosu karşılaştıran bir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] karşı hizmet bir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] WF4 iş akışı hizmetinde.</span><span class="sxs-lookup"><span data-stu-id="aac71-249">This test scenario compares a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service against a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] workflow service in WF4.</span></span>  
  
### <a name="online-store-service"></a><span data-ttu-id="aac71-250">Çevrimiçi depolama hizmeti</span><span class="sxs-lookup"><span data-stu-id="aac71-250">Online Store Service</span></span>  
 <span data-ttu-id="aac71-251">Gücü birini [!INCLUDE[wf2](../../../includes/wf2-md.md)] birkaç hizmetleri kullanan işlemleri oluşturma yeteneği.</span><span class="sxs-lookup"><span data-stu-id="aac71-251">One of the strengths of [!INCLUDE[wf2](../../../includes/wf2-md.md)] is the ability to compose processes using several services.</span></span>  <span data-ttu-id="aac71-252">Bu örnekte, bir sıra satın almak için iki hizmet çağrıları düzenler bir çevrimiçi mağaza hizmeti yok.</span><span class="sxs-lookup"><span data-stu-id="aac71-252">For this example, there is an online store service that orchestrates two service calls to purchase an order.</span></span>  <span data-ttu-id="aac71-253">İlk adım bir sipariş doğrulama hizmetini kullanarak sipariş doğrulamaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-253">The first step is to validate the order using an Order Validating Service.</span></span>  <span data-ttu-id="aac71-254">İkinci adım ambar hizmetini kullanarak sipariş doldurmaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-254">The second step is to fill the order using a Warehouse Service.</span></span>  
  
 <span data-ttu-id="aac71-255">İki arka uç, sipariş doğrulama ve hizmetlerini ambarı hizmeti, her iki testler için aynı kalır.</span><span class="sxs-lookup"><span data-stu-id="aac71-255">The two backend services, Order Validating Service and Warehouse Service, remain the same for both tests.</span></span>  <span data-ttu-id="aac71-256">Değişen orchestration gerçekleştirir çevrimiçi mağaza hizmetinin parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-256">The part that changes is the Online Store Service that performs the orchestration.</span></span>  <span data-ttu-id="aac71-257">Bir durumda, hizmet el olarak kodlanmıştır bir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] hizmet.</span><span class="sxs-lookup"><span data-stu-id="aac71-257">In one case, the service is hand-coded as a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service.</span></span>  <span data-ttu-id="aac71-258">Diğer durumlarda, hizmet olarak yazılmış bir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] WF4 iş akışı hizmetinde.</span><span class="sxs-lookup"><span data-stu-id="aac71-258">For the other case, the service is written as a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] workflow service in WF4.</span></span> [!INCLUDE[wf1](../../../includes/wf1-md.md)]<span data-ttu-id="aac71-259">-Bu test için izleme ve kalıcılığı kapalıdır gibi belirli özellikleri.</span><span class="sxs-lookup"><span data-stu-id="aac71-259">-specific features like tracking and persistence are turned off for this test.</span></span>  
  
### <a name="environment"></a><span data-ttu-id="aac71-260">Ortam</span><span class="sxs-lookup"><span data-stu-id="aac71-260">Environment</span></span>  
 <span data-ttu-id="aac71-261">![İş akışı performansı sınama ortamı](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-261">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
 <span data-ttu-id="aac71-262">İstemci istekleri varsayılan olarak, birden çok bilgisayarlardan çevrimiçi depolama hizmetine HTTP üzerinden yapılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-262">Client requests are made to the Online Store Service via HTTP from multiple computers.</span></span>  <span data-ttu-id="aac71-263">Tek bir bilgisayar, tüm üç hizmeti barındırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-263">A single computer hosts all three services.</span></span>  <span data-ttu-id="aac71-264">Çevrimiçi mağaza hizmetini ve arka uç hizmetleri arasında Aktarım katmanı, TCP veya HTTP değil.</span><span class="sxs-lookup"><span data-stu-id="aac71-264">The transport layer between the Online Store Service and the backend services is TCP or HTTP.</span></span>  <span data-ttu-id="aac71-265">Ölçümü işlem/saniye sayısına dayanır tamamlanmış `PurchaseOrder` çevrimiçi depolama hizmetine yapılan çağrıları.</span><span class="sxs-lookup"><span data-stu-id="aac71-265">The measurement of operations/second is based on the number of completed `PurchaseOrder` calls made to the Online Store Service.</span></span>  <span data-ttu-id="aac71-266">Kanal havuzu yeni WF4 içinde kullanılabilen bir özelliktir.</span><span class="sxs-lookup"><span data-stu-id="aac71-266">Channel pooling is a new feature available in WF4.</span></span>  <span data-ttu-id="aac71-267">İçinde [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] bu test kanal havuz bölümü sağlanamadığından kutu dışı çevrimiçi depolama Hizmeti'nde basit bir havuzu oluşturma teknik el kodlanmış uyarlamasını kullanıldı.</span><span class="sxs-lookup"><span data-stu-id="aac71-267">In the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] portion of this test channel pooling is not provided out of the box so a hand-coded implementation of a simple pooling technique was used in the Online Store Service.</span></span>  
  
### <a name="performance"></a><span data-ttu-id="aac71-268">Performans</span><span class="sxs-lookup"><span data-stu-id="aac71-268">Performance</span></span>  
 <span data-ttu-id="aac71-269">![Çevrimiçi mağaza hizmeti performans grafiği](../../../docs/framework/windows-workflow-foundation/media/onlinestoreperfgraph.gif "OnlineStorePerfGraph")</span><span class="sxs-lookup"><span data-stu-id="aac71-269">![Online Store Service Performance Graph](../../../docs/framework/windows-workflow-foundation/media/onlinestoreperfgraph.gif "OnlineStorePerfGraph")</span></span>  
  
 <span data-ttu-id="aac71-270">Kanal havuzu olmadan arka uç TCP hizmetlerine bağlanan [!INCLUDE[wf1](../../../includes/wf1-md.md)] hizmet üzerinde üretilen işi %17,2 etkisi vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-270">Connecting to backend TCP services without channel pooling, the [!INCLUDE[wf1](../../../includes/wf1-md.md)] service has a 17.2% impact on throughput.</span></span>  <span data-ttu-id="aac71-271">Kanal havuzu ile cezası hakkında %23,8 olur.</span><span class="sxs-lookup"><span data-stu-id="aac71-271">With channel pooling, the penalty is about 23.8%.</span></span>  <span data-ttu-id="aac71-272">HTTP için daha az etkisidir: 4.3 havuzu olmadan % ve % havuzu ile 8.1.</span><span class="sxs-lookup"><span data-stu-id="aac71-272">For HTTP, the impact is much less: 4.3% without pooling and 8.1% with pooling.</span></span>  <span data-ttu-id="aac71-273">Kanal havuzu çok az avantajı HTTP kullanırken sağladığı dikkate almak önemlidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-273">It is also important to note that the channel pooling provides very little benefit when using HTTP.</span></span>  
  
 <span data-ttu-id="aac71-274">Varken yükü bir yandan kodlanmış ile karşılaştırıldığında WF4 çalışma zamanının [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] hizmeti bu test, bunu en kötü Durum senaryosu olarak değerlendirilebilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-274">While there is overhead from the WF4 runtime compared with a hand-coded [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service in this test, it could be considered a worst-case scenario.</span></span>  <span data-ttu-id="aac71-275">Bu test iki arka uç Hizmetleri'nde çok az şey yapın.</span><span class="sxs-lookup"><span data-stu-id="aac71-275">The two backend services in this test do very little work.</span></span>  <span data-ttu-id="aac71-276">Gerçek uçtan uca senaryoda, bu Hizmetleri veritabanı çağrısı, Aktarım katmanı performans etkisini daha az önemli yapma gibi daha pahalı işlemleri gerçekleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aac71-276">In a real end-to-end scenario, these services would perform more expensive operations like database calls, making the performance impact of the transport layer less important.</span></span>  <span data-ttu-id="aac71-277">Bu artı WF4 içinde kullanılabilen özelliklerin yararları Workflow Foundation orchestration hizmetleri oluşturmak için uygun bir seçenek sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-277">This plus the benefits of the features available in WF4 makes Workflow Foundation a viable choice for creating orchestration services.</span></span>  
  
## <a name="key-performance-considerations"></a><span data-ttu-id="aac71-278">Anahtar performans etkenleri</span><span class="sxs-lookup"><span data-stu-id="aac71-278">Key Performance Considerations</span></span>  
 <span data-ttu-id="aac71-279">Özellik alanları ile birlikte çalışma hariç olmak üzere, bu bölümde, WF3 ve WF4 arasında önemli ölçüde değişti.</span><span class="sxs-lookup"><span data-stu-id="aac71-279">The feature areas in this section, with the exception of interop, have dramatically changed between WF3 and WF4.</span></span>  <span data-ttu-id="aac71-280">Bu tasarım, performans yanı sıra iş akışı uygulamaları etkiler.</span><span class="sxs-lookup"><span data-stu-id="aac71-280">This affects the design of workflow applications as well as the performance.</span></span>  
  
#### <a name="workflow-activation-latency"></a><span data-ttu-id="aac71-281">İş akışı etkinleştirme gecikmesi</span><span class="sxs-lookup"><span data-stu-id="aac71-281">Workflow Activation Latency</span></span>  
 <span data-ttu-id="aac71-282">İçinde bir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] iş akışı hizmeti uygulaması, yeni bir iş akışı başlatma veya varolan bir iş akışı yükleme için gecikme süresi önemlidir olarak engelliyor olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-282">In a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] workflow service application, the latency for starting a new workflow or loading an existing workflow is important as it can be blocking.</span></span>  <span data-ttu-id="aac71-283">Bu test çalışması WF3 XOML konak tipik bir senaryo WF4 XAMLX ana bilgisayar karşı ölçer.</span><span class="sxs-lookup"><span data-stu-id="aac71-283">This test case measures a WF3 XOML host against a WF4 XAMLX host in a typical scenario.</span></span>  
  
##### <a name="environment-setup"></a><span data-ttu-id="aac71-284">Ortam Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-284">Environment Setup</span></span>  
 <span data-ttu-id="aac71-285">![Ortam Kurulumu testleri gecikme süresi ve verimlilik için](../../../docs/framework/windows-workflow-foundation/media/latencyandthroughputenvironment.gif "LatencyAndThroughputEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-285">![Environment setup for latency and throughput tests](../../../docs/framework/windows-workflow-foundation/media/latencyandthroughputenvironment.gif "LatencyAndThroughputEnvironment")</span></span>  
  
##### <a name="test-setup"></a><span data-ttu-id="aac71-286">Test Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-286">Test Setup</span></span>  
 <span data-ttu-id="aac71-287">Senaryoda, bir istemci bilgisayarın bağlantı kurduğu bir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] Bağlam tabanlı bağıntı kullanarak iş akışı hizmeti.</span><span class="sxs-lookup"><span data-stu-id="aac71-287">In the scenario, a client computer contacts a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] workflow service using context-based correlation.</span></span>  <span data-ttu-id="aac71-288">Bağlam bağıntı özel bağlam bağlama gerektirir ve iletileri doğru iş akışı örneğine ilişkilendirmek için içerik üstbilgisi veya tanımlama bilgisi kullanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-288">Context correlation requires a special context binding and uses a context header or cookie to relate messages to the correct workflow instance.</span></span>  <span data-ttu-id="aac71-289">İleti gövdesi ayrıştırılacak gerek kalmayacak şekilde kimliği ileti üstbilgisinde bulunan bağıntı yararlı bir performans sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-289">It has a performance benefit in that the correlation Id is located in the message header so the message body does not need to be parsed.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="aac71-290">bağlam bağıntı bkz [bağlam değişimi bağıntısı](../../../docs/framework/wcf/feature-details/context-exchange-correlation.md)</span><span class="sxs-lookup"><span data-stu-id="aac71-290"> context correlation see [Context Exchange Correlation](../../../docs/framework/wcf/feature-details/context-exchange-correlation.md)</span></span>  
  
 <span data-ttu-id="aac71-291">Hizmet isteği ile yeni bir iş akışı oluşturmak ve böylece gecikme süresi ölçümü iş akışını çalıştıran harcanan süre içermez hemen bir yanıt gönderin.</span><span class="sxs-lookup"><span data-stu-id="aac71-291">The service will create a new workflow with the request and send an immediate response so that the measurement of latency does not include the time spent running the workflow.</span></span>  <span data-ttu-id="aac71-292">WF3 XOML bir arka plan kodu ile iş akışıdır ve WF4 tamamen XAML iş akışıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-292">The WF3 workflow is XOML with a code-behind and the WF4 workflow is entirely XAML.</span></span>  <span data-ttu-id="aac71-293">WF4 iş akışı şu şekildedir:</span><span class="sxs-lookup"><span data-stu-id="aac71-293">The WF4 workflow looks like this:</span></span>  
  
 <span data-ttu-id="aac71-294">![WF 4 bağıntı kapsam](../../../docs/framework/windows-workflow-foundation/media/correlationscopeworkflow.gif "CorrelationScopeWorkflow")</span><span class="sxs-lookup"><span data-stu-id="aac71-294">![WF 4 Correlation Scope](../../../docs/framework/windows-workflow-foundation/media/correlationscopeworkflow.gif "CorrelationScopeWorkflow")</span></span>  
  
 <span data-ttu-id="aac71-295"><xref:System.ServiceModel.Activities.Receive> Etkinliği iş akışı örneği oluşturur.</span><span class="sxs-lookup"><span data-stu-id="aac71-295">The <xref:System.ServiceModel.Activities.Receive> activity creates the workflow instance.</span></span>  <span data-ttu-id="aac71-296">Alınan iletide geçirilen bir değer yanıt iletisinde yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-296">A value passed in the received message is echoed in the reply message.</span></span>  <span data-ttu-id="aac71-297">İş akışının geri kalanı yanıt izleyen bir dizisini içerir.</span><span class="sxs-lookup"><span data-stu-id="aac71-297">A sequence following the reply contains the rest of the workflow.</span></span>  <span data-ttu-id="aac71-298">Yukarıdaki durumda yalnızca bir yorum etkinlik gösterilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-298">In the above case, only one comment activity is shown.</span></span>  <span data-ttu-id="aac71-299">İş akışı karmaşıklık benzetimini yapmak için açıklama etkinliklerin sayısını değiştirildi.</span><span class="sxs-lookup"><span data-stu-id="aac71-299">The number of comment activities is changed to simulate workflow complexity.</span></span>  <span data-ttu-id="aac71-300">Bir WF3 eşdeğer yorum etkinliktir <xref:System.Workflow.Activities.CodeActivity> çalışma gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="aac71-300">A comment activity is equivalent to a WF3 <xref:System.Workflow.Activities.CodeActivity> that performs no work.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="aac71-301">Açıklama etkinlik bu makalenin "bileşen düzeyinde performans karşılaştırma" bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="aac71-301"> the comment activity, see the "Component-level Performance Comparison" section earlier in this article.</span></span>  
  
##### <a name="test-results"></a><span data-ttu-id="aac71-302">Test Sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-302">Test Results</span></span>  
 <span data-ttu-id="aac71-303">![Gecikme süresi sonuçları](../../../docs/framework/windows-workflow-foundation/media/latencyresultsgraph.gif "LatencyResultsGraph")</span><span class="sxs-lookup"><span data-stu-id="aac71-303">![Latency Results](../../../docs/framework/windows-workflow-foundation/media/latencyresultsgraph.gif "LatencyResultsGraph")</span></span>  
  
 <span data-ttu-id="aac71-304">3 – Durgun şekil ve WCF iş akışı hizmetleri için gecikme süresini sıcak</span><span class="sxs-lookup"><span data-stu-id="aac71-304">Figure 3 – Cold and warm latency for WCF workflow services</span></span>  
  
 <span data-ttu-id="aac71-305">Yukarıdaki grafikte soğuk talebine başvuruyor. söz konusu olduğunda olmayan mevcut bir <xref:System.ServiceModel.WorkflowServiceHost> verilen iş akışı için.</span><span class="sxs-lookup"><span data-stu-id="aac71-305">In the graph above, cold refers to the case where there is not an existing <xref:System.ServiceModel.WorkflowServiceHost> for the given workflow.</span></span>  <span data-ttu-id="aac71-306">Diğer bir deyişle, iş akışı ilk kez kullanılıyor ve XOML ya da XAML derlenmesi gerekiyor soğuk gecikme olur.</span><span class="sxs-lookup"><span data-stu-id="aac71-306">In other words, cold latency is when the workflow is being used for the first time and the XOML or XAML needs to be compiled.</span></span>  <span data-ttu-id="aac71-307">Yarı gecikme iş akışı türü zaten derlenmiş zaman yeni bir iş akışı örneği oluşturmak için saattir.</span><span class="sxs-lookup"><span data-stu-id="aac71-307">Warm latency is the time to create a new workflow instance when the workflow type has already been compiled.</span></span>  <span data-ttu-id="aac71-308">İş akışı karmaşıklığını WF4 durumda çok az fark etmez ancak WF3 durumda doğrusal progression sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-308">The complexity of the workflow makes very little difference in the WF4 case but has a linear progression in the WF3 case.</span></span>  
  
#### <a name="correlation-throughput"></a><span data-ttu-id="aac71-309">Bağıntı işleme</span><span class="sxs-lookup"><span data-stu-id="aac71-309">Correlation Throughput</span></span>  
 <span data-ttu-id="aac71-310">WF4 yeni bir içerik tabanlı bağıntı özelliği sunmaktadır.</span><span class="sxs-lookup"><span data-stu-id="aac71-310">WF4 introduces a new content-based correlation feature.</span></span>  <span data-ttu-id="aac71-311">WF3 yalnızca Bağlam tabanlı bağıntı sağlanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-311">WF3 provided only context-based correlation.</span></span>  <span data-ttu-id="aac71-312">Bağlam tabanlı bağıntı özel yalnızca yapılabilir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] kanal bağlamaları.</span><span class="sxs-lookup"><span data-stu-id="aac71-312">Context-based correlation could only be done over specific [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] channel bindings.</span></span>  <span data-ttu-id="aac71-313">İş akışı kimliği, bu bağlamaların kullanırken ileti üstbilgisine eklenir.</span><span class="sxs-lookup"><span data-stu-id="aac71-313">The workflow Id is inserted into the message header when using these bindings.</span></span>  <span data-ttu-id="aac71-314">WF3 çalışma zamanı yalnızca bir iş akışı kimliğini tarafından tanımlayamadı  İçeriğe dayalı bağıntı ile iş akışı Yazar bir bağıntı anahtar ilgili bir hesap numarası veya müşteri kimliği gibi veri parçası dışında oluşturabilir [!INCLUDE[crabout](../../../includes/crabout-md.md)] içerik tabanlı bağıntı bakın [içeriğe dayalı bağıntı](../../../docs/framework/wcf/feature-details/content-based-correlation.md).</span><span class="sxs-lookup"><span data-stu-id="aac71-314">The WF3 runtime could only identify a workflow by its Id.  With content-based correlation, the workflow author can create a correlation key out of a relevant piece of data like an account number or customer Id. [!INCLUDE[crabout](../../../includes/crabout-md.md)] content-based correlation see [Content Based Correlation](../../../docs/framework/wcf/feature-details/content-based-correlation.md).</span></span>  
  
 <span data-ttu-id="aac71-315">Bağıntı anahtarı ileti üstbilgisinde bulunur, bağlam tabanlı bağıntı performans avantajı vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-315">Context-based correlation has a performance advantage in that the correlation key is located in the message header.</span></span>  <span data-ttu-id="aac71-316">Anahtar iletisi Kaldır-serialization/ileti kopyalama olmadan okuyabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-316">The key can be read from the message without de-serialization/message-copying.</span></span>  <span data-ttu-id="aac71-317">İçeriğe dayalı bağıntı içinde bağıntı anahtar ileti gövdesi içinde depolanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-317">In content-based correlation, the correlation key is stored in the message body.</span></span>  <span data-ttu-id="aac71-318">Bir XPath ifadesi anahtarı bulmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-318">An XPath expression is used to locate the key.</span></span>  <span data-ttu-id="aac71-319">Bu ek işleme maliyetini ileti gövdesi ve anahtar sayısı anahtarında derinliği boyutuna bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-319">The cost of this extra processing depends on the size of the message, depth of the key in the body, and the number of keys.</span></span>  <span data-ttu-id="aac71-320">Bu test içeriği ve içerik tabanlı bağıntı karşılaştırır ve aynı zamanda birden çok anahtar kullanırken performans düşüşü gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-320">This test compares context- and content-based correlation and also shows the performance degradation when using multiple keys.</span></span>  
  
#### <a name="environment-setup"></a><span data-ttu-id="aac71-321">Ortam Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-321">Environment Setup</span></span>  
 <span data-ttu-id="aac71-322">![İş akışı performansı sınama ortamı](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-322">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
#### <a name="test-setup"></a><span data-ttu-id="aac71-323">Test Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-323">Test Setup</span></span>  
 <span data-ttu-id="aac71-324">![Bağıntı işleme iş akışı Test](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputworkflow.gif "CorrelationThroughputWorkflow")</span><span class="sxs-lookup"><span data-stu-id="aac71-324">![Correlation Throughput Workflow Test](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputworkflow.gif "CorrelationThroughputWorkflow")</span></span>  
  
 <span data-ttu-id="aac71-325">Yukarıda gösterilen iş akışı "Kalıcılık" bölümünde kullanılan aynıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-325">The workflow shown above is the same one used in the "Persistence" section below.</span></span>  <span data-ttu-id="aac71-326">Kalıcılık olmadan bağıntı testler için çalışma zamanı'nda yüklü hiçbir Kalıcılık sağlayıcısı yok.</span><span class="sxs-lookup"><span data-stu-id="aac71-326">For the correlation tests without persistence there is no persistence provider installed in the runtime.</span></span>  <span data-ttu-id="aac71-327">Bağıntı iki yerde oluşur: CreateOrder ve CompleteOrder.</span><span class="sxs-lookup"><span data-stu-id="aac71-327">Correlation occurs in two places: CreateOrder and CompleteOrder.</span></span>  
  
#### <a name="test-results"></a><span data-ttu-id="aac71-328">Test Sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-328">Test Results</span></span>  
 <span data-ttu-id="aac71-329">![Bağıntı işleme](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputgraph.gif "CorrelationThroughputGraph")</span><span class="sxs-lookup"><span data-stu-id="aac71-329">![Correlation Throughput](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputgraph.gif "CorrelationThroughputGraph")</span></span>  
  
 <span data-ttu-id="aac71-330">Bu grafik içerik tabanlı bağıntı artışlar kullanılan anahtar sayısı olarak performans düşüklüğü gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-330">This graph shows a decrease in performance as the number of keys used in content-based correlation increases.</span></span>  <span data-ttu-id="aac71-331">TCP ve HTTP arasında Eğriler uygulamada benzerliği bu iletişim kuralları ile ilgili ek yükü gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-331">The similarity in the curves between TCP and HTTP indicates the overhead associated with these protocols.</span></span>  
  
#### <a name="correlation-with-persistence"></a><span data-ttu-id="aac71-332">Bağıntı Kalıcılık ile</span><span class="sxs-lookup"><span data-stu-id="aac71-332">Correlation with Persistence</span></span>  
 <span data-ttu-id="aac71-333">Kalıcı bir iş akışı ile CPU baskısı içerik tabanlı bağıntı öğesinden iş akışı çalışma zamanı SQL veritabanına kaydırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-333">With a persisted workflow, the CPU pressure from content-based correlation shifts from the workflow runtime to the SQL database.</span></span>  <span data-ttu-id="aac71-334">Saklı yordamlar SQL Kalıcılık sağlayıcısında eşleşen uygun iş akışı bulmaya anahtarlarla çalışma yapın.</span><span class="sxs-lookup"><span data-stu-id="aac71-334">The stored procedures in the SQL persistence provider do the work of matching the keys to locate the appropriate workflow.</span></span>  
  
 <span data-ttu-id="aac71-335">![Bağıntı ve kalıcılığı sonuçları](../../../docs/framework/windows-workflow-foundation/media/correlationandpersistencegraph.gif "CorrelationAndPersistenceGraph")</span><span class="sxs-lookup"><span data-stu-id="aac71-335">![Correlation and persistence results](../../../docs/framework/windows-workflow-foundation/media/correlationandpersistencegraph.gif "CorrelationAndPersistenceGraph")</span></span>  
  
 <span data-ttu-id="aac71-336">Bağlam tabanlı bağıntı hala içerik tabanlı bağıntı hızlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-336">Context-based correlation is still faster than content-based correlation.</span></span>  <span data-ttu-id="aac71-337">Ancak, fark Kalıcılık daha fazla bağıntı daha performans üzerindeki etkisi gibi daha az belirgin olur.</span><span class="sxs-lookup"><span data-stu-id="aac71-337">However, the difference is less pronounced as persistence has more impact on performance than correlation.</span></span>  
  
### <a name="complex-workflow-throughput"></a><span data-ttu-id="aac71-338">Karmaşık iş akışı işleme</span><span class="sxs-lookup"><span data-stu-id="aac71-338">Complex Workflow Throughput</span></span>  
 <span data-ttu-id="aac71-339">Bir iş akışı karmaşıklığını yalnızca etkinlikleri sayısına göre ölçülen değil.</span><span class="sxs-lookup"><span data-stu-id="aac71-339">The complexity of a workflow is not measured only by the number of activities.</span></span>  <span data-ttu-id="aac71-340">Bileşik etkinlikleri birçok alt içerebilir ve bu alt bileşik etkinlikleri de olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-340">Composite activities can contain many children and those children can also be composite activities.</span></span>  <span data-ttu-id="aac71-341">İç içe geçmiş artar düzeylerini sayısı olarak, bu nedenle şu anda yürütülen durumda olabilir etkinliklerin sayısını ve durumda olabilir değişken sayısı yapar.</span><span class="sxs-lookup"><span data-stu-id="aac71-341">As the number of levels of nesting increases, so does the number of activities that can be currently in the executing state and the number of variables that can be in state.</span></span>  <span data-ttu-id="aac71-342">Bu test, karmaşık iş akışı yürütülürken WF3 WF4 arasındaki verimliliği karşılaştırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-342">This test compares throughput between WF3 and WF4 when executing complex workflows.</span></span>  
  
### <a name="test-setup"></a><span data-ttu-id="aac71-343">Test Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-343">Test Setup</span></span>  
 <span data-ttu-id="aac71-344">Bu testler, bir Intel Xeon X5355 2,66 GHz 4 yönlü bilgisayar @ 4 GB RAM Windows Server 2008 x64 çalıştıran üzerinde yürütüldü.</span><span class="sxs-lookup"><span data-stu-id="aac71-344">These tests were executed on an Intel Xeon X5355 @ 2.66GHz 4-way computer with 4GB RAM running Windows Server 2008 x64.</span></span>  <span data-ttu-id="aac71-345">% 100 CPU kullanımına ulaşmak için çekirdek başına tek bir iş parçacığı ile tek bir işlemde test kodu çalıştırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-345">The test code runs in a single process with one thread per core to reach 100% CPU utilization.</span></span>  
  
 <span data-ttu-id="aac71-346">Bu test için oluşturulan iş akışları iki ana değişkenleriniz: derinliği ve her sıralı etkinlik sayısı.</span><span class="sxs-lookup"><span data-stu-id="aac71-346">The workflows generated for this test have two main variables: depth and number of activities in each sequence.</span></span>  <span data-ttu-id="aac71-347">Her derinlik düzeyini döngü, kararlar, atamalarını ve dizileri çalışırken bir paralel etkinlik içerir.</span><span class="sxs-lookup"><span data-stu-id="aac71-347">Each depth level includes a parallel activity, while loop, decisions, assignments, and sequences.</span></span>  <span data-ttu-id="aac71-348">Aşağıda gösterilen WF4 Tasarımcısı'nda, üst düzey akış çizelgesi gösterilen.</span><span class="sxs-lookup"><span data-stu-id="aac71-348">In the WF4 designer pictured below, the top-level flow chart is pictured.</span></span>  <span data-ttu-id="aac71-349">Her akış etkinliği ana akış benzer.</span><span class="sxs-lookup"><span data-stu-id="aac71-349">Each flowchart activity resembles the main flowchart.</span></span>  <span data-ttu-id="aac71-350">Bu iş akışı derinliği test parametreleri için sınırlı olduğu picturing düzgünleştiren parçalı düşünün yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-350">It may be helpful to think of a fractal when picturing this workflow, where the depth is limited to the parameters of the test.</span></span>  
  
 <span data-ttu-id="aac71-351">Belirli bir test etkinlik sayısını derinliği ve dizisi başına etkinlik sayısı tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="aac71-351">The number of activities in a given test is determined by the depth and number of activities per sequence.</span></span>  <span data-ttu-id="aac71-352">Aşağıdaki eşitliği WF4 test etkinlik sayısını hesaplar:</span><span class="sxs-lookup"><span data-stu-id="aac71-352">The following equation computes the number of activities in the WF4 test:</span></span>  
  
 <span data-ttu-id="aac71-353">![Etkinlik sayısını hesaplamak için eşitlik](../../../docs/framework/windows-workflow-foundation/media/numberofactivitiesequation.gif "NumberOfActivitiesEquation")</span><span class="sxs-lookup"><span data-stu-id="aac71-353">![Equation to compute number of activities](../../../docs/framework/windows-workflow-foundation/media/numberofactivitiesequation.gif "NumberOfActivitiesEquation")</span></span>  
  
 <span data-ttu-id="aac71-354">WF3 testin etkinlik sayısı, ek bir sıra nedeniyle biraz farklı bir eşitlik ile hesaplanabilir:</span><span class="sxs-lookup"><span data-stu-id="aac71-354">The WF3 test’s activity count can be computed with a slightly different equation due to an extra sequence:</span></span>  
  
 <span data-ttu-id="aac71-355">![Etkinlik sayısını hesaplamak için eşitlik](../../../docs/framework/windows-workflow-foundation/media/w3numberofactivitiesequation.gif "W3NumberOfActivitiesEquation")</span><span class="sxs-lookup"><span data-stu-id="aac71-355">![Equation to compute number of activities](../../../docs/framework/windows-workflow-foundation/media/w3numberofactivitiesequation.gif "W3NumberOfActivitiesEquation")</span></span>  
  
 <span data-ttu-id="aac71-356">D derinliği olduğu ve etkinlikler dizisi başına sayısıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-356">Where d is the depth and a is the number of activities per sequence.</span></span>  <span data-ttu-id="aac71-357">Bu denklemini arkasındaki mantığı ilk sabiti zaman çarpılarak emin olup sıraların sayısı ve ikinci sabit geçerli düzeyi etkinliklerin statik numarasıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-357">The logic behind these equations is that the first constant, multiplied by a, is the number of sequences and the second constant is the static number of activities in the current level.</span></span>  <span data-ttu-id="aac71-358">Her akış üç akış çizelgesi alt etkinlik vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-358">There are three flowchart child activities in each flowchart.</span></span>  <span data-ttu-id="aac71-359">Alt derinliği düzeyde, bu akış çizelgeleri boş ancak diğer düzeylerde ana akış kopyalarını etmektedir.</span><span class="sxs-lookup"><span data-stu-id="aac71-359">At the bottom depth level, these flowcharts are empty but at the other levels they are copies of the main flowchart.</span></span>  <span data-ttu-id="aac71-360">Her sınama değişim ait iş akışı tanımı etkinlik sayısını aşağıdaki tabloda belirtilmiştir:</span><span class="sxs-lookup"><span data-stu-id="aac71-360">The number of activities in each test variation’s workflow definition is indicated in the following table:</span></span>  
  
 <span data-ttu-id="aac71-361">![Her testte kullanılan etkinliklerin sayısını karşılaştırır](../../../docs/framework/windows-workflow-foundation/media/comparechart.gif "CompareChart")</span><span class="sxs-lookup"><span data-stu-id="aac71-361">![Compares number of activities used in each test](../../../docs/framework/windows-workflow-foundation/media/comparechart.gif "CompareChart")</span></span>  
  
 <span data-ttu-id="aac71-362">İş akışı tanımı etkinlik sayısını keskin ile her derinlik düzeyini artırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-362">The number of activities in the workflow definition increases sharply with each depth level.</span></span>  <span data-ttu-id="aac71-363">Ancak karar noktası başına yalnızca bir yol yürütüldüğünde belirli iş akışı örneğinde yalnızca küçük bir alt gerçek etkinliklerin çalıştırılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-363">But only one path per decision point is executed in a given workflow instance, so only a small subset of the actual activities are executed.</span></span>  
  
 <span data-ttu-id="aac71-364">![Karmaşık iş akışı](../../../docs/framework/windows-workflow-foundation/media/complexworkflowthroughputworkflow.gif "ComplexWorkflowThroughputWorkflow")</span><span class="sxs-lookup"><span data-stu-id="aac71-364">![Complex Workflow](../../../docs/framework/windows-workflow-foundation/media/complexworkflowthroughputworkflow.gif "ComplexWorkflowThroughputWorkflow")</span></span>  
  
 <span data-ttu-id="aac71-365">Eşdeğer bir iş akışı için WF3 oluşturuldu.</span><span class="sxs-lookup"><span data-stu-id="aac71-365">An equivalent workflow was created for WF3.</span></span> <span data-ttu-id="aac71-366">WF3 Tasarımcısı tüm iş akışı tasarım alanı iç içe geçme yerine bu nedenle bu konudaki görüntülenemeyecek kadar büyük gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-366">The WF3 designer shows the entire workflow in the design area instead of nesting, therefore it is too big to display in this topic.</span></span> <span data-ttu-id="aac71-367">İş akışının bir parçası, aşağıda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="aac71-367">A snippet of the workflow is shown below.</span></span>  
  
 <span data-ttu-id="aac71-368">![WF3 İş akışı](../../../docs/framework/windows-workflow-foundation/media/wf3workflow.gif "WF3Workflow")</span><span class="sxs-lookup"><span data-stu-id="aac71-368">![WF3 Workflow](../../../docs/framework/windows-workflow-foundation/media/wf3workflow.gif "WF3Workflow")</span></span>  
  
 <span data-ttu-id="aac71-369">İç içe bir olağanüstü durumda kullanmak için bu test parçası olan başka bir iş akışı 100 iç içe geçmiş sıralar kullanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-369">To exercise nesting in an extreme case, another workflow that is part of this test uses 100 nested sequences.</span></span>  <span data-ttu-id="aac71-370">En içteki içinde tek bir dizidir `Comment` veya <xref:System.Workflow.Activities.CodeActivity>.</span><span class="sxs-lookup"><span data-stu-id="aac71-370">In the innermost sequence is a single `Comment` or <xref:System.Workflow.Activities.CodeActivity>.</span></span>  
  
 <span data-ttu-id="aac71-371">![İç içe sıraları](../../../docs/framework/windows-workflow-foundation/media/nestedsequencewf.gif "NestedSequenceWF")</span><span class="sxs-lookup"><span data-stu-id="aac71-371">![Nested sequences](../../../docs/framework/windows-workflow-foundation/media/nestedsequencewf.gif "NestedSequenceWF")</span></span>  
  
 <span data-ttu-id="aac71-372">İzleme ve kalıcılığı bu testin bir parçası olarak kullanılmaz.</span><span class="sxs-lookup"><span data-stu-id="aac71-372">Tracking and persistence are not used as part of this test.</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="aac71-373">Test Sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-373">Test Results</span></span>  
 <span data-ttu-id="aac71-374">![Üretilen iş grafiği](../../../docs/framework/windows-workflow-foundation/media/testresults1.gif "TestResults1")</span><span class="sxs-lookup"><span data-stu-id="aac71-374">![Throughput Graph](../../../docs/framework/windows-workflow-foundation/media/testresults1.gif "TestResults1")</span></span>  
  
 <span data-ttu-id="aac71-375">Daha karmaşık iş akışları ile çok sayıda derinliği ve çok sayıda etkinlikleri ile performans sonuçları bu makalenin önceki bölümlerinde gösterilen diğer verimlilik numaralarının tutarlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-375">Even with complex workflows with lots of depth and a high number of activities, the performance results are consistent with other throughput numbers shown earlier in this article.</span></span>  <span data-ttu-id="aac71-376">WF4'ın işleme büyüklük daha hızlıdır ve Logaritmik ölçekte Karşılaştırılacak sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-376">WF4’s throughput is orders of magnitude faster and has to be compared on a logarithmic scale.</span></span>  
  
### <a name="memory"></a><span data-ttu-id="aac71-377">Bellek</span><span class="sxs-lookup"><span data-stu-id="aac71-377">Memory</span></span>  
 <span data-ttu-id="aac71-378">Windows Workflow Foundation bellek yükü iki önemli alanda ölçülür: iş akışı karmaşıklığı ve iş akışı tanımları sayısı.</span><span class="sxs-lookup"><span data-stu-id="aac71-378">The memory overhead of Windows Workflow Foundation is measured in two key areas: workflow complexity and number of workflow definitions.</span></span>  <span data-ttu-id="aac71-379">Bellek ölçümlerinin bir Windows 7 64-bit iş istasyonunda gerçekleştirilen.</span><span class="sxs-lookup"><span data-stu-id="aac71-379">Memory measurements were taken on a Windows 7 64-bit workstation.</span></span>  <span data-ttu-id="aac71-380">Çalışma kümesi boyutu performans sayaçlarını izleme, Environment.WorkingSet yoklama veya VMMap kullanılabilir gibi bir araç kullanarak gibi ölçüsü elde etmek için birçok yolu vardır [VMMap](http://technet.microsoft.com/sysinternals/dd535533.aspx).</span><span class="sxs-lookup"><span data-stu-id="aac71-380">There are many ways to obtain the measurement of working set size such as monitoring performance counters, polling Environment.WorkingSet, or using a tool like VMMap available from [VMMap](http://technet.microsoft.com/sysinternals/dd535533.aspx).</span></span> <span data-ttu-id="aac71-381">Yöntemlerinin bir birleşimini elde edilir ve her test sonuçlarını doğrulamak için kullanıldı.</span><span class="sxs-lookup"><span data-stu-id="aac71-381">A combination of methods was used to obtain and verify the results of each test.</span></span>  
  
### <a name="workflow-complexity-test"></a><span data-ttu-id="aac71-382">İş akışı karmaşıklık Test</span><span class="sxs-lookup"><span data-stu-id="aac71-382">Workflow Complexity Test</span></span>  
 <span data-ttu-id="aac71-383">İş akışı kapsamına bağlı fark çalışma kümesi iş akışı karmaşıklık test ölçer.</span><span class="sxs-lookup"><span data-stu-id="aac71-383">The workflow complexity test measures the working set difference based on the complexity of the workflow.</span></span>  <span data-ttu-id="aac71-384">Önceki bölümde kullanılan karmaşık iş akışları ek olarak, iki temel durumları karşılamak üzere yeni Çeşitlemeler eklenir: tek etkinliği iş akışı ve 1000 etkinliklerle dizisi.</span><span class="sxs-lookup"><span data-stu-id="aac71-384">In addition to the complex workflows used in the previous section, new variations are added to cover two basic cases: a single activity workflow and a sequence with 1000 activities.</span></span>  <span data-ttu-id="aac71-385">Bu testler için iş akışlarını başlatılamadı ve tek bir seri döngü tamamlanmasında bir dakikalık bir süre için çalıştırılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-385">For these tests the workflows are initialized and executed to completion in a single serial loop for a period of one minute.</span></span>  <span data-ttu-id="aac71-386">Her bir test çeşidine üç kez çalıştırın ve kaydedilen veriler bu üç çalıştırır ortalaması.</span><span class="sxs-lookup"><span data-stu-id="aac71-386">Each test variation is run three times and the data recorded is the average of those three runs.</span></span>  
  
 <span data-ttu-id="aac71-387">İki yeni temel testleri olanlar gibi aşağıda gösterilen ara iş akışları vardır:</span><span class="sxs-lookup"><span data-stu-id="aac71-387">The two new basic tests have workflows that look like those shown below:</span></span>  
  
 <span data-ttu-id="aac71-388">![Karmaşık iş akışları](../../../docs/framework/windows-workflow-foundation/media/complexworkflowboth.gif "ComplexWorkflowBoth")</span><span class="sxs-lookup"><span data-stu-id="aac71-388">![Complex Workflows](../../../docs/framework/windows-workflow-foundation/media/complexworkflowboth.gif "ComplexWorkflowBoth")</span></span>  
  
 <span data-ttu-id="aac71-389">Yukarıda gösterilen WF3 akışında boş <xref:System.Workflow.Activities.CodeActivity> etkinlikleri kullanılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-389">In the WF3 workflow shown above, empty <xref:System.Workflow.Activities.CodeActivity> activities are used.</span></span>  <span data-ttu-id="aac71-390">WF4 iş akışı kullanımlar yukarıda `Comment` etkinlikler.</span><span class="sxs-lookup"><span data-stu-id="aac71-390">The WF4 workflow above uses `Comment` activities.</span></span>  <span data-ttu-id="aac71-391">`Comment` Etkinlik bileşen düzeyinde performans karşılaştırmaları bölümünde daha önce bu makalede açıklanan.</span><span class="sxs-lookup"><span data-stu-id="aac71-391">The `Comment` activity was described in the Component-level Performance Comparisons section earlier in this article.</span></span>  
  
 <span data-ttu-id="aac71-392">![Bellek kullanım grafiği](../../../docs/framework/windows-workflow-foundation/media/complexmemoryusage.gif "ComplexMemoryUsage")</span><span class="sxs-lookup"><span data-stu-id="aac71-392">![Memory Usage Graph](../../../docs/framework/windows-workflow-foundation/media/complexmemoryusage.gif "ComplexMemoryUsage")</span></span>  
  
 <span data-ttu-id="aac71-393">Bu grafikte fark Temizle eğilimleri iç içe geçme bellek kullanımını WF3 ve WF4 göreceli olarak en az bir etkiye sahip biridir.</span><span class="sxs-lookup"><span data-stu-id="aac71-393">One of the clear trends to notice in this graph is that nesting has relatively minimal impact on memory usage in both WF3 and WF4.</span></span>  <span data-ttu-id="aac71-394">Belirli bir iş akışındaki etkinliklerin sayısını en önemli bellek etkiye gelir.</span><span class="sxs-lookup"><span data-stu-id="aac71-394">The most significant memory impact comes from the number of activities in a given workflow.</span></span>  <span data-ttu-id="aac71-395">Veri dizisi 1000, karmaşık derinliği 5 dizisi 5 ve karmaşık derinliği 7 sırası 1 Çeşitlemeler verildiğinde, etkinliklerin sayısını binlerce girerken, bellek kullanım artışı daha belirgin hale işaretlenmemiştir.</span><span class="sxs-lookup"><span data-stu-id="aac71-395">Given the data from the sequence 1000, complex depth 5 sequence 5, and complex depth 7 sequence 1 variations, it is clear that as the number of activities enters the thousands, the memory usage increase becomes more noticeable.</span></span>  <span data-ttu-id="aac71-396">(1 derinliğini 7 sırası) olağanüstü durumda ~ 29K etkinlikleri olduğu WF4 neredeyse %79 daha az bellek WF3 daha kullanıyor.</span><span class="sxs-lookup"><span data-stu-id="aac71-396">In the extreme case (depth 7 sequence 1) where there are ~29K activities, WF4 is using almost 79% less memory than WF3.</span></span>  
  
### <a name="multiple-workflow-definitions-test"></a><span data-ttu-id="aac71-397">Birden çok iş akışı tanımları testi</span><span class="sxs-lookup"><span data-stu-id="aac71-397">Multiple Workflow Definitions Test</span></span>  
 <span data-ttu-id="aac71-398">İş akışı tanımı başına bellek ölçme iki farklı testlere WF3 ve WF4 iş akışlarını barındırmak için kullanılabilir seçenekleri nedeniyle ayrılmıştır.</span><span class="sxs-lookup"><span data-stu-id="aac71-398">Measuring memory per workflow definition is divided into two different tests because of the available options for hosting workflows in WF3 and WF4.</span></span>  <span data-ttu-id="aac71-399">Belirli bir iş akışı instanced ve tanımı yalnızca bir kez yürütülen iş akışı karmaşıklık test değerinden farklı bir şekilde testleri çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="aac71-399">The tests are run in a different manner than the workflow complexity test in that a given workflow is instanced and executed only once per definition.</span></span>  <span data-ttu-id="aac71-400">İş akışı tanımı ve ana bilgisayar AppDomain ömrü boyunca bellekte kalması olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-400">This is because the workflow definition and its host remain in memory for the lifetime of the AppDomain.</span></span>  <span data-ttu-id="aac71-401">Belirtilen iş akışı örneği çalıştıran tarafından kullanılan bellek çöp toplama sırasında temizlenmelidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-401">The memory used by running a given workflow instance should be cleaned up during garbage collection.</span></span>  <span data-ttu-id="aac71-402">Geçiş Kılavuzu WF4 için barındırma seçenekleri hakkında daha ayrıntılı bilgi içerir.</span><span class="sxs-lookup"><span data-stu-id="aac71-402">The migration guidance for WF4 contains more detailed information on the hosting options.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="aac71-403">[WF Geçiş Kılavuzu: iş akışı barındırma](http://go.microsoft.com/fwlink/?LinkID=153313).</span><span class="sxs-lookup"><span data-stu-id="aac71-403"> [WF Migration Cookbook: Workflow Hosting](http://go.microsoft.com/fwlink/?LinkID=153313).</span></span>  
  
 <span data-ttu-id="aac71-404">İş akışı tanımı testi için birçok iş akışı tanımları oluşturma çeşitli şekillerde yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-404">Creating many workflow definitions for a workflow definition test can be done in several ways.</span></span>  <span data-ttu-id="aac71-405">Örneği için bir ad aynı dışında 1000 iş akışları oluşturmak için kod oluşturma kullanın ve bu iş akışlarının her ayrı dosyalara kaydedin.</span><span class="sxs-lookup"><span data-stu-id="aac71-405">For instance, one could use code generation to create a set of 1000 workflows that are identical except in name and save each of those workflows into separate files.</span></span>  <span data-ttu-id="aac71-406">Bu yaklaşım için konsol barındırılan sınama yapılmadı.</span><span class="sxs-lookup"><span data-stu-id="aac71-406">This approach was taken for the console-hosted test.</span></span>  <span data-ttu-id="aac71-407">WF3 içinde <xref:System.Workflow.Runtime.WorkflowRuntime> sınıfı, iş akışı tanımları çalıştırmak için kullanıldı.</span><span class="sxs-lookup"><span data-stu-id="aac71-407">In WF3, the <xref:System.Workflow.Runtime.WorkflowRuntime> class was used to run the workflow definitions.</span></span>  <span data-ttu-id="aac71-408">WF4 olabilir ya da kullanım <xref:System.Activities.WorkflowApplication> tek iş akışı örneği oluşturmak veya doğrudan kullanmak için <xref:System.Activities.WorkflowInvoker> bir yöntem çağrısı değilmiş gibi etkinliği çalıştırmak için.</span><span class="sxs-lookup"><span data-stu-id="aac71-408">WF4 can either use <xref:System.Activities.WorkflowApplication> to create a single workflow instance or directly use <xref:System.Activities.WorkflowInvoker> to run the activity as if it were a method call.</span></span>  <span data-ttu-id="aac71-409"><xref:System.Activities.WorkflowApplication>tek iş akışı örneğinin bir ana bilgisayardır ve daha yakın özellik eşliği sahip <xref:System.Workflow.Runtime.WorkflowRuntime> böylece bu test kullanıldı.</span><span class="sxs-lookup"><span data-stu-id="aac71-409"><xref:System.Activities.WorkflowApplication> is a host of a single workflow instance and has closer feature parity to <xref:System.Workflow.Runtime.WorkflowRuntime> so that was used in this test.</span></span>  
  
 <span data-ttu-id="aac71-410">IIS iş akışlarında barındırdığında kullanmak mümkün bir <xref:System.Web.Hosting.VirtualPathProvider> yeni <xref:System.ServiceModel.WorkflowServiceHost> tüm XAMLX veya XOML dosyaları oluşturmak yerine.</span><span class="sxs-lookup"><span data-stu-id="aac71-410">When hosting workflows in IIS it is possible to use a <xref:System.Web.Hosting.VirtualPathProvider> to create a new <xref:System.ServiceModel.WorkflowServiceHost> instead of generating all of the XAMLX or XOML files.</span></span>  <span data-ttu-id="aac71-411"><xref:System.Web.Hosting.VirtualPathProvider> Gelen isteği işler ve "bir veritabanından yüklenen ya da, bu durumda, anında oluşturulan bir sanal dosya" ile yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="aac71-411">The <xref:System.Web.Hosting.VirtualPathProvider> handles the incoming request and responds with a "virtual file" that can be loaded from a database or, in this case, generated on the fly.</span></span>  <span data-ttu-id="aac71-412">Bu nedenle, 1000 fiziksel dosyaları oluşturmak gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="aac71-412">It is therefore unnecessary to create 1000 physical files.</span></span>  
  
 <span data-ttu-id="aac71-413">Konsol testinde kullanılan iş akışı tanımları basit sıralı iş akışlarıyla tek bir etkinliğin yoktu.</span><span class="sxs-lookup"><span data-stu-id="aac71-413">The workflow definitions used in the console test were simple sequential workflows with a single activity.</span></span>  <span data-ttu-id="aac71-414">Boş bir tek Etkinlik olduğu <xref:System.Workflow.Activities.CodeActivity> WF3 çalışması için ve bir `Comment` WF4 çalışması için etkinlik.</span><span class="sxs-lookup"><span data-stu-id="aac71-414">The single activity was an empty <xref:System.Workflow.Activities.CodeActivity> for the WF3 case and a `Comment` activity for the WF4 case.</span></span>  <span data-ttu-id="aac71-415">IIS barındırılan durum iletisi ve yanıt gönderme bitiş alma üzerinde Başlat iş akışları kullanılır:</span><span class="sxs-lookup"><span data-stu-id="aac71-415">The IIS-hosted case used workflows that start on receiving a message and end on sending a reply:</span></span>  
  
 <span data-ttu-id="aac71-416">![İş akışı hizmetleri WF3 ve WF4](../../../docs/framework/windows-workflow-foundation/media/receiveworkflowboth.gif "ReceiveWorkflowBoth")</span><span class="sxs-lookup"><span data-stu-id="aac71-416">![Workflow Services in WF3 and WF4](../../../docs/framework/windows-workflow-foundation/media/receiveworkflowboth.gif "ReceiveWorkflowBoth")</span></span>  
  
 <span data-ttu-id="aac71-417">Şekil 4 – istek/yanıt düzendeki ReceiveActivity ve WF4 akışıyla WF3 iş akışı</span><span class="sxs-lookup"><span data-stu-id="aac71-417">Figure 4 – WF3 workflow with ReceiveActivity and WF4 workflow with request/response pattern</span></span>  
  
 <span data-ttu-id="aac71-418">Aşağıdaki tabloda, tek bir iş akışı tanımı 1001 tanımları arasındaki çalışma kümesindeki delta gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="aac71-418">The table below shows the delta in working set between a single workflow definition and 1001 definitions:</span></span>  
  
|<span data-ttu-id="aac71-419">Barındırma seçenekleri</span><span class="sxs-lookup"><span data-stu-id="aac71-419">Hosting Options</span></span>|<span data-ttu-id="aac71-420">WF3 Çalışma kümesi Delta</span><span class="sxs-lookup"><span data-stu-id="aac71-420">WF3 Working Set Delta</span></span>|<span data-ttu-id="aac71-421">WF4 Çalışma kümesi Delta</span><span class="sxs-lookup"><span data-stu-id="aac71-421">WF4 Working Set Delta</span></span>|  
|---------------------|---------------------------|---------------------------|  
|<span data-ttu-id="aac71-422">Konsol uygulaması iş akışları barındırılan</span><span class="sxs-lookup"><span data-stu-id="aac71-422">Console Application Hosted Workflows</span></span>|<span data-ttu-id="aac71-423">18 MB</span><span class="sxs-lookup"><span data-stu-id="aac71-423">18 MB</span></span>|<span data-ttu-id="aac71-424">9 MB</span><span class="sxs-lookup"><span data-stu-id="aac71-424">9 MB</span></span>|  
|<span data-ttu-id="aac71-425">IIS barındırılan iş akışı Hizmetleri</span><span class="sxs-lookup"><span data-stu-id="aac71-425">IIS Hosted Workflow Services</span></span>|<span data-ttu-id="aac71-426">446 MB</span><span class="sxs-lookup"><span data-stu-id="aac71-426">446 MB</span></span>|<span data-ttu-id="aac71-427">364 MB</span><span class="sxs-lookup"><span data-stu-id="aac71-427">364 MB</span></span>|  
  
 <span data-ttu-id="aac71-428">İş akışı tanımları IIS'de barındırma nedeniyle daha fazla bellek tüketir <xref:System.ServiceModel.WorkflowServiceHost>, ayrıntılı [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] hizmeti yapıları ve ileti işleme mantığı konak ile ilişkili.</span><span class="sxs-lookup"><span data-stu-id="aac71-428">Hosting workflow definitions in IIS consumes much more memory due to the <xref:System.ServiceModel.WorkflowServiceHost>, detailed [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service artifacts, and the message processing logic associated with the host.</span></span>  
  
 <span data-ttu-id="aac71-429">İş akışı içinde WF3 barındırma konsol için XOML yerine kodu da uygulanan.</span><span class="sxs-lookup"><span data-stu-id="aac71-429">For console hosting in WF3 the workflows were implemented in code instead of XOML.</span></span>  <span data-ttu-id="aac71-430">İçinde WF4 varsayılan XAML kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-430">In WF4 the default is to use XAML.</span></span>  <span data-ttu-id="aac71-431">XAML derlemesinde katıştırılmış bir kaynağı olarak depolanır ve çalışma zamanı sırasında bir uygulama bir iş akışı sağlamak için derlenmiş.</span><span class="sxs-lookup"><span data-stu-id="aac71-431">The XAML is stored as an embedded resource in the assembly and compiled during runtime to provide the implementation of the workflow.</span></span>  <span data-ttu-id="aac71-432">Bu işlemle ilişkili bazı ek yoktur.</span><span class="sxs-lookup"><span data-stu-id="aac71-432">There is some overhead associated with this process.</span></span>  <span data-ttu-id="aac71-433">WF3 ve WF4 arasında eşit bir karşılaştırma yapmak için kodlanmış iş akışı XAML yerine kullanılmıştır.</span><span class="sxs-lookup"><span data-stu-id="aac71-433">In order to make a fair comparison between WF3 and WF4, coded workflows were used instead of XAML.</span></span>  <span data-ttu-id="aac71-434">WF4 iş akışları bir örneği aşağıda verilmiştir:</span><span class="sxs-lookup"><span data-stu-id="aac71-434">An example of one of the WF4 workflows is shown below:</span></span>  
  
```  
public class Workflow1 : Activity  
{  
    protected override Func<Activity> Implementation  
    {  
        get  
        {  
            return new Func<Activity>(() =>  
            {  
                return new Sequence  
                {  
                    Activities = {  
                        new Comment()  
                    }  
                };  
            });  
        }  
        set  
        {  
            base.Implementation = value;  
        }  
    }  
}  
```  
  
 <span data-ttu-id="aac71-435">Bellek tüketimi etkileyebilecek diğer birçok faktöre vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-435">There are many other factors that can affect memory consumption.</span></span> <span data-ttu-id="aac71-436">Aynı öneriler tüm yönetilen programlar için hala geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-436">The same advice for all managed programs still applies.</span></span>  <span data-ttu-id="aac71-437">IIS barındırılan ortamlarda <xref:System.ServiceModel.WorkflowServiceHost> bir iş akışı tanımı için oluşturulan nesne, uygulama havuzu geri dönüştürülmeden kadar bellekte kalır.</span><span class="sxs-lookup"><span data-stu-id="aac71-437">In IIS-hosted environments, the <xref:System.ServiceModel.WorkflowServiceHost> object created for a workflow definition stays in memory until the application pool is recycled.</span></span>  <span data-ttu-id="aac71-438">Bunu göz önünde uzantıları yazılırken tutulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-438">This should be kept in mind when writing extensions.</span></span>  <span data-ttu-id="aac71-439">Ayrıca, "Genel" değişkenleri (tüm iş akışına kapsamlı) önlemek ve mümkün olduğunda değişkenleri kapsamını sınırlandırmak en iyisidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-439">Also, it is best to avoid "global" variables (variables scoped to the whole workflow) and limit the scope of variables wherever possible.</span></span>  
  
## <a name="workflow-runtime-services"></a><span data-ttu-id="aac71-440">İş akışı çalışma zamanı Hizmetleri</span><span class="sxs-lookup"><span data-stu-id="aac71-440">Workflow Runtime Services</span></span>  
  
### <a name="persistence"></a><span data-ttu-id="aac71-441">Kalıcılığı</span><span class="sxs-lookup"><span data-stu-id="aac71-441">Persistence</span></span>  
 <span data-ttu-id="aac71-442">Her ikisi de bir SQL Kalıcılık sağlayıcıyla sevk WF3 ve WF4.</span><span class="sxs-lookup"><span data-stu-id="aac71-442">WF3 and WF4 both ship with a SQL persistence provider.</span></span>  <span data-ttu-id="aac71-443">WF3 SQL Kalıcılık sağlayıcısı iş akışı örneği serileştirir ve bir blob'a depolayan basit bir uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-443">The WF3 SQL persistence provider is a simple implementation that serializes the workflow instance and stores it in a blob.</span></span>  <span data-ttu-id="aac71-444">Bu nedenle, bu sağlayıcı performansını büyük oranda iş akışı örneği boyutuna bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-444">For this reason, the performance of this provider depends heavily on the size of the workflow instance.</span></span>  <span data-ttu-id="aac71-445">WF3 içinde örnek boyutu Bu yazıda, daha önce bahsedildiği gibi çeşitli nedenlerle artırabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-445">In WF3, the instance size could increase for many reasons, as is discussed previously in this paper.</span></span>  <span data-ttu-id="aac71-446">Birçok müşteri seri hale getirilmiş bir örneği veritabanında saklamak hiçbir iş akışı durumunu görünürlük verdiğinden varsayılan SQL Kalıcılık sağlayıcısı kullanmamayı.</span><span class="sxs-lookup"><span data-stu-id="aac71-446">Many customers choose not to use the default SQL persistence provider because storing a serialized instance in a database gives no visibility into the state of the workflow.</span></span>  <span data-ttu-id="aac71-447">Belirli bir iş akışının iş akışı kimliği bilmeden bulmak için bir kalıcı her örneği seri durumdan ve içeriğini inceleyin etmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="aac71-447">In order to find a particular workflow without knowing the workflow id, one would have to deserialize each persisted instance and examine the contents.</span></span>  <span data-ttu-id="aac71-448">Bu sorunu çözmek için kendi Kalıcılık sağlayıcıları yazmak birçok geliştiriciler tercih.</span><span class="sxs-lookup"><span data-stu-id="aac71-448">Many developers prefer to write their own persistence providers to overcome this obstacle.</span></span>  
  
 <span data-ttu-id="aac71-449">WF4 SQL Kalıcılık sağlayıcısı bazı bu sorunları gidermek çalıştı.</span><span class="sxs-lookup"><span data-stu-id="aac71-449">The WF4 SQL persistence provider has tried to address some of these concerns.</span></span>  <span data-ttu-id="aac71-450">Kalıcılık tablolar active yer işaretleri ve yükseltilebilir özellikler gibi belirli bilgileri kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="aac71-450">The persistence tables expose certain information such as the active bookmarks and promotable properties.</span></span>  <span data-ttu-id="aac71-451">WF4 yeni içerik tabanlı bağıntı özelliği de bazı değişiklikler kalıcı iş akışı örneği kuruluşta güdümlü WF3 SQL Kalıcılık yaklaşımı kullanarak gerçekleştirebilirsiniz değil.</span><span class="sxs-lookup"><span data-stu-id="aac71-451">The new content-based correlation feature in WF4 would not perform well using the WF3 SQL persistence approach, which has driven some change in the organization of the persisted workflow instance.</span></span>  <span data-ttu-id="aac71-452">Bu iş Kalıcılık sağlayıcısının daha karmaşık hale getirir ve veritabanı üzerinde fazladan stres koyar.</span><span class="sxs-lookup"><span data-stu-id="aac71-452">This makes the job of the persistence provider more complex and puts extra stress on the database.</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="aac71-453">Ortam Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-453">Environment Setup</span></span>  
 <span data-ttu-id="aac71-454">![İş akışı performansı sınama ortamı](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-454">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
### <a name="test-setup"></a><span data-ttu-id="aac71-455">Test Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-455">Test Setup</span></span>  
 <span data-ttu-id="aac71-456">Bile bir gelişmiş özellik kümesini ve daha iyi eşzamanlılık işleme ile WF4 SQL Kalıcılık sağlayıcısında WF3 sağlayıcısında hızlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-456">Even with an improved feature set and better concurrency handling, the SQL persistence provider in WF4 is faster than the provider in WF3.</span></span>  <span data-ttu-id="aac71-457">Bunu göstermek için aşağıda WF3 ve WF4 temelde aynı işlemleri gerçekleştirmek iki iş akışları karşılaştırılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-457">To showcase this, two workflows that perform essentially the same operations in WF3 and WF4 are compared below.</span></span>  
  
 <span data-ttu-id="aac71-458">![Kalıcılık iş akışları](../../../docs/framework/windows-workflow-foundation/media/persistworkflow.gif "PersistWorkflow")</span><span class="sxs-lookup"><span data-stu-id="aac71-458">![Persistence Workflows](../../../docs/framework/windows-workflow-foundation/media/persistworkflow.gif "PersistWorkflow")</span></span>  
  
 <span data-ttu-id="aac71-459">Şekil 5 – WF3 üzerinde Kalıcılık akışında sol ve sağ taraftaki WF4</span><span class="sxs-lookup"><span data-stu-id="aac71-459">Figure 5 – Persistence workflow in WF3 on left and WF4 on right</span></span>  
  
 <span data-ttu-id="aac71-460">İki iş akışları her ikisi tarafından alınan ileti oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="aac71-460">The two workflows are both created by a received message.</span></span>  <span data-ttu-id="aac71-461">İlk yanıt gönderdikten sonra iş akışı kalıcıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-461">After sending an initial reply, the workflow is persisted.</span></span>  <span data-ttu-id="aac71-462">WF3 durumda, boş bir <xref:System.Workflow.ComponentModel.TransactionScopeActivity> Kalıcılık başlatmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-462">In the WF3 case, an empty <xref:System.Workflow.ComponentModel.TransactionScopeActivity> is used to initiate the persistence.</span></span>  <span data-ttu-id="aac71-463">Aynı WF3 içinde bir etkinlik "kapatırken kalıcı olmasını sağlar." olarak işaretlemek için elde edilebilir</span><span class="sxs-lookup"><span data-stu-id="aac71-463">The same could be achieved in WF3 by marking an activity as "persist on close."</span></span>  <span data-ttu-id="aac71-464">İkinci, ilişkili ileti akışı tamamlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-464">A second, correlated message completes the workflow.</span></span>  <span data-ttu-id="aac71-465">İş akışları kalıcı ancak değil kaldırıldı.</span><span class="sxs-lookup"><span data-stu-id="aac71-465">The workflows are persisted but not unloaded.</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="aac71-466">Test Sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-466">Test Results</span></span>  
 <span data-ttu-id="aac71-467">![Üretilen iş kalıcılığı](../../../docs/framework/windows-workflow-foundation/media/throughputpersistence.gif "ThroughputPersistence")</span><span class="sxs-lookup"><span data-stu-id="aac71-467">![Throughput Persistence](../../../docs/framework/windows-workflow-foundation/media/throughputpersistence.gif "ThroughputPersistence")</span></span>  
  
 <span data-ttu-id="aac71-468">Orta katman ile istemci arasında aktarım HTTP olduğunda, WF4 kalıcılığı bir geliştirme 2.6 zamanlarının gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-468">When the transport between client and middle tier is HTTP, persistence in WF4 shows an improvement of 2.6 times.</span></span>  <span data-ttu-id="aac71-469">TCP taşıma 3.0 saatler faktörün artırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-469">The TCP transport increases that factor to 3.0 times.</span></span>  <span data-ttu-id="aac71-470">Tüm durumlarda, CPU kullanımı orta katman %98 olduğu ya da daha yüksek.</span><span class="sxs-lookup"><span data-stu-id="aac71-470">In all cases, CPU utilization on the middle tier is 98% or higher.</span></span>  <span data-ttu-id="aac71-471">WF4 verimlilik büyük olduğunu daha hızlı iş akışı çalışma zamanı nedeniyle nedenidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-471">The reason that WF4 throughput is greater is due to the faster workflow runtime.</span></span>  <span data-ttu-id="aac71-472">Seri hale getirilmiş örnek boyutu için her iki durumda yetersiz ve bu durumda ana katkıda bulunan bir öğe değil.</span><span class="sxs-lookup"><span data-stu-id="aac71-472">The size of the serialized instance is low for both cases and is not a major contributing element in this situation.</span></span>  
  
 <span data-ttu-id="aac71-473">Bu test WF3 ve WF4 akışlarında bir etkinlik Kalıcılık oluştuğunda açıkça belirtmek için kullanın.</span><span class="sxs-lookup"><span data-stu-id="aac71-473">Both the WF3 and WF4 workflows in this test use an activity to explicitly indicate when persistence should occur.</span></span>  <span data-ttu-id="aac71-474">Bu eklentiyi olmadan iş akışını sürdürmek avantajına sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-474">This has the benefit of persisting the workflow without unloading it.</span></span>  <span data-ttu-id="aac71-475">WF3 içinde da kullanarak kalıcı hale getirmek mümkündür <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> özellik, ancak bu iş akışı örneği belleğinden kaldırır.</span><span class="sxs-lookup"><span data-stu-id="aac71-475">In WF3, it is also possible to persist using the <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> feature, but this unloads the workflow instance from memory.</span></span>  <span data-ttu-id="aac71-476">Bir iş akışı bazı noktalarda devam ederse emin olmak WF3 kullanarak bir geliştirici istiyorsa, bunlar ya da iş akışı tanımını veya kaldırılmasını ve iş akışı örneği yeniden yükleme için maliyet ödeme gerekir.</span><span class="sxs-lookup"><span data-stu-id="aac71-476">If a developer using WF3 wants to make sure a workflow persists at certain points, they either have to alter the workflow definition or pay the cost for unloading and re-loading the workflow instance.</span></span>  <span data-ttu-id="aac71-477">WF4 yeni bir özellik yüklemeyi kaldırma olmadan kalıcı hale getirmek mümkün kılar: <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>.</span><span class="sxs-lookup"><span data-stu-id="aac71-477">A new feature in WF4 makes it possible to persist without unloading: <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>.</span></span>  <span data-ttu-id="aac71-478">Bu özellik iş akışı örneği üzerinde boşta kalıcı ancak kadar bellekte kalır sağlar <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> eşiği karşılanıyorsa veya yürütme devam etti.</span><span class="sxs-lookup"><span data-stu-id="aac71-478">This feature allows the workflow instance to be persisted on idle but stay in memory until the <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> threshold is met or execution is resumed.</span></span>  
  
 <span data-ttu-id="aac71-479">WF4 SQL Kalıcılık sağlayıcı veritabanı katmanında daha fazla iş gerçekleştirmediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="aac71-479">Note that the WF4 SQL persistence provider performs more work in the database tier.</span></span>  <span data-ttu-id="aac71-480">SQL veritabanı var. CPU ve disk kullanımını izlemek önemlidir bir ayak bağı olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-480">The SQL database can become a bottleneck so it is important to monitor the CPU and disk usage there.</span></span>  <span data-ttu-id="aac71-481">Aşağıdaki eklediğinizden emin olun performans sayaçlarını SQL veritabanı performans iş akışı uygulamaları testi:</span><span class="sxs-lookup"><span data-stu-id="aac71-481">Be sure to include the following performance counters from the SQL database when performance testing workflow applications:</span></span>  
  
-   <span data-ttu-id="aac71-482">PhysicalDisk\\% Disk Zamanı okuma</span><span class="sxs-lookup"><span data-stu-id="aac71-482">PhysicalDisk\\%Disk Read Time</span></span>  
  
-   <span data-ttu-id="aac71-483">PhysicalDisk\\% Disk Zamanı</span><span class="sxs-lookup"><span data-stu-id="aac71-483">PhysicalDisk\\% Disk Time</span></span>  
  
-   <span data-ttu-id="aac71-484">PhysicalDisk\\% Disk Zamanı yazma</span><span class="sxs-lookup"><span data-stu-id="aac71-484">PhysicalDisk\\% Disk Write Time</span></span>  
  
-   <span data-ttu-id="aac71-485">PhysicalDisk\\% Ort. Disk Sırası Uzunluğu</span><span class="sxs-lookup"><span data-stu-id="aac71-485">PhysicalDisk\\% Avg. Disk Queue Length</span></span>  
  
-   <span data-ttu-id="aac71-486">PhysicalDisk\Avg. Disk okuma sırası uzunluğu</span><span class="sxs-lookup"><span data-stu-id="aac71-486">PhysicalDisk\Avg. Disk Read Queue Length</span></span>  
  
-   <span data-ttu-id="aac71-487">PhysicalDisk\Avg. Disk yazma sırası uzunluğu</span><span class="sxs-lookup"><span data-stu-id="aac71-487">PhysicalDisk\Avg. Disk Write Queue Length</span></span>  
  
-   <span data-ttu-id="aac71-488">PhysicalDisk\Current Disk Sırası Uzunluğu</span><span class="sxs-lookup"><span data-stu-id="aac71-488">PhysicalDisk\Current Disk Queue Length</span></span>  
  
-   <span data-ttu-id="aac71-489">İşlemci bilgileri\\% işlemci zamanı</span><span class="sxs-lookup"><span data-stu-id="aac71-489">Processor Information\\% Processor Time</span></span>  
  
-   <span data-ttu-id="aac71-490">SQLServer:Latches\Average Mandal bekleme süresi (ms)</span><span class="sxs-lookup"><span data-stu-id="aac71-490">SQLServer:Latches\Average Latch Wait Time (ms)</span></span>  
  
-   <span data-ttu-id="aac71-491">SQLServer:Latches\Latch bekler/sn</span><span class="sxs-lookup"><span data-stu-id="aac71-491">SQLServer:Latches\Latch Waits/sec</span></span>  
  
### <a name="tracking"></a><span data-ttu-id="aac71-492">İzleme</span><span class="sxs-lookup"><span data-stu-id="aac71-492">Tracking</span></span>  
 <span data-ttu-id="aac71-493">İş akışı izleme, bir iş akışı ilerlemesini izlemek için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-493">Workflow tracking can be used to track the progress of a workflow.</span></span>  <span data-ttu-id="aac71-494">İzleme olayları dahil bilgiler izleme profili tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="aac71-494">The information that is included in the tracking events is determined by a tracking profile.</span></span>  <span data-ttu-id="aac71-495">Daha karmaşık izleme profili, daha pahalı izleme haline gelir.</span><span class="sxs-lookup"><span data-stu-id="aac71-495">The more complex the tracking profile, the more expensive tracking becomes.</span></span>  
  
 <span data-ttu-id="aac71-496">WF3 SQL tabanlı izleme hizmeti ile birlikte gelir.</span><span class="sxs-lookup"><span data-stu-id="aac71-496">WF3 shipped with a SQL-based tracking service.</span></span>  <span data-ttu-id="aac71-497">Bu hizmet toplu ve toplu olmayan modda işe yarayabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-497">This service could work in batched and non-batched modes.</span></span>  <span data-ttu-id="aac71-498">Toplu olmayan modda, izleme olayları doğrudan veritabanına yazılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-498">In non-batched mode, tracking events are written directly to the database.</span></span>  <span data-ttu-id="aac71-499">Toplu iş modunda izleme olaylarını aynı toplu iş akışı örneği durum olarak içine toplanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-499">In batched mode, tracking events are collected into the same batch as the workflow instance state.</span></span>  <span data-ttu-id="aac71-500">Toplu iş modu en iyi performans için iş akışı tasarımları yelpazedeki vardır.</span><span class="sxs-lookup"><span data-stu-id="aac71-500">The batched mode has the best performance for the widest range of workflow designs.</span></span>  <span data-ttu-id="aac71-501">Ancak, toplu işlem performansı olumsuz kalıcı olmadan birçok etkinlik iş akışı çalıştırıyorsa ve bu etkinlikler izlenir olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-501">However, batching can have a negative performance impact if the workflow runs many activities without persisting and those activities are tracked.</span></span>  <span data-ttu-id="aac71-502">Bu genellikle Döngülerde olacağını ve bu senaryonun olmaması için en iyi Kalıcılık noktası içerecek şekilde büyük döngüler tasarlamak için yoludur.</span><span class="sxs-lookup"><span data-stu-id="aac71-502">This would commonly happen in loops and the best way to avoid this scenario is to design large loops to contain a persistence point.</span></span>  <span data-ttu-id="aac71-503">Her maliyetlerini ölçmek ve bakiyesi olan gündeme önemlidir Kalıcılık noktası bir döngüye Tanıtımı olumsuz yanı performansını etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-503">Introducing a persistence point into a loop can negatively affect performance as well so it is important to measure the costs of each and come up with a balance.</span></span>  
  
 <span data-ttu-id="aac71-504">Hizmet İzleme SQL ile WF4 gönderilmeyen.</span><span class="sxs-lookup"><span data-stu-id="aac71-504">WF4 is not shipped with a SQL tracking service.</span></span>  <span data-ttu-id="aac71-505">İzleme bilgilerini bir SQL veritabanına kayıt daha iyi bir uygulama sunucusundan işlenmiş yerine yerleşik [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="aac71-505">Recording tracking information to a SQL database can be handled better from an application server rather than built into the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="aac71-506">Bu nedenle SQL izleme şimdi AppFabric tarafından işlenir.</span><span class="sxs-lookup"><span data-stu-id="aac71-506">Therefore SQL tracking is now handled by AppFabric.</span></span>  <span data-ttu-id="aac71-507">WF4 Giden kutusu izleme sağlayıcıda olay Windows için izleme (ETW üzerinde) temel alır.</span><span class="sxs-lookup"><span data-stu-id="aac71-507">The out-of-the-box tracking provider in WF4 is based on Event Tracing for Windows (ETW).</span></span>  
  
 <span data-ttu-id="aac71-508">ETW, Windows'da yerleşik bir çekirdek düzeyi, düşük gecikme süreli olay sistemidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-508">ETW is a kernel-level, low-latency event system built into Windows.</span></span>  <span data-ttu-id="aac71-509">Gerçekte bir tüketici olduğunda cezasına olay izleme için yalnızca sebep olanaklı kılan bir sağlayıcı/tüketici modeli kullanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-509">It uses a provider/consumer model that makes it possible to only incur the penalty for event tracing when there is actually a consumer.</span></span>  <span data-ttu-id="aac71-510">İşlemci, disk, bellek ve ağ kullanımı gibi çekirdek olaylar yanı sıra birçok uygulama de ETW yararlanın.</span><span class="sxs-lookup"><span data-stu-id="aac71-510">In addition to kernel events such as processor, disk, memory, and network usage, many applications leverage ETW as well.</span></span>  <span data-ttu-id="aac71-511">Olaylar uygulamaya özelleştirilebilir ETW olayları performans sayaçları'den daha güçlü bir seçenektir.</span><span class="sxs-lookup"><span data-stu-id="aac71-511">ETW events are more powerful than performance counters in that events can be customized to the application.</span></span>  <span data-ttu-id="aac71-512">Bir olay iş akışı kimliği ya da bir bilgi iletisidir gibi metin içerebilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-512">An event can contain text such as a workflow ID or an informational message.</span></span>  <span data-ttu-id="aac71-513">Ayrıca, belirli bir alt olayların kullanan tüm olayları yakalamak daha az performans etkisi sahip olmasını olayları bit maskesi ile ayrılır.</span><span class="sxs-lookup"><span data-stu-id="aac71-513">Also, events are categorized with bitmasks so that consuming a certain subset of events will have less performance impact than capturing all events.</span></span>  
  
 <span data-ttu-id="aac71-514">ETW İzleme SQL yerine kullanmanın yaklaşımın avantajları şunlardır:</span><span class="sxs-lookup"><span data-stu-id="aac71-514">Benefits to the approach of using ETW for tracking instead of SQL include:</span></span>  
  
-   <span data-ttu-id="aac71-515">Olayları izleme koleksiyonu için başka bir işlem ayrılabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-515">Collection of tracking events can be separated to another process.</span></span>  <span data-ttu-id="aac71-516">Bu olayların nasıl kaydedileceğini daha fazla esneklik sağlar.</span><span class="sxs-lookup"><span data-stu-id="aac71-516">This gives greater flexibility in how the events are recorded.</span></span>  
  
-   <span data-ttu-id="aac71-517">ETW İzleme olayları ile kolayca birleştirilir [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] ETW olayları veya bir SQL Server veya çekirdek sağlayıcısı gibi diğer ETW sağlayıcıları.</span><span class="sxs-lookup"><span data-stu-id="aac71-517">ETW tracking events are easily combined with the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] ETW events or other ETW providers such as a SQL Server or kernel provider.</span></span>  
  
-   <span data-ttu-id="aac71-518">İş akışı yazarları WF3 SQL izleme hizmetin toplu iş modunda gibi belirli izleme yer alan bir uygulama daha iyi çalışması için bir iş akışı alter gerekmez.</span><span class="sxs-lookup"><span data-stu-id="aac71-518">Workflow authors do not need to alter a workflow to work better with a particular tracking implementation, such as the WF3 SQL tracking service’s batch mode.</span></span>  
  
-   <span data-ttu-id="aac71-519">Bir yönetici izleme üzerinde veya konak işlem geri dönüştürme olmadan kapatabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aac71-519">An administrator can turn tracking on or off without recycling the host process.</span></span>  
  
 <span data-ttu-id="aac71-520">ETW İzleme için performans avantajları bir dezavantajı ile gelir.</span><span class="sxs-lookup"><span data-stu-id="aac71-520">The performance benefits to ETW tracking come with a drawback.</span></span>  <span data-ttu-id="aac71-521">Sistem yoğun kaynak baskısı altında ise ETW olayları kaybolmuş olabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-521">ETW events can be lost if the system is under intense resource pressure.</span></span>  <span data-ttu-id="aac71-522">Olayları işleme normal program yürütme engelleyecek şekilde tasarlanmamıştır ve bu nedenle, tüm ETW olayları kendi abonelere yayınlanacaktır garanti edilmez.</span><span class="sxs-lookup"><span data-stu-id="aac71-522">The processing of events is not meant to block normal program execution and therefore it is not guaranteed that all ETW events will be broadcast to their subscribers.</span></span>  <span data-ttu-id="aac71-523">Bu sistem durumu izleme için harika ancak denetlemek için uygun değil ETW İzleme hale getirir.</span><span class="sxs-lookup"><span data-stu-id="aac71-523">This makes ETW tracking great for health monitoring but not suitable for auditing.</span></span>  
  
 <span data-ttu-id="aac71-524">WF4 SQL izleme sağlayıcısı olmasa AppFabric yapar.</span><span class="sxs-lookup"><span data-stu-id="aac71-524">While WF4 does not have a SQL tracking provider, AppFabric does.</span></span>  <span data-ttu-id="aac71-525">AppFabric'ın SQL izleme olayları toplu işlemleri ve bunları hızlı eklemeleri için tasarlanmış bir SQL tablosuna yazan bir Windows hizmeti ile ETW olayları abone olmak için bir yaklaşımdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-525">AppFabric’s SQL tracking approach is to subscribe to ETW events with a Windows Service that batches the events and writes them to a SQL table designed for quick inserts.</span></span>  <span data-ttu-id="aac71-526">Ayrı bir iş, bu tablodan veri boşaltır ve AppFabric Panosunda görüntülenebilir tabloları raporlamasına reforms.</span><span class="sxs-lookup"><span data-stu-id="aac71-526">A separate job drains the data from this table and reforms it into reporting tables that can be viewed on the AppFabric dashboard.</span></span>  <span data-ttu-id="aac71-527">Başka bir deyişle, olayları izleme toplu geldiği ve bu nedenle Kalıcılık noktası için kaydedilen önce beklenecek yok iş akışının bağımsız olarak işlenir.</span><span class="sxs-lookup"><span data-stu-id="aac71-527">This means that a batch of tracking events is handled independent of the workflow it came from and therefore does not have to wait for a persistence point before being recorded.</span></span>  
  
 <span data-ttu-id="aac71-528">ETW olayları logman veya XPerf'in gibi araçlarla kaydedilebilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-528">ETW events can be recorded with tools such as logman or xperf.</span></span>  <span data-ttu-id="aac71-529">Compact ETL dosya xperfview gibi bir araçla görüntülenemez veya daha okunabilir bir biçimde, XML gibi tracerpt ile dönüştürülür.</span><span class="sxs-lookup"><span data-stu-id="aac71-529">The compact ETL file can be viewed with a tool like xperfview or converted to a more readable format, such as XML, with tracerpt.</span></span>  <span data-ttu-id="aac71-530">WF3 içinde bir SQL veritabanı olmadan olayları izleme almak için tek seçenek özel izleme hizmeti oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-530">In WF3, the only option for getting tracking events without a SQL database is to create a custom tracking service.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="aac71-531">ETW, bkz: [WCF hizmetleri ve Windows için olay izleme](../../../docs/framework/wcf/samples/wcf-services-and-event-tracing-for-windows.md) ve [Windows için olay izleme](http://msdn.microsoft.com/library/ff190903.aspx\)).</span><span class="sxs-lookup"><span data-stu-id="aac71-531"> ETW, see [WCF Services and Event Tracing for Windows](../../../docs/framework/wcf/samples/wcf-services-and-event-tracing-for-windows.md) and [Event Tracing for Windows](http://msdn.microsoft.com/library/ff190903.aspx\)).</span></span>  
  
 <span data-ttu-id="aac71-532">Etkinleştirme iş akışı izleme değişen derece cinsinden performansını etkiler.</span><span class="sxs-lookup"><span data-stu-id="aac71-532">Enabling workflow tracking will impact performance in varying degrees.</span></span>  <span data-ttu-id="aac71-533">Kıyaslama logman aracı olayları izleme ETW tüketebilir ve bir ETL dosyasına kaydetmek için kullanır.</span><span class="sxs-lookup"><span data-stu-id="aac71-533">The benchmark below uses the logman tool to consume the ETW tracking events and record them to an ETL file.</span></span>  <span data-ttu-id="aac71-534">İçinde AppFabric İzleme SQL maliyetini bu makalenin kapsamı içinde değil.</span><span class="sxs-lookup"><span data-stu-id="aac71-534">The cost of the SQL tracking in AppFabric is not in the scope of this article.</span></span>  <span data-ttu-id="aac71-535">Ayrıca AppFabric içinde kullanılan temel izleme profili, bu Kıyaslama gösterilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-535">The basic tracking profile, also used in AppFabric, is shown in this benchmark.</span></span>  <span data-ttu-id="aac71-536">' De yer izleme olaylarını izleme durumu maliyetidir.</span><span class="sxs-lookup"><span data-stu-id="aac71-536">Also included is the cost of tracking only health monitoring events.</span></span>  <span data-ttu-id="aac71-537">Bu olaylar, sorun giderme ve sistem ortalama verimi belirlemek için kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="aac71-537">These events are useful for troubleshooting problems and determining the average throughput of the system.</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="aac71-538">Ortam Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-538">Environment Setup</span></span>  
 <span data-ttu-id="aac71-539">![İş akışı performansı sınama ortamı](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-539">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="aac71-540">Test Sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-540">Test Results</span></span>  
 <span data-ttu-id="aac71-541">![Maliyet izleme iş akışı](../../../docs/framework/windows-workflow-foundation/media/workflowtracingcost.gif "WorkflowTracingCost")</span><span class="sxs-lookup"><span data-stu-id="aac71-541">![Workflow Tracing Cost](../../../docs/framework/windows-workflow-foundation/media/workflowtracingcost.gif "WorkflowTracingCost")</span></span>  
  
 <span data-ttu-id="aac71-542">Sistem durumu izleme kabaca üzerinde üretilen işi %3 bir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="aac71-542">Health monitoring has roughly a 3% impact on throughput.</span></span>  <span data-ttu-id="aac71-543">Temel profilinin maliyet yaklaşık % 8'dir.</span><span class="sxs-lookup"><span data-stu-id="aac71-543">The basic profile’s cost is around 8%.</span></span>  
  
## <a name="interop"></a><span data-ttu-id="aac71-544">Birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="aac71-544">Interop</span></span>  
 <span data-ttu-id="aac71-545">WF4 olduğu neredeyse Tamamlandı'nin yeniden [!INCLUDE[wf1](../../../includes/wf1-md.md)] ve bu nedenle WF3 iş akışları ve etkinlikler WF4 ile doğrudan uyumlu değil.</span><span class="sxs-lookup"><span data-stu-id="aac71-545">WF4 is almost a complete rewrite of [!INCLUDE[wf1](../../../includes/wf1-md.md)] and therefore WF3 workflows and activities are not directly compatible with WF4.</span></span>  <span data-ttu-id="aac71-546">Benimsenen birçok müşteri [!INCLUDE[wf2](../../../includes/wf2-md.md)] erken şirket içi veya üçüncü taraf iş akışı tanımları ve özel etkinlikler için WF3 sahip olacaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-546">Many customers that adopted [!INCLUDE[wf2](../../../includes/wf2-md.md)] early will have in-house or third-party workflow definitions and custom activities for WF3.</span></span>  <span data-ttu-id="aac71-547">WF4 geçişi kolaylaştırmak için bir yol WF4 iş akışı içinde WF3 etkinliklerden yürütebilir birlikte çalışma etkinlik kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="aac71-547">One way to ease the transition to WF4 is to use the Interop activity, which can execute WF3 activities from within a WF4 workflow.</span></span>  <span data-ttu-id="aac71-548">Önerilir <xref:System.Activities.Statements.Interop> etkinliği yalnızca kullanılabilir gerektiğinde.</span><span class="sxs-lookup"><span data-stu-id="aac71-548">It is recommended that the <xref:System.Activities.Statements.Interop> activity only be used when necessary.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="aac71-549">WF4 kullanıma geçiş [WF4 Geçiş Kılavuzu](http://go.microsoft.com/fwlink/?LinkID=153313).</span><span class="sxs-lookup"><span data-stu-id="aac71-549"> migrating to WF4 check out the [WF4 Migration Guidance](http://go.microsoft.com/fwlink/?LinkID=153313).</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="aac71-550">Ortam Kurulumu</span><span class="sxs-lookup"><span data-stu-id="aac71-550">Environment Setup</span></span>  
 <span data-ttu-id="aac71-551">![İş akışı performansı sınama ortamı](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="aac71-551">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="aac71-552">Test Sonuçları</span><span class="sxs-lookup"><span data-stu-id="aac71-552">Test Results</span></span>  
 <span data-ttu-id="aac71-553">Aşağıdaki tabloda, çeşitli yapılandırmaları bir sırasında beş etkinlikler içeren bir iş akışını çalıştırma sonuçları gösterir.</span><span class="sxs-lookup"><span data-stu-id="aac71-553">The table below shows the results of running a workflow containing five activities in a sequence in various configurations.</span></span>  
  
|<span data-ttu-id="aac71-554">Test</span><span class="sxs-lookup"><span data-stu-id="aac71-554">Test</span></span>|<span data-ttu-id="aac71-555">Üretilen işi (iş akışları/sn)</span><span class="sxs-lookup"><span data-stu-id="aac71-555">Throughput (workflows/sec)</span></span>|  
|----------|-----------------------------------|  
|<span data-ttu-id="aac71-556">WF3 çalışma zamanında WF3 sırası</span><span class="sxs-lookup"><span data-stu-id="aac71-556">WF3 Sequence in WF3 runtime</span></span>|<span data-ttu-id="aac71-557">1,576</span><span class="sxs-lookup"><span data-stu-id="aac71-557">1,576</span></span>|  
|<span data-ttu-id="aac71-558">Birlikte çalışması kullanarak WF4 çalışma zamanında WF3 sırası</span><span class="sxs-lookup"><span data-stu-id="aac71-558">WF3 Sequence in WF4 runtime using Interop</span></span>|<span data-ttu-id="aac71-559">2,745</span><span class="sxs-lookup"><span data-stu-id="aac71-559">2,745</span></span>|  
|<span data-ttu-id="aac71-560">WF4 sırası</span><span class="sxs-lookup"><span data-stu-id="aac71-560">WF4 Sequence</span></span>|<span data-ttu-id="aac71-561">153,582</span><span class="sxs-lookup"><span data-stu-id="aac71-561">153,582</span></span>|  
  
 <span data-ttu-id="aac71-562">Düz WF3 birlikte çalışması kullanarak için önemli performans artışı yoktur.</span><span class="sxs-lookup"><span data-stu-id="aac71-562">There is a notable performance increase to using Interop over straight WF3.</span></span>  <span data-ttu-id="aac71-563">Ancak, WF4 etkinlikleri karşılaştırıldığında artırma önemsizdir.</span><span class="sxs-lookup"><span data-stu-id="aac71-563">However, when compared against WF4 activities, the increase is negligible.</span></span>  
  
## <a name="summary"></a><span data-ttu-id="aac71-564">Özet</span><span class="sxs-lookup"><span data-stu-id="aac71-564">Summary</span></span>  
 <span data-ttu-id="aac71-565">Performans WF4 için yoğun yatırım birçok önemli alanda Ücretli.</span><span class="sxs-lookup"><span data-stu-id="aac71-565">Heavy investments in performance for WF4 have paid off in many crucial areas.</span></span>  <span data-ttu-id="aac71-566">Ayrı ayrı iş akışı bileşen performansı olduğu bazı durumlarda yüzlerce kez WF3 için leaner nedeniyle karşılaştırıldığında WF4 içinde daha hızlı [!INCLUDE[wf1](../../../includes/wf1-md.md)] çalışma zamanı.</span><span class="sxs-lookup"><span data-stu-id="aac71-566">Individual workflow component performance is in some cases hundreds of times faster in WF4 compared to WF3 due to a leaner [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime.</span></span>  <span data-ttu-id="aac71-567">Gecikme rakamları de önemli ölçüde daha uygundur.</span><span class="sxs-lookup"><span data-stu-id="aac71-567">Latency numbers are significantly better as well.</span></span>  <span data-ttu-id="aac71-568">Bu yaşanan performans sorunları kullanmak için anlamına gelir [!INCLUDE[wf1](../../../includes/wf1-md.md)] elle kodlama aksine [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] orchestration Hizmetleri eklenen kullanmanın yararları dikkate çok küçük [!INCLUDE[wf1](../../../includes/wf1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="aac71-568">This means the performance penalty for using [!INCLUDE[wf1](../../../includes/wf1-md.md)] as opposed to hand-coding [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] orchestration services is very small considering the added benefits of using [!INCLUDE[wf1](../../../includes/wf1-md.md)].</span></span>  <span data-ttu-id="aac71-569">2.5-3.0 faktörüyle Kalıcılık performans artar.</span><span class="sxs-lookup"><span data-stu-id="aac71-569">Persistence performance has increased by a factor of 2.5 - 3.0.</span></span>  <span data-ttu-id="aac71-570">İş akışı şimdi izleme yoluyla sistem durumu izleme, çok az yüke sahiptir.</span><span class="sxs-lookup"><span data-stu-id="aac71-570">Health monitoring by means of workflow tracking now has very little overhead.</span></span>  <span data-ttu-id="aac71-571">Geçiş kılavuzlarını kapsamlı bir kümesini WF3 WF4 için taşıma dikkate olanlar için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="aac71-571">A comprehensive set of migration guides are available for those that are considering moving from WF3 to WF4.</span></span>  <span data-ttu-id="aac71-572">Tüm bunlar, karmaşık uygulamalar yazma çekici bir seçenek WF4 olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="aac71-572">All of this should make WF4 an attractive option for writing complex applications.</span></span>  
  
## <a name="acknowledgements"></a><span data-ttu-id="aac71-573">Katkıda Bulunanlar</span><span class="sxs-lookup"><span data-stu-id="aac71-573">Acknowledgements</span></span>  
 <span data-ttu-id="aac71-574">Çoğu aşağıdaki Katkıda Bulunanlar ve gözden geçirenler sarf için teşekkür ederiz:</span><span class="sxs-lookup"><span data-stu-id="aac71-574">Many thanks to the following contributors and reviewers for their efforts:</span></span>  
  
-   <span data-ttu-id="aac71-575">Leon Welicki, Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="aac71-575">Leon Welicki, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="aac71-576">Ryszard Kwiecinski, Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="aac71-576">Ryszard Kwiecinski, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="aac71-577">Emil Velinov, Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="aac71-577">Emil Velinov, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="aac71-578">Can Etikan Talbert, Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="aac71-578">Nate Talbert, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="aac71-579">Bob Etikan, Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="aac71-579">Bob Schmidt, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="aac71-580">Stefan Batres, Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="aac71-580">Stefan Batres, Microsoft Corporation</span></span>
