---
title: "Örtük bir işlem kapsamı kullanarak işlem uygulama"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 49d1706a-1e0c-4c85-9704-75c908372eb9
caps.latest.revision: "4"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 7733543fa1120d4cd8409fe131ddaffa7a76be41
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/02/2017
---
# <a name="implementing-an-implicit-transaction-using-transaction-scope"></a><span data-ttu-id="3f0be-102">Örtük bir işlem kapsamı kullanarak işlem uygulama</span><span class="sxs-lookup"><span data-stu-id="3f0be-102">Implementing an Implicit Transaction using Transaction Scope</span></span>
<span data-ttu-id="3f0be-103"><xref:System.Transactions.TransactionScope> Sınıfı bir işlem ile etkileşim kurmak gerek kalmadan bir işlem içinde katılan olarak kod bloğu işaretlemek için basit bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="3f0be-103">The <xref:System.Transactions.TransactionScope> class provides a simple way to mark a block of code as participating in a transaction, without requiring you to interact with the transaction itself.</span></span> <span data-ttu-id="3f0be-104">Bir işlem kapsamı seçin ve ortam işlem otomatik olarak yönetir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-104">A transaction scope can select and manage the ambient transaction automatically.</span></span> <span data-ttu-id="3f0be-105">Kullanım kolaylığı ve verimlilik nedeniyle, kullanmanız önerilir <xref:System.Transactions.TransactionScope> hareket uygulaması geliştirilirken sınıfı.</span><span class="sxs-lookup"><span data-stu-id="3f0be-105">Due to its ease of use and efficiency, it is recommended that you use the <xref:System.Transactions.TransactionScope> class when developing a transaction application.</span></span>  
  
 <span data-ttu-id="3f0be-106">Ayrıca, işlem açıkça kaynaklarla listeleme gerekmez.</span><span class="sxs-lookup"><span data-stu-id="3f0be-106">In addition, you do not need to enlist resources explicitly with the transaction.</span></span> <span data-ttu-id="3f0be-107">Tüm <xref:System.Transactions> Kaynak Yöneticisi (örneğin, SQL Server 2005) kapsamı tarafından oluşturulan bir ortam hareket varlığını algılayabilir ve otomatik olarak kaydolunamadı.</span><span class="sxs-lookup"><span data-stu-id="3f0be-107">Any <xref:System.Transactions> resource manager (such as SQL Server 2005) can detect the existence of an ambient transaction created by the scope and automatically enlist.</span></span>  
  
## <a name="creating-a-transaction-scope"></a><span data-ttu-id="3f0be-108">Bir işlem kapsamı oluşturma</span><span class="sxs-lookup"><span data-stu-id="3f0be-108">Creating a transaction scope</span></span>  
 <span data-ttu-id="3f0be-109">Aşağıdaki örnek, bir basit kullanımını gösterir <xref:System.Transactions.TransactionScope> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="3f0be-109">The following sample shows a simple usage of the <xref:System.Transactions.TransactionScope> class.</span></span>  
  
 [!code-csharp[TransactionScope#1](../../../../samples/snippets/csharp/VS_Snippets_Remoting/TransactionScope/cs/ScopeWithSQL.cs#1)]
 [!code-vb[TransactionScope#1](../../../../samples/snippets/visualbasic/VS_Snippets_Remoting/TransactionScope/vb/ScopeWithSQL.vb#1)]  
  
 <span data-ttu-id="3f0be-110">Yeni bir oluşturduktan sonra işlem kapsamı başlatıldığında <xref:System.Transactions.TransactionScope> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-110">The transaction scope is started once you create a new <xref:System.Transactions.TransactionScope> object.</span></span>  <span data-ttu-id="3f0be-111">Kod örneğinde gösterildiği şekilde kapsamlarla oluşturmanız önerilir bir **kullanarak** deyimi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-111">As illustrated in the code sample, it is recommended that you create scopes with a **using** statement.</span></span> <span data-ttu-id="3f0be-112">**Kullanarak** deyimi kullanılabilir C# ve Visual Basic ve gibi çalışır bir **try... finally** blok kapsamı düzgün bir şekilde elden emin olun.</span><span class="sxs-lookup"><span data-stu-id="3f0be-112">The **using** statement is available both in C# and in Visual Basic, and works like a **try...finally** block to ensure that the scope is disposed of properly.</span></span>  
  
 <span data-ttu-id="3f0be-113">Ne zaman örneği <xref:System.Transactions.TransactionScope>, işlem yöneticisi katılmayı hangi işlemin belirler.</span><span class="sxs-lookup"><span data-stu-id="3f0be-113">When you instantiate <xref:System.Transactions.TransactionScope>, the transaction manager determines which transaction to participate in.</span></span> <span data-ttu-id="3f0be-114">Belirlenen sonra kapsamı bu işlem içinde her zaman katılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-114">Once determined, the scope always participates in that transaction.</span></span> <span data-ttu-id="3f0be-115">Karar iki etmenlere dayanır: ortam bir işlemin bulunup bulunmadığını ve değerini **TransactionScopeOption** Oluşturucusu parametresi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-115">The decision is based on two factors: whether an ambient transaction is present and the value of the **TransactionScopeOption** parameter in the constructor.</span></span> <span data-ttu-id="3f0be-116">Ortam işlem içinde kodunuzu yürüten bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-116">The ambient transaction is the transaction within which your code executes.</span></span> <span data-ttu-id="3f0be-117">Statik çağırarak ortam işlem başvuru elde edebileceğiniz <xref:System.Transactions.Transaction.Current%2A?displayProperty=nameWithType> özelliği <xref:System.Transactions.Transaction> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="3f0be-117">You can obtain a reference to the ambient transaction by calling the static <xref:System.Transactions.Transaction.Current%2A?displayProperty=nameWithType> property of the <xref:System.Transactions.Transaction> class.</span></span> <span data-ttu-id="3f0be-118">Bu parametre nasıl kullanıldığı hakkında daha fazla bilgi için bkz: [TransactionScopeOption kullanarak işlem akışını yönetme](#ManageTxFlow) bölümüne.</span><span class="sxs-lookup"><span data-stu-id="3f0be-118">For more information on how this parameter is used, see the [Managing transaction flow using TransactionScopeOption](#ManageTxFlow) section of this topic.</span></span>  
  
## <a name="completing-a-transaction-scope"></a><span data-ttu-id="3f0be-119">Bir işlem kapsamı Tamamlanıyor</span><span class="sxs-lookup"><span data-stu-id="3f0be-119">Completing a transaction scope</span></span>  
 <span data-ttu-id="3f0be-120">Uygulamanız tüm iş tamamlandığında işlemde gerçekleştirmek istediği, çağırmalısınız <xref:System.Transactions.TransactionScope.Complete%2A?displayProperty=nameWIthType> işlem yöneticisi hareketi kabul edilebilir olduğunu bildirmek için yalnızca bir kez yöntemi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-120">When your application completes all the work it wants to perform in a transaction, you should call the <xref:System.Transactions.TransactionScope.Complete%2A?displayProperty=nameWIthType> method only once to inform the transaction manager that it is acceptable to commit the transaction.</span></span> <span data-ttu-id="3f0be-121">Çağrı put çok iyi bir uygulamadır <xref:System.Transactions.TransactionScope.Complete%2A> son ifade olarak **kullanarak** bloğu.</span><span class="sxs-lookup"><span data-stu-id="3f0be-121">It is very good practice to put the call to <xref:System.Transactions.TransactionScope.Complete%2A> as the last statement in the **using** block.</span></span>  
  
 <span data-ttu-id="3f0be-122">İşlem Yöneticisi bunu bir sistem hatası veya işlem kapsamı içinde oluşturulan bir özel eşdeğer olarak yorumlar için bu yöntemi çağırmak başarısız olan işlem durdurur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-122">Failing to call this method aborts the transaction, because the transaction manager interprets this as a system failure, or equivalent to an exception thrown within the scope of the transaction.</span></span> <span data-ttu-id="3f0be-123">Ancak, bu yöntemi çağırmadan, işlem garanti etmez wil kaydedilmiş.</span><span class="sxs-lookup"><span data-stu-id="3f0be-123">However, calling this method does not guarantee that the transaction wil be committed.</span></span> <span data-ttu-id="3f0be-124">Bu işlem yöneticisi, durumunu bildiren, yalnızca bir yoludur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-124">It is merely a way of informing the transaction manager of your status.</span></span> <span data-ttu-id="3f0be-125">Çağırdıktan sonra <xref:System.Transactions.TransactionScope.Complete%2A> yöntemini kullanarak ortam işlem artık erişemez <xref:System.Transactions.Transaction.Current%2A> özelliği ve denenirse oluşturulan bir özel durum oluşur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-125">After calling the <xref:System.Transactions.TransactionScope.Complete%2A> method, you can no longer access the ambient transaction by using the <xref:System.Transactions.Transaction.Current%2A> property, and attempting to do so will result in an exception being thrown.</span></span>  
  
 <span data-ttu-id="3f0be-126">Varsa <xref:System.Transactions.TransactionScope> işlem başlangıçta, oluşturulan kodda son satırından sonra işlem işlem yöneticisi tarafından yürütülen gerçek iş oluşur nesne **kullanarak** bloğu.</span><span class="sxs-lookup"><span data-stu-id="3f0be-126">If the <xref:System.Transactions.TransactionScope> object created the transaction initially, the actual work of committing the transaction by the transaction manager occurs after the last line of code in the **using** block.</span></span> <span data-ttu-id="3f0be-127">İşlem oluşturmadıysanız, yürütme zaman oluşur <xref:System.Transactions.CommittableTransaction.Commit%2A> sahibi tarafından adlı <xref:System.Transactions.CommittableTransaction> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-127">If it did not create the transaction, the commit occurs whenever <xref:System.Transactions.CommittableTransaction.Commit%2A> is called by the owner of the <xref:System.Transactions.CommittableTransaction> object.</span></span> <span data-ttu-id="3f0be-128">Bu noktada işlem yöneticisi kaynak yöneticileri çağırır ve yürütme veya geri alma olup olmadığına göre göre bunları size bildirir <xref:System.Transactions.TransactionScope.Complete%2A> yöntemi çağrıldı <xref:System.Transactions.TransactionScope> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-128">At that point the transaction manager calls the resource managers and informs them to either commit or rollback, based on whether the <xref:System.Transactions.TransactionScope.Complete%2A> method was called on the <xref:System.Transactions.TransactionScope> object.</span></span>  
  
 <span data-ttu-id="3f0be-129">**Kullanarak** deyimi sağlar <xref:System.Transactions.TransactionScope.Dispose%2A> yöntemi <xref:System.Transactions.TransactionScope> nesnesi, bir özel durum oluştuğunda dahi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-129">The **using** statement ensures that the <xref:System.Transactions.TransactionScope.Dispose%2A> method of the <xref:System.Transactions.TransactionScope> object is called even if an exception occurs.</span></span> <span data-ttu-id="3f0be-130"><xref:System.Transactions.TransactionScope.Dispose%2A> Yöntemi işlem kapsamı sonunu işaretler.</span><span class="sxs-lookup"><span data-stu-id="3f0be-130">The <xref:System.Transactions.TransactionScope.Dispose%2A> method marks the end of the transaction scope.</span></span> <span data-ttu-id="3f0be-131">Bu yöntemin çağrılması işlem etkilemeyebilir sonra oluşan özel durumlar.</span><span class="sxs-lookup"><span data-stu-id="3f0be-131">Exceptions that occur after calling this method may not affect the transaction.</span></span> <span data-ttu-id="3f0be-132">Bu yöntem aynı zamanda ortam işlem için önceki durumuna geri yükler.</span><span class="sxs-lookup"><span data-stu-id="3f0be-132">This method also restores the ambient transaction to it previous state.</span></span>  
  
 <span data-ttu-id="3f0be-133">A <xref:System.Transactions.TransactionAbortedException> işlem kapsam oluşturur ve işlem durduruldu durumunda oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-133">A <xref:System.Transactions.TransactionAbortedException> is thrown if the scope creates the transaction, and the transaction is aborted.</span></span> <span data-ttu-id="3f0be-134">A <xref:System.Transactions.TransactionInDoubtException> işlem yöneticisi bir yürütme karar erişemezse atılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-134">A <xref:System.Transactions.TransactionInDoubtException> is thrown if the transaction manager cannot reach a Commit decision.</span></span> <span data-ttu-id="3f0be-135">İşlem tamamlanırsa hiçbir özel durum oluşur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-135">No exception is thrown if the transaction is committed.</span></span>  
  
## <a name="rolling-back-a-transaction"></a><span data-ttu-id="3f0be-136">Bir işlemi geri alınıyor</span><span class="sxs-lookup"><span data-stu-id="3f0be-136">Rolling back a transaction</span></span>  
 <span data-ttu-id="3f0be-137">Bir işlemi geri almak istiyorsanız, değil çağırmalısınız <xref:System.Transactions.TransactionScope.Complete%2A> işlem kapsamı içinde yöntemi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-137">If you want to rollback a transaction, you should not call the <xref:System.Transactions.TransactionScope.Complete%2A> method within the transaction scope.</span></span> <span data-ttu-id="3f0be-138">Örneğin, kapsam içinde bir özel durum.</span><span class="sxs-lookup"><span data-stu-id="3f0be-138">For example, you can throw an exception within the scope.</span></span> <span data-ttu-id="3f0be-139">İçinde yer aldığı işlem geri alınacak.</span><span class="sxs-lookup"><span data-stu-id="3f0be-139">The transaction in which it participates in will be rolled back.</span></span>  
  
##  <a name="ManageTxFlow"></a><span data-ttu-id="3f0be-140">İşlem akışını TransactionScopeOption kullanarak yönetme</span><span class="sxs-lookup"><span data-stu-id="3f0be-140">Managing transaction flow using TransactionScopeOption</span></span>  
 <span data-ttu-id="3f0be-141">İşlem kapsamı kullanan bir yöntem çağırarak iç içe geçirilemez bir <xref:System.Transactions.TransactionScope> kendi kapsamı kullanan bir yöntem içinde olarak arasındadır talebiyle `RootMethod` aşağıdaki örnekte, yöntemi</span><span class="sxs-lookup"><span data-stu-id="3f0be-141">Transaction scope can be nested by calling a method that uses a <xref:System.Transactions.TransactionScope> from within a method that uses its own scope, as is the case with the `RootMethod` method in the following example,</span></span>  
  
```csharp  
void RootMethod()  
{  
     using(TransactionScope scope = new TransactionScope())  
     {  
          /* Perform transactional work here */  
          SomeMethod();  
          scope.Complete();  
     }  
}  
  
void SomeMethod()  
{  
     using(TransactionScope scope = new TransactionScope())  
     {  
          /* Perform transactional work here */  
          scope.Complete();  
     }  
}  
```  
  
 <span data-ttu-id="3f0be-142">En üstteki işlem kapsamı kök kapsamı olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-142">The top-most transaction scope is referred to as the root scope.</span></span>  
  
 <span data-ttu-id="3f0be-143"><xref:System.Transactions.TransactionScope> SAX bir numaralandırma türü kabul eden birden fazla aşırı yüklenmiş oluşturucular <xref:System.Transactions.TransactionScopeOption>, kapsam işlem davranışını tanımlar.</span><span class="sxs-lookup"><span data-stu-id="3f0be-143">The <xref:System.Transactions.TransactionScope> class provides several overloaded constructors that accept an enumeration of the type <xref:System.Transactions.TransactionScopeOption>, which defines the transactional behavior of the scope.</span></span>  
  
 <span data-ttu-id="3f0be-144">Bir <xref:System.Transactions.TransactionScope> nesnenin üç seçenek vardır:</span><span class="sxs-lookup"><span data-stu-id="3f0be-144">A <xref:System.Transactions.TransactionScope> object has three options:</span></span>  
  
-   <span data-ttu-id="3f0be-145">Ortam işlem katılma veya bir mevcut değilse yeni bir tane oluşturun.</span><span class="sxs-lookup"><span data-stu-id="3f0be-145">Join the ambient transaction, or create a new one if one does not exist.</span></span>  
  
-   <span data-ttu-id="3f0be-146">Yeni bir kökü kapsamı, diğer bir deyişle, yeni bir işlem başlatmak ve bu işlem yeni ortam işlem kendi kapsamı içinde olması olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-146">Be a new root scope, that is, start a new transaction and have that transaction be the new ambient transaction inside its own scope.</span></span>  
  
-   <span data-ttu-id="3f0be-147">Bir işlem içinde hiç katılmak değil.</span><span class="sxs-lookup"><span data-stu-id="3f0be-147">Not take part in a transaction at all.</span></span> <span data-ttu-id="3f0be-148">Sonuç olarak ortam işlem yok.</span><span class="sxs-lookup"><span data-stu-id="3f0be-148">There is no ambient transaction as a result.</span></span>  
  
 <span data-ttu-id="3f0be-149">Kapsam ile örneği varsa <xref:System.Transactions.TransactionScopeOption.Required>ve bir ortam işlem mevcut ise, bu işlem kapsamı birleştirir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-149">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.Required>, and an ambient transaction is present, the scope joins that transaction.</span></span> <span data-ttu-id="3f0be-150">Diğer taraftan, varsa, hiç ortam işlem, ardından kapsamı yeni bir işlem oluşturur ve kök kapsam haline gelir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-150">If, on the other hand, there is no ambient transaction, then the scope creates a new transaction, and become the root scope.</span></span> <span data-ttu-id="3f0be-151">Varsayılan değer budur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-151">This is the default value.</span></span> <span data-ttu-id="3f0be-152">Zaman <xref:System.Transactions.TransactionScopeOption.Required> olan kullanıldığında, kapsam içinde kod kök olup farklı davranır gerekmez veya yalnızca ortam işlem birleştirme.</span><span class="sxs-lookup"><span data-stu-id="3f0be-152">When <xref:System.Transactions.TransactionScopeOption.Required> is used, the code inside the scope does not need to behave differently whether it is the root or just joining the ambient transaction.</span></span> <span data-ttu-id="3f0be-153">Her iki durumda da aynı şekilde çalışması.</span><span class="sxs-lookup"><span data-stu-id="3f0be-153">It should operate identically in both cases.</span></span>  
  
 <span data-ttu-id="3f0be-154">Kapsamı ile örneği varsa <xref:System.Transactions.TransactionScopeOption.RequiresNew>, her zaman bir kök kapsam olur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-154">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.RequiresNew>, it is always the root scope.</span></span> <span data-ttu-id="3f0be-155">Yeni bir işlem başlatır ve yeni ortam işlem kapsamı içinde kendi işlem olur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-155">It starts a new transaction, and its transaction becomes the new ambient transaction inside the scope.</span></span>  
  
 <span data-ttu-id="3f0be-156">Kapsam ile örneği varsa <xref:System.Transactions.TransactionScopeOption.Suppress>, hiçbir zaman bir işlem içinde bölümü alır, ne olursa olsun, ortam bir işlem olup olmadığını mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-156">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.Suppress>, it never takes part in a transaction, regardless of whether an ambient transaction is present.</span></span> <span data-ttu-id="3f0be-157">Bu değer her zaman örneği bir kapsama sahip **null** ortam işlem olarak.</span><span class="sxs-lookup"><span data-stu-id="3f0be-157">A scope instantiated with this value always have **null** as its ambient transaction.</span></span>  
  
 <span data-ttu-id="3f0be-158">Yukarıdaki seçenekleri aşağıdaki tabloda özetlenmiştir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-158">The above options are summarized in the following table.</span></span>  
  
|<span data-ttu-id="3f0be-159">TransactionScopeOption</span><span class="sxs-lookup"><span data-stu-id="3f0be-159">TransactionScopeOption</span></span>|<span data-ttu-id="3f0be-160">Ortam işlem</span><span class="sxs-lookup"><span data-stu-id="3f0be-160">Ambient Transaction</span></span>|<span data-ttu-id="3f0be-161">Kapsam bölümü alır</span><span class="sxs-lookup"><span data-stu-id="3f0be-161">The scope takes part in</span></span>|  
|----------------------------|-------------------------|-----------------------------|  
|<span data-ttu-id="3f0be-162">Gerekli</span><span class="sxs-lookup"><span data-stu-id="3f0be-162">Required</span></span>|<span data-ttu-id="3f0be-163">Hayır</span><span class="sxs-lookup"><span data-stu-id="3f0be-163">No</span></span>|<span data-ttu-id="3f0be-164">Yeni bir işlem (kök olacaktır)</span><span class="sxs-lookup"><span data-stu-id="3f0be-164">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="3f0be-165">Yeni gerektirir</span><span class="sxs-lookup"><span data-stu-id="3f0be-165">Requires New</span></span>|<span data-ttu-id="3f0be-166">Hayır</span><span class="sxs-lookup"><span data-stu-id="3f0be-166">No</span></span>|<span data-ttu-id="3f0be-167">Yeni bir işlem (kök olacaktır)</span><span class="sxs-lookup"><span data-stu-id="3f0be-167">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="3f0be-168">Önle</span><span class="sxs-lookup"><span data-stu-id="3f0be-168">Suppress</span></span>|<span data-ttu-id="3f0be-169">Hayır</span><span class="sxs-lookup"><span data-stu-id="3f0be-169">No</span></span>|<span data-ttu-id="3f0be-170">İşlem yok</span><span class="sxs-lookup"><span data-stu-id="3f0be-170">No Transaction</span></span>|  
|<span data-ttu-id="3f0be-171">Gerekli</span><span class="sxs-lookup"><span data-stu-id="3f0be-171">Required</span></span>|<span data-ttu-id="3f0be-172">Evet</span><span class="sxs-lookup"><span data-stu-id="3f0be-172">Yes</span></span>|<span data-ttu-id="3f0be-173">Ortam işlem</span><span class="sxs-lookup"><span data-stu-id="3f0be-173">Ambient  Transaction</span></span>|  
|<span data-ttu-id="3f0be-174">Yeni gerektirir</span><span class="sxs-lookup"><span data-stu-id="3f0be-174">Requires New</span></span>|<span data-ttu-id="3f0be-175">Evet</span><span class="sxs-lookup"><span data-stu-id="3f0be-175">Yes</span></span>|<span data-ttu-id="3f0be-176">Yeni bir işlem (kök olacaktır)</span><span class="sxs-lookup"><span data-stu-id="3f0be-176">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="3f0be-177">Önle</span><span class="sxs-lookup"><span data-stu-id="3f0be-177">Suppress</span></span>|<span data-ttu-id="3f0be-178">Evet</span><span class="sxs-lookup"><span data-stu-id="3f0be-178">Yes</span></span>|<span data-ttu-id="3f0be-179">İşlem yok</span><span class="sxs-lookup"><span data-stu-id="3f0be-179">No Transaction</span></span>|  
  
 <span data-ttu-id="3f0be-180">Zaman bir <xref:System.Transactions.TransactionScope> nesne var olan bir ortam işlem birleştirir kapsam nesnesinin atma bitemez işlem işlem kapsam iptalleri sürece.</span><span class="sxs-lookup"><span data-stu-id="3f0be-180">When a <xref:System.Transactions.TransactionScope> object joins an existing ambient transaction, disposing of the scope object may not end the transaction, unless the scope aborts the transaction.</span></span> <span data-ttu-id="3f0be-181">Ortam işlem kök kapsamı tarafından oluşturulmuşsa, yalnızca, kök kapsam silindiğinde mu <xref:System.Transactions.CommittableTransaction.Commit%2A> işleme çağrılmadığı.</span><span class="sxs-lookup"><span data-stu-id="3f0be-181">If the ambient transaction was created by a root scope, only when the root scope is disposed of, does <xref:System.Transactions.CommittableTransaction.Commit%2A> get called on the transaction.</span></span> <span data-ttu-id="3f0be-182">İşlem el ile oluşturulmuşsa, olduğunda ya da iptal edildi veya oluşturucusu tarafından yürütülen işlemin sona erer.</span><span class="sxs-lookup"><span data-stu-id="3f0be-182">If the transaction was created manually, the transaction ends when it is either aborted, or committed by its creator.</span></span>  
  
 <span data-ttu-id="3f0be-183">Aşağıdaki örnekte gösterildiği bir <xref:System.Transactions.TransactionScope> üç iç içe kapsamlı nesneler, farklı bir her örneklenen oluşturan nesne <xref:System.Transactions.TransactionScopeOption> değeri.</span><span class="sxs-lookup"><span data-stu-id="3f0be-183">The following example shows a <xref:System.Transactions.TransactionScope> object that creates three nested scope objects, each instantiated with a different <xref:System.Transactions.TransactionScopeOption> value.</span></span>  
  
```csharp  
using(TransactionScope scope1 = new TransactionScope())   
//Default is Required   
{   
     using(TransactionScope scope2 = new   
      TransactionScope(TransactionScopeOption.Required))   
     {  
     ...  
     }   
  
     using(TransactionScope scope3 = new TransactionScope(TransactionScopeOption.RequiresNew))   
     {  
     ...  
     }   
  
     using(TransactionScope scope4 = new   
        TransactionScope(TransactionScopeOption.Suppress))   
    {  
     ...  
    }   
}  
```  
  
 <span data-ttu-id="3f0be-184">Örnek, yeni bir kapsam oluşturma ortam işlem olmadan kod bloğu gösterir (`scope1`) ile <xref:System.Transactions.TransactionScopeOption.Required>.</span><span class="sxs-lookup"><span data-stu-id="3f0be-184">The example shows a code block without any ambient transaction creating a new scope (`scope1`) with <xref:System.Transactions.TransactionScopeOption.Required>.</span></span> <span data-ttu-id="3f0be-185">Kapsam `scope1` yeni bir işlem (işlem A) oluşturur ve bir işlem yapar gibi bir kök kapsamı olan ortam işlem.</span><span class="sxs-lookup"><span data-stu-id="3f0be-185">The scope `scope1` is a root scope as it creates a new transaction (Transaction A) and makes Transaction A the ambient transaction.</span></span> <span data-ttu-id="3f0be-186">`Scope1`Daha sonra her farklı bir ile üç daha fazla nesne oluşturur <xref:System.Transactions.TransactionScopeOption> değeri.</span><span class="sxs-lookup"><span data-stu-id="3f0be-186">`Scope1` then creates three more objects, each with a different <xref:System.Transactions.TransactionScopeOption> value.</span></span> <span data-ttu-id="3f0be-187">Örneğin, `scope2` ile oluşturulan <xref:System.Transactions.TransactionScopeOption.Required>, hem de ortam bir işlem olduğundan, ilk işlem tarafından oluşturulan birleştirmeleri `scope1`.</span><span class="sxs-lookup"><span data-stu-id="3f0be-187">For example, `scope2` is created with <xref:System.Transactions.TransactionScopeOption.Required>, and since there is an ambient transaction, it joins the first transaction created by `scope1`.</span></span> <span data-ttu-id="3f0be-188">Unutmayın `scope3` yeni bir işlem ve kök kapsamı `scope4` hiç ortam işlem vardır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-188">Note that `scope3` is the root scope of a new transaction, and that `scope4` has no ambient transaction.</span></span>  
  
 <span data-ttu-id="3f0be-189">Değerini varsayılan ve en sık kullanılan olsa da <xref:System.Transactions.TransactionScopeOption> olan <xref:System.Transactions.TransactionScopeOption.Required>, her diğer değerlerinin benzersiz amacı vardır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-189">Although the default and most commonly used value of <xref:System.Transactions.TransactionScopeOption> is <xref:System.Transactions.TransactionScopeOption.Required>, each of the other values has its unique purpose.</span></span>  
  
 <span data-ttu-id="3f0be-190"><xref:System.Transactions.TransactionScopeOption.Suppress>kod bölümü tarafından gerçekleştirilen işlemler, korumak istediğiniz ve işlemler başarısız oluyorsa ortam hareketi iptal etmek istiyor musunuz durumlarda faydalıdır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-190"><xref:System.Transactions.TransactionScopeOption.Suppress> is useful when you want to preserve the operations performed by the code section, and do not want to abort the ambient transaction if the operations fail.</span></span> <span data-ttu-id="3f0be-191">Örneğin, günlük gerçekleştirin veya operations denetlemek istediğinizde ya da bakılmaksızın abonelere olayları yayımlamak istediğiniz ortam işleminiz tamamlandıktan olup durdurur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-191">For example, when you want to perform logging or audit operations, or when you want to publish events to subscribers regardless of whether your ambient transaction commits or aborts.</span></span> <span data-ttu-id="3f0be-192">Bu değer, işlemsel olmayan kod bölümünde bir işlem kapsamı içinde sağlamak aşağıdaki örnekte gösterildiği gibi sağlar.</span><span class="sxs-lookup"><span data-stu-id="3f0be-192">This value allows you to have a non-transactional code section inside a transaction scope, as shown in the following example.</span></span>  
  
```csharp  
using(TransactionScope scope1 = new TransactionScope())  
{  
     try  
     {  
          //Start of non-transactional section   
          using(TransactionScope scope2 = new  
             TransactionScope(TransactionScopeOption.Suppress))  
          {  
               //Do non-transactional work here  
          }  
          //Restores ambient transaction here  
   }  
     catch  
     {}  
   //Rest of scope1  
}  
```  
  
### <a name="voting-inside-a-nested-scope"></a><span data-ttu-id="3f0be-193">İç içe bir kapsam içinde oylama</span><span class="sxs-lookup"><span data-stu-id="3f0be-193">Voting inside a nested scope</span></span>  
 <span data-ttu-id="3f0be-194">İç içe geçmiş bir kapsam kök kapsamının ortam işlem katılabilirsiniz rağmen çağırma <xref:System.Transactions.TransactionScope.Complete%2A> iç içe geçmiş kapsamdaki kök kapsamda herhangi bir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-194">Although a nested scope can join the ambient transaction of the root scope, calling <xref:System.Transactions.TransactionScope.Complete%2A> in the nested scope has no affect on the root scope.</span></span> <span data-ttu-id="3f0be-195">İşlemi, yalnızca son iç içe geçmiş kapsam aşağıya doğru kök kapsamdan tüm kapsamlar oy verin, işlem uygulanır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-195">Only if all the scopes from the root scope down to the last nested scope vote to commit the transaction, will the transaction be committed.</span></span> <span data-ttu-id="3f0be-196">Değil çağırma <xref:System.Transactions.TransactionScope.Complete%2A> ortam işlem hemen iptal edilecek gibi iç içe geçmiş kapsamdaki kök kapsam etkiler.</span><span class="sxs-lookup"><span data-stu-id="3f0be-196">Not calling <xref:System.Transactions.TransactionScope.Complete%2A> in a nested scope will affect the root scope as the ambient transaction will immediately be aborted.</span></span>  
  
## <a name="setting-the-transactionscope-timeout"></a><span data-ttu-id="3f0be-197">TransactionScope zaman aşımını ayarlama</span><span class="sxs-lookup"><span data-stu-id="3f0be-197">Setting the TransactionScope timeout</span></span>  
 <span data-ttu-id="3f0be-198">Aşırı yüklenmiş oluşturucular bazıları <xref:System.Transactions.TransactionScope> türünde bir değer kabul <xref:System.TimeSpan>, işlem zaman aşımı denetlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-198">Some of the overloaded constructors of <xref:System.Transactions.TransactionScope> accept a value of type <xref:System.TimeSpan>, which is used to control the timeout of the transaction.</span></span> <span data-ttu-id="3f0be-199">Sıfır olarak ayarlanmış bir zaman aşımı sonsuz bir zaman aşımı anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-199">A timeout set to zero means an infinite timeout.</span></span> <span data-ttu-id="3f0be-200">Sonsuz bir zaman aşımı kodunuz adımla iş mantığınızı sorunun yalıtmak istediğinizi ve sorunu bulmaya sırasında zaman aşımı için hata ayıklama işlem istiyor musunuz çoğunlukla, hata ayıklama için faydalıdır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-200">Infinite timeout is useful mostly for debugging, when you want to isolate a problem in your business logic by stepping through your code, and you do not want the transaction you debug to time out while you attempt to locate the problem.</span></span> <span data-ttu-id="3f0be-201">İşlem kilitlenmeleri karşı koruma kıldığından diğer durumlarda, sonsuz bir zaman aşımı değerini kullanarak çok dikkatli olun.</span><span class="sxs-lookup"><span data-stu-id="3f0be-201">Be extremely careful using the infinite timeout value in all other cases, because it overrides the safeguards against transaction deadlocks.</span></span>  
  
 <span data-ttu-id="3f0be-202">Genellikle ayarlanabilir <xref:System.Transactions.TransactionScope> zaman aşımına uğramak üzere iki durumda da varsayılan dışındaki değerler.</span><span class="sxs-lookup"><span data-stu-id="3f0be-202">You typically set the <xref:System.Transactions.TransactionScope> timeout to values other than default in two cases.</span></span> <span data-ttu-id="3f0be-203">Uygulama tanıtıcıları işlemleri durduruldu şekilde test etmek istediğiniz zaman ilk geliştirme sırasında ' dir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-203">The first is during development, when you want to test the way your application handles aborted transactions.</span></span> <span data-ttu-id="3f0be-204">Zaman aşımı (örneğin, bir mili saniye) küçük bir değere ayarlayarak, işleminiz başarısız olmasına neden ve böylece hata işleme kodunu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3f0be-204">By setting the timeout to a small value (such as one millisecond), you cause your transaction to fail and can thus observe your error handling code.</span></span> <span data-ttu-id="3f0be-205">Kapsam içinde kaynak talebi, söz konusu kilitlenmeleri kaynaklanan düşünüyorsanız, varsayılan zaman aşımı değerinden bir değere ayarlamanız ikinci durumdur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-205">The second case in which you set the value to be less than the default timeout is when you believe that the scope is involved in resource contention, resulting in deadlocks.</span></span> <span data-ttu-id="3f0be-206">Bu durumda, işlemin hemen durdurmak ve varsayılan zaman aşımı süresi dolacak şekilde bekleme istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="3f0be-206">In that case, you want to abort the transaction as soon as possible and not wait for the default timeout to expire.</span></span>  
  
 <span data-ttu-id="3f0be-207">Bir kapsam bir ortam işlem birleştirir halde ortam işlem ayarlanmış olandan daha küçük bir zaman aşımını belirtir, yeni, daha kısa bir zaman aşımı uygulanır <xref:System.Transactions.TransactionScope> nesne ve kapsam belirtilen iç içe geçmiş sürede bitmelidir ya da işlem otomatik olarak iptal edildi.</span><span class="sxs-lookup"><span data-stu-id="3f0be-207">When a scope joins an ambient transaction but specifies a smaller timeout than the one the ambient transaction is set to, the new, shorter timeout is enforced on the <xref:System.Transactions.TransactionScope> object, and the scope must end within the nested time specified, or the transaction is automatically aborted.</span></span> <span data-ttu-id="3f0be-208">İç içe geçmiş kapsamın zaman aşımı, ortam işlem büyük hiçbir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-208">If the nested scope's timeout is more than that of the ambient transaction, it has no effect.</span></span>  
  
## <a name="setting-the-transactionscope-isolation-level"></a><span data-ttu-id="3f0be-209">TransactionScope yalıtım düzeyini ayarlama</span><span class="sxs-lookup"><span data-stu-id="3f0be-209">Setting the TransactionScope isolation level</span></span>  
 <span data-ttu-id="3f0be-210">Aşırı yüklenmiş oluşturucular bazıları <xref:System.Transactions.TransactionScope> türü yapısını kabul <xref:System.Transactions.TransactionOptions> bir zaman aşımı değeri ek bir yalıtım düzeyini belirtir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-210">Some of the overloaded constructors of <xref:System.Transactions.TransactionScope> accept a structure of type <xref:System.Transactions.TransactionOptions> to specify an isolation level, in addition to a timeout value.</span></span> <span data-ttu-id="3f0be-211">Varsayılan olarak, yalıtım düzeyi ayarlamak işlem yürütür <xref:System.Transactions.IsolationLevel.Serializable>.</span><span class="sxs-lookup"><span data-stu-id="3f0be-211">By default, the transaction executes with isolation level set to <xref:System.Transactions.IsolationLevel.Serializable>.</span></span> <span data-ttu-id="3f0be-212">Başka bir yalıtım düzeyi seçme <xref:System.Transactions.IsolationLevel.Serializable> yaygın olarak okuma yoğun sistemleri için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-212">Selecting an isolation level other than <xref:System.Transactions.IsolationLevel.Serializable> is commonly used for read-intensive systems.</span></span> <span data-ttu-id="3f0be-213">Bu işlem teorik ve işlem semantiği, söz konusu eşzamanlılık sorunları ve sistemi tutarlılığı sonuçları işleme düz bir anlayış gerektirir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-213">This requires a solid understanding of transaction processing theory and the semantics of the transaction itself, the concurrency issues involved, and the consequences for system consistency.</span></span>  
  
 <span data-ttu-id="3f0be-214">Ayrıca, tüm kaynak yöneticileri tüm yalıtım düzeyini destekler ve yapılandırılmış olandan daha yüksek düzeyde işlemde katılmak getirmeyi tercih edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3f0be-214">In addition, not all resource managers support all levels of isolation, and they may elect to take part in the transaction at a higher level than the one configured.</span></span>  
  
 <span data-ttu-id="3f0be-215">Her yalıtım düzeyi yanı sıra <xref:System.Transactions.IsolationLevel.Serializable> aynı bilgilerine erişme diğer işlemlerin kaynaklanan tutarsızlık maruz kalabilir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-215">Every isolation level besides <xref:System.Transactions.IsolationLevel.Serializable> is susceptible to inconsistency resulting from other transactions accessing the same information.</span></span> <span data-ttu-id="3f0be-216">Farklı yalıtım düzeyleri arasındaki farkı biçiminde okunur ve yazma kilitler kullanılır.</span><span class="sxs-lookup"><span data-stu-id="3f0be-216">The difference between the different isolation levels is in the way read and write locks are used.</span></span> <span data-ttu-id="3f0be-217">Bir kilidi, yalnızca işlem Kaynak Yöneticisi'nde verilere erişen veya hareket kaydedilmiş veya iptal kadar tutulması tutulabilir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-217">A lock can be held only when the transaction accesses the data in the resource manager, or it can be held until the transaction is committed or aborted.</span></span> <span data-ttu-id="3f0be-218">Eski verimlilik, tutarlılık ikincisi için iyidir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-218">The former is better for throughput, the latter for consistency.</span></span> <span data-ttu-id="3f0be-219">Kilit iki tür ve işlemleri (okuma/yazma) iki tür dört temel yalıtım düzeyi verin.</span><span class="sxs-lookup"><span data-stu-id="3f0be-219">The two kinds of locks and the two kinds of operations (read/write) give four basic isolation levels.</span></span> <span data-ttu-id="3f0be-220">Daha fazla bilgi edinmek için bkz. <xref:System.Transactions.IsolationLevel>.</span><span class="sxs-lookup"><span data-stu-id="3f0be-220">See <xref:System.Transactions.IsolationLevel> for more information.</span></span>  
  
 <span data-ttu-id="3f0be-221">Ne zaman kullanarak iç içe geçmiş <xref:System.Transactions.TransactionScope> nesneleri, tüm iç içe geçmiş kapsamlar ortam işlem katılmaya istiyorsanız tam olarak aynı yalıtım düzeyi kullanacak şekilde yapılandırılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="3f0be-221">When using nested <xref:System.Transactions.TransactionScope> objects, all nested scopes must be configured to use exactly the same isolation level if they want to join the ambient transaction.</span></span> <span data-ttu-id="3f0be-222">İç içe bir varsa <xref:System.Transactions.TransactionScope> nesne çalışır farklı yalıtım düzeyi belirtir henüz ortam işlem katılmak bir <xref:System.ArgumentException> oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="3f0be-222">If a nested <xref:System.Transactions.TransactionScope> object tries to join the ambient transaction yet it specifies a different isolation level, an <xref:System.ArgumentException> is thrown.</span></span>  
  
## <a name="interop-with-com"></a><span data-ttu-id="3f0be-223">COM + ile birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="3f0be-223">Interop with COM+</span></span>  
 <span data-ttu-id="3f0be-224">Yeni bir oluşturduğunuzda <xref:System.Transactions.TransactionScope> örneğini kullanabilir <xref:System.Transactions.EnterpriseServicesInteropOption> COM + ile etkileşim kurmak nasıl belirlemek için oluşturucular birinde numaralandırması.</span><span class="sxs-lookup"><span data-stu-id="3f0be-224">When you create a new <xref:System.Transactions.TransactionScope> instance, you can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration in one of the constructors to specify how to interact with COM+.</span></span> <span data-ttu-id="3f0be-225">Bunun hakkında daha fazla bilgi için bkz: [Kurumsal Hizmetler ve COM + işlemleri ile birlikte çalışabilirlik](../../../../docs/framework/data/transactions/interoperability-with-enterprise-services-and-com-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="3f0be-225">For more information on this, see [Interoperability with Enterprise Services and COM+ Transactions](../../../../docs/framework/data/transactions/interoperability-with-enterprise-services-and-com-transactions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f0be-226">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="3f0be-226">See Also</span></span>  
 <xref:System.Transactions.Transaction.Clone%2A>  
 <xref:System.Transactions.TransactionScope>
