---
title: "İzlenecek yol: Win32'de WPF Barındırma"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: cpp
helpviewer_keywords: hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
caps.latest.revision: "24"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: fce70ab1571602fb046d3ccde9e7c014834ae6a0
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/21/2017
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="447f8-102">İzlenecek yol: Win32'de WPF Barındırma</span><span class="sxs-lookup"><span data-stu-id="447f8-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="447f8-103">uygulamaları oluşturmak için zengin bir ortam sağlar.</span><span class="sxs-lookup"><span data-stu-id="447f8-103"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="447f8-104">Önemli ölçüde yatırımınız varsa [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] kodu, onu olabilir eklemek için daha etkili [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] özgün kodunuzu yeniden yazma işlemi yerine, uygulamanızın işlevselliği.</span><span class="sxs-lookup"><span data-stu-id="447f8-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="447f8-105">barındırma için basit bir mekanizma sağlar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] penceresi.</span><span class="sxs-lookup"><span data-stu-id="447f8-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="447f8-106">Bu öğreticinin örnek uygulamasının nasıl yazılacağını açıklar [Win32 penceresi örneği içerisinde WPF içeriği barındırma](http://go.microsoft.com/fwlink/?LinkID=160004), o ana [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] penceresi.</span><span class="sxs-lookup"><span data-stu-id="447f8-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="447f8-107">Herhangi bir ana bilgisayar için bu örnek genişletebilirsiniz [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] penceresi.</span><span class="sxs-lookup"><span data-stu-id="447f8-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="447f8-108">Yönetilen ve yönetilmeyen kod karıştırma içerdiğinden, uygulama yazılmış [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="447f8-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="447f8-109">Gereksinimler</span><span class="sxs-lookup"><span data-stu-id="447f8-109">Requirements</span></span>  
 <span data-ttu-id="447f8-110">Bu öğretici temel olarak bilindiğini her ikisi de varsayar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ve [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programlama.</span><span class="sxs-lookup"><span data-stu-id="447f8-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="447f8-111">Temel bir giriş için [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programlama, bkz: [Başlarken](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="447f8-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="447f8-112">Giriş için [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programlama herhangi konu üzerine çok sayıdaki kitaplardan özellikle başvurmalısınız *Windows programlama* Charles Petzold'un.</span><span class="sxs-lookup"><span data-stu-id="447f8-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="447f8-113">Bu öğretici eşlik örnek uygulanan çünkü [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], Bu öğretici kullanımını bilindiğini varsayar [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] programa [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] yönetilen kod programlama anlaşılması artı.</span><span class="sxs-lookup"><span data-stu-id="447f8-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="447f8-114">Aşina [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] yararlı ancak temel değildir.</span><span class="sxs-lookup"><span data-stu-id="447f8-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="447f8-115">Bu öğretici ilişkili örnekten kod örnekleri içerir.</span><span class="sxs-lookup"><span data-stu-id="447f8-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="447f8-116">Ancak, okunabilmesi için tam örnek kodu içermez.</span><span class="sxs-lookup"><span data-stu-id="447f8-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="447f8-117">Tam örnek kod için bkz: [barındırma WPF içeriği Win32 penceresi örneği](http://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="447f8-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="447f8-118">Temel yordamı</span><span class="sxs-lookup"><span data-stu-id="447f8-118">The Basic Procedure</span></span>  
 <span data-ttu-id="447f8-119">Bu bölüm için kullandığınız temel yordamı açıklar konak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] penceresi.</span><span class="sxs-lookup"><span data-stu-id="447f8-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="447f8-120">Kalan bölümler her adımı ayrıntılarını açıklar.</span><span class="sxs-lookup"><span data-stu-id="447f8-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="447f8-121">Barındırma için anahtarı [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] penceresi <xref:System.Windows.Interop.HwndSource> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="447f8-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="447f8-122">Bu sınıf sarmalar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] birleştirilir izin veren penceresinde, [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] alt pencere olarak.</span><span class="sxs-lookup"><span data-stu-id="447f8-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="447f8-123">Aşağıdaki yaklaşımlardan birleştirir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] ve [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tek bir uygulamada.</span><span class="sxs-lookup"><span data-stu-id="447f8-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="447f8-124">Uygulama, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] yönetilen sınıf olarak içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="447f8-125">Uygulama bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulama [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="447f8-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="447f8-126">Varolan bir uygulama ile başlangıç ve yönetilmeyen ise [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] kodu, genellikle etkinleştirebilirsiniz, yönetilen kod eklemek için proje ayarlarınızı değiştirerek çağırmak `/clr` derleyici bayrağı.</span><span class="sxs-lookup"><span data-stu-id="447f8-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="447f8-127">İş parçacığı modelini tek iş parçacıklı için (STA) ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="447f8-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="447f8-128">İşleme [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)bildirim pencere yordamı ve aşağıdakileri yapın:</span><span class="sxs-lookup"><span data-stu-id="447f8-128">Handle the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="447f8-129">Yeni bir <xref:System.Windows.Interop.HwndSource> üst pencere olarak nesnesiyle kendi `parent` parametresi.</span><span class="sxs-lookup"><span data-stu-id="447f8-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="447f8-130">Bir örneğini oluşturun, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik sınıfı.</span><span class="sxs-lookup"><span data-stu-id="447f8-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="447f8-131">Bir başvuru atamak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik nesnesine <xref:System.Windows.Interop.HwndSource.RootVisual%2A> özelliği <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="447f8-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="447f8-132">HWND içeriğini alın.</span><span class="sxs-lookup"><span data-stu-id="447f8-132">Get the HWND for the content.</span></span> <span data-ttu-id="447f8-133"><xref:System.Windows.Interop.HwndSource.Handle%2A> Özelliği <xref:System.Windows.Interop.HwndSource> nesne pencere işleyicisi (HWND) içerir.</span><span class="sxs-lookup"><span data-stu-id="447f8-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="447f8-134">Uygulamanızın yönetilmeyen parçası kullanabileceğiniz bir HWND almak için cast `Handle.ToPointer()` HWND için.</span><span class="sxs-lookup"><span data-stu-id="447f8-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="447f8-135">Bir başvuru tutmak için statik bir alan içeren bir yönetilen sınıf uygulama, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-136">Bu sınıf için bir başvuru almanıza yardımcı [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu.</span><span class="sxs-lookup"><span data-stu-id="447f8-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="447f8-137">Ata [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] statik alanın içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="447f8-138">' Den bildirim almak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir veya daha fazla işleyici ekleyerek içerik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] olaylar.</span><span class="sxs-lookup"><span data-stu-id="447f8-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="447f8-139">İletişim [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] özelliklerini ayarlamak ve benzeri için statik alanda depolanan başvuru kullanarak içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="447f8-140">Aynı zamanda [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] uygulamak için [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-141">Ancak, bu derleme gerekecek ayrı ayrı olarak bir [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] ve başvuran [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] gelen, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulama.</span><span class="sxs-lookup"><span data-stu-id="447f8-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="447f8-142">Yordamın geri kalanı, yukarıda özetlenen benzer.</span><span class="sxs-lookup"><span data-stu-id="447f8-142">The remainder of the procedure is similar to that outlined above.</span></span>  
  
<a name="implementing_the_application"></a>   
## <a name="implementing-the-host-application"></a><span data-ttu-id="447f8-143">Konak uygulamanın uygulama</span><span class="sxs-lookup"><span data-stu-id="447f8-143">Implementing the Host Application</span></span>  
 <span data-ttu-id="447f8-144">Bu bölümde açıklanmıştır ana bilgisayara nasıl [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] temel bir içerik [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulama.</span><span class="sxs-lookup"><span data-stu-id="447f8-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="447f8-145">İçerik uygulanan [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] yönetilen sınıf olarak.</span><span class="sxs-lookup"><span data-stu-id="447f8-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="447f8-146">Çoğunlukla, basittir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programlama.</span><span class="sxs-lookup"><span data-stu-id="447f8-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="447f8-147">İçerik uygulama önemli yönlerini ele alınmıştır [WPF içeriği uygulama](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="447f8-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>  
  
<a name="autoNestedSectionsOUTLINE1"></a>   
-   [<span data-ttu-id="447f8-148">Temel uygulama</span><span class="sxs-lookup"><span data-stu-id="447f8-148">The Basic Application</span></span>](#the_basic_application)  
  
-   [<span data-ttu-id="447f8-149">WPF içeriği barındırma</span><span class="sxs-lookup"><span data-stu-id="447f8-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)  
  
-   [<span data-ttu-id="447f8-150">WPF içeriği için bir başvuru bulunduran</span><span class="sxs-lookup"><span data-stu-id="447f8-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)  
  
-   [<span data-ttu-id="447f8-151">WPF içeriği ile iletişim</span><span class="sxs-lookup"><span data-stu-id="447f8-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)  
  
<a name="the_basic_application"></a>   
### <a name="the-basic-application"></a><span data-ttu-id="447f8-152">Temel uygulama</span><span class="sxs-lookup"><span data-stu-id="447f8-152">The Basic Application</span></span>  
 <span data-ttu-id="447f8-153">Ana bilgisayar uygulaması için başlangıç noktası oluşturmak için olan bir [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] şablonu.</span><span class="sxs-lookup"><span data-stu-id="447f8-153">The starting point for the host application was to create a [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] template.</span></span>  
  
1.  <span data-ttu-id="447f8-154">Açık [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)]seçip **yeni proje** gelen **dosya** menüsü.</span><span class="sxs-lookup"><span data-stu-id="447f8-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], and select **New Project** from the **File** menu.</span></span>  
  
2.  <span data-ttu-id="447f8-155">Seçin **Win32** listesinden [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] proje türleri.</span><span class="sxs-lookup"><span data-stu-id="447f8-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="447f8-156">Varsayılan dilinizi değilse [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], bu proje türleri altında bulabilirsiniz **diğer diller**.</span><span class="sxs-lookup"><span data-stu-id="447f8-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>  
  
3.  <span data-ttu-id="447f8-157">Seçin bir **Win32 Proje** şablonu, proje için bir ad atayın ve tıklatın **Tamam** başlatmak için **Win32 Uygulama Sihirbazı'nı**.</span><span class="sxs-lookup"><span data-stu-id="447f8-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>  
  
4.  <span data-ttu-id="447f8-158">Sihirbazın varsayılan ayarları kabul edin ve tıklatın **son** projeyi başlatın.</span><span class="sxs-lookup"><span data-stu-id="447f8-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>  
  
 <span data-ttu-id="447f8-159">Temel bir şablon oluşturur [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulaması da dahil olmak üzere:</span><span class="sxs-lookup"><span data-stu-id="447f8-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>  
  
-   <span data-ttu-id="447f8-160">Uygulama için bir giriş noktası.</span><span class="sxs-lookup"><span data-stu-id="447f8-160">An entry point for the application.</span></span>  
  
-   <span data-ttu-id="447f8-161">Bir ilişkili pencere yordamı (WndProc) içeren bir pencere.</span><span class="sxs-lookup"><span data-stu-id="447f8-161">A window, with an associated window procedure (WndProc).</span></span>  
  
-   <span data-ttu-id="447f8-162">Bir menüsüyle **dosya** ve **yardımcı** başlıkları.</span><span class="sxs-lookup"><span data-stu-id="447f8-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="447f8-163">**Dosya** menü sahip bir **çıkış** Uygulama kapandıktan öğesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="447f8-164">**Yardımcı** menü sahip bir **hakkında** basit bir iletişim kutusu başlatır öğesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>  
  
 <span data-ttu-id="447f8-165">Ana bilgisayara kod yazmaya başlamadan önce [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik, temel şablon iki değişiklikler yapma gerekir.</span><span class="sxs-lookup"><span data-stu-id="447f8-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>  
  
 <span data-ttu-id="447f8-166">İlk olarak yönetilen kod projesi derlemektir.</span><span class="sxs-lookup"><span data-stu-id="447f8-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="447f8-167">Varsayılan olarak, projeyi yönetilmeyen kodu olarak derler.</span><span class="sxs-lookup"><span data-stu-id="447f8-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="447f8-168">Ancak, çünkü [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulanan yönetilen kodda proje uygun şekilde derlenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="447f8-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>  
  
1.  <span data-ttu-id="447f8-169">Proje adına sağ tıklayın **Çözüm Gezgini** seçip **özellikleri** başlatmak için bağlam menüsünden **özellik sayfaları** iletişim kutusu.</span><span class="sxs-lookup"><span data-stu-id="447f8-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>  
  
2.  <span data-ttu-id="447f8-170">Seçin **yapılandırma özellikleri** sol bölmede ağaç görünümünden.</span><span class="sxs-lookup"><span data-stu-id="447f8-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>  
  
3.  <span data-ttu-id="447f8-171">Seçin **ortak dil çalışma zamanı** gelen destek **Proje Varsayılanları** sağ bölmede listesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>  
  
4.  <span data-ttu-id="447f8-172">Seçin **ortak dil çalışma zamanı desteği (/ clr)** aşağı açılan liste kutusundan.</span><span class="sxs-lookup"><span data-stu-id="447f8-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="447f8-173">Bu derleyici bayrağı, uygulamanızda yönetilen kod kullanmanıza olanak sağlar, ancak yönetilmeyen kodunuzu hala eskisi derlenir.</span><span class="sxs-lookup"><span data-stu-id="447f8-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="447f8-174">iş parçacığı modeli tek iş parçacıklı (STA) kullanır.</span><span class="sxs-lookup"><span data-stu-id="447f8-174"> uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="447f8-175">İle düzgün çalışması için [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik kodu ayarlamanız gerekir uygulamanın iş parçacığı modelini STA için giriş noktası için bir öznitelik uygulayarak.</span><span class="sxs-lookup"><span data-stu-id="447f8-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]  
  
<a name="hosting_the_wpf_page"></a>   
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="447f8-176">WPF içeriği barındırma</span><span class="sxs-lookup"><span data-stu-id="447f8-176">Hosting the WPF Content</span></span>  
 <span data-ttu-id="447f8-177">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği bir basit adresi giriş uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="447f8-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="447f8-178">Birkaç oluşur <xref:System.Windows.Controls.TextBox> kullanıcı adını, adresini vb. yapılacak kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="447f8-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="447f8-179">Ayrıca vardır iki <xref:System.Windows.Controls.Button> denetimleri **Tamam** ve **iptal**.</span><span class="sxs-lookup"><span data-stu-id="447f8-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="447f8-180">Kullanıcı tıkladığında **Tamam**, düğmenin <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olay işleyicisi verileri toplar <xref:System.Windows.Controls.TextBox> denetimleri, karşılık gelen özellikleriyle atar ve özel bir olay başlatır `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="447f8-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="447f8-181">Kullanıcı tıkladığında **iptal**, işleyici yalnızca başlatır `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="447f8-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="447f8-182">İçin olay bağımsız değişkeni nesnesi `OnButtonClicked` hangi düğmenin tıklandığını gösteren bir Boole alanı içerir.</span><span class="sxs-lookup"><span data-stu-id="447f8-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>  
  
 <span data-ttu-id="447f8-183">Ana bilgisayar koda [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik için bir işleyici uygulandığına [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) ana penceresinde bildirim.</span><span class="sxs-lookup"><span data-stu-id="447f8-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) notification on the host window.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]  
  
 <span data-ttu-id="447f8-184">`GetHwnd` Yöntemi boyutunu ve konumunu bilgi artı üst pencere tanıtıcının alır ve barındırılan pencere işleyicisini döndürür [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="447f8-185">Kullanarak bir `#using` için yönerge `System::Windows::Interop` ad alanı.</span><span class="sxs-lookup"><span data-stu-id="447f8-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="447f8-186">Bunun yapılması oluşturur arasında bir ad çakışması <xref:System.Windows.Interop.MSG> bu ad alanındaki yapısı ve MSG yapısı içinde winuser.h bildirildi.</span><span class="sxs-lookup"><span data-stu-id="447f8-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="447f8-187">Bunun yerine, bu ad alanı içeriğine erişmek için tam olarak nitelenmiş adlar kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="447f8-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]  
  
 <span data-ttu-id="447f8-188">Barındıramaz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] doğrudan uygulama pencerenizde içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="447f8-189">Bunun yerine, önce oluşturduğunuz bir <xref:System.Windows.Interop.HwndSource> sarmalamak için nesne [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-190">Bu nesnenin temel olarak barındırmak için tasarlanmış bir penceredir bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-191">Konak <xref:System.Windows.Interop.HwndSource> bir alt öğesi olarak oluşturarak üst pencere nesnesinde bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulamanızı parçası olan penceresi.</span><span class="sxs-lookup"><span data-stu-id="447f8-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="447f8-192"><xref:System.Windows.Interop.HwndSource> Oluşturucu parametreleri içeren oluşturduğunuzda CreateWindow'unkine geçip geçmeyeceğini çok aynı bilgileri bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] alt pencere.</span><span class="sxs-lookup"><span data-stu-id="447f8-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>  
  
 <span data-ttu-id="447f8-193">Sonraki bir örneğini oluşturmak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik nesnesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="447f8-194">Bu durumda, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik ayrı bir sınıf olarak uygulanan `WPFPage`kullanarak [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="447f8-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="447f8-195">Ayrıca uygulama [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ile içerik [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="447f8-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="447f8-196">Ancak, bunu yapmak için gereken bir ayrı projesi ayarlayın ve yapı [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] olarak içerik bir [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="447f8-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="447f8-197">Bir başvuru ekleyebilir [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] proje ve bir örneğini oluşturmak için başvuru kullanım [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 <span data-ttu-id="447f8-198">Görüntü [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] alt pencerenizde başvuru atayarak içerik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik <xref:System.Windows.Interop.HwndSource.RootVisual%2A> özelliği <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="447f8-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
 <span data-ttu-id="447f8-199">Kodun sonraki satırında, bir olay işleyicisi ekler `WPFButtonClicked`, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik `OnButtonClicked` olay.</span><span class="sxs-lookup"><span data-stu-id="447f8-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="447f8-200">Kullanıcı tıkladığında bu işleyici adlı **Tamam** veya **iptal** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="447f8-201">Bkz: [communicating_with_the_WPF içerik](#communicating_with_the_page) daha fazla irdelemesi için bu olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="447f8-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>  
  
 <span data-ttu-id="447f8-202">İle ilişkili bir pencere tanıtıcının (HWND) gösterilen kodun son satırı döndürür <xref:System.Windows.Interop.HwndSource> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="447f8-203">Bu işleyici gelen kullanabilirsiniz, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] örnek Bunu yapmak olsa da barındırılan penceresine iletileri göndermek için kod.</span><span class="sxs-lookup"><span data-stu-id="447f8-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="447f8-204"><xref:System.Windows.Interop.HwndSource> Nesnesi bir ileti alır her zaman bir olay başlatır.</span><span class="sxs-lookup"><span data-stu-id="447f8-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="447f8-205">İletileri işlemek üzere çağrı <xref:System.Windows.Interop.HwndSource.AddHook%2A> ileti işleyicisi ekleme ve bu işleyici iletileri işlemek için yöntem.</span><span class="sxs-lookup"><span data-stu-id="447f8-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>  
  
<a name="holding_a_reference"></a>   
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="447f8-206">WPF içeriği için bir başvuru bulunduran</span><span class="sxs-lookup"><span data-stu-id="447f8-206">Holding a Reference to the WPF Content</span></span>  
 <span data-ttu-id="447f8-207">Birçok uygulama için iletişim isteyeceksiniz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] daha sonra içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="447f8-208">Örneğin, değiştirmek isteyebilirsiniz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özellikleri veya belki de sahip <xref:System.Windows.Interop.HwndSource> nesne konak farklı [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-209">Bunu yapmak için bir başvuru gerekir <xref:System.Windows.Interop.HwndSource> nesne veya [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-210"><xref:System.Windows.Interop.HwndSource> Nesne ve onun ilişkili [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik pencere tanıtıcının destroy kadar bellekte kalır.</span><span class="sxs-lookup"><span data-stu-id="447f8-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="447f8-211">Ancak, değişken atadığınız <xref:System.Windows.Interop.HwndSource> penceresi yordamdan dönüş hemen nesne kapsam dışında gider.</span><span class="sxs-lookup"><span data-stu-id="447f8-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="447f8-212">Bu sorun işlemek için her zamanki şekilde [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulamalar, statik ya da genel değişkeni kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="447f8-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="447f8-213">Ne yazık ki, bu değişkenleri türleri için yönetilen bir nesne atayamazsınız.</span><span class="sxs-lookup"><span data-stu-id="447f8-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="447f8-214">İle ilişkili bir pencere tanıtıcının atayabilirsiniz <xref:System.Windows.Interop.HwndSource> doe nesnesine erişim sağlamak için değil ancak bu bir genel veya statik değişkene nesne.</span><span class="sxs-lookup"><span data-stu-id="447f8-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>  
  
 <span data-ttu-id="447f8-215">Bu sorunu en basit çözümü erişmesi gereken tüm yönetilen nesnelerin başvuruları tutmak için statik alanları kümesini içeren bir yönetilen sınıf uygulamaktır.</span><span class="sxs-lookup"><span data-stu-id="447f8-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="447f8-216">Örnek kullanır `WPFPageHost` bir başvuru tutmak için sınıf [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik yanı sıra, daha sonra kullanıcı tarafından değiştirilmiş ve özelliklerini bir sayının ilk değerleri.</span><span class="sxs-lookup"><span data-stu-id="447f8-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="447f8-217">Bu başlığında tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="447f8-217">This is defined in the header.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]  
  
 <span data-ttu-id="447f8-218">İkinci bölümü `GetHwnd` işlevi sırasında daha sonra kullanmak için bu alanlar için değerleri atar `myPage` hala kapsamında değil.</span><span class="sxs-lookup"><span data-stu-id="447f8-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>  
  
<a name="communicating_with_the_page"></a>   
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="447f8-219">WPF içeriği ile iletişim</span><span class="sxs-lookup"><span data-stu-id="447f8-219">Communicating with the WPF Content</span></span>  
 <span data-ttu-id="447f8-220">İle iletişim iki tür vardır [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-221">Uygulama bilgileri alır [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik kullanıcı tıklattığında **Tamam** veya **iptal** düğmeler.</span><span class="sxs-lookup"><span data-stu-id="447f8-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="447f8-222">Uygulama de sahip bir [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] kullanıcının çeşitli değiştirmesine olanak tanıyan [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik arka plan rengini veya varsayılan yazı tipi boyutu gibi özellikleri.</span><span class="sxs-lookup"><span data-stu-id="447f8-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>  
  
 <span data-ttu-id="447f8-223">Yukarıda belirtildiği gibi kullanıcı tıkladığında ya da düğmesini [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik başlatır bir `OnButtonClicked` olay.</span><span class="sxs-lookup"><span data-stu-id="447f8-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="447f8-224">Uygulama bu bildirimleri almak için bu olay işleyici iliştirir.</span><span class="sxs-lookup"><span data-stu-id="447f8-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="447f8-225">Varsa **Tamam** düğmesine tıklandığında, kullanıcı bilgilerini işleyici alır [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik ve statik denetimleri kümesinde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="447f8-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]  
  
 <span data-ttu-id="447f8-226">Özel olay bağımsız değişkeni nesnesinden işleyici alır [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="447f8-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="447f8-227">Nesnenin `IsOK` özelliği ayarlanmış `true` varsa **Tamam** düğmesine tıklandığında, ve `false` varsa **iptal** düğmesine tıklanana.</span><span class="sxs-lookup"><span data-stu-id="447f8-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>  
  
 <span data-ttu-id="447f8-228">Varsa **Tamam** düğmesine tıklandığında, işleyici için bir başvuru alır [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] kapsayıcı sınıfından içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="447f8-229">Ardından tutulur kullanıcı bilgilerini toplar ilişkili [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özellikleri ve kullandığı ana penceresinde bilgileri görüntülemek için statik denetimler.</span><span class="sxs-lookup"><span data-stu-id="447f8-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="447f8-230">Çünkü [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik veri yönetilen bir dize biçiminde, tarafından kullanılmak üzere sıralanması gerekir bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] denetim.</span><span class="sxs-lookup"><span data-stu-id="447f8-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="447f8-231">Varsa **iptal** düğmesine tıklandığında, işleyici statik denetimleri verileri temizler.</span><span class="sxs-lookup"><span data-stu-id="447f8-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>  
  
 <span data-ttu-id="447f8-232">Uygulama [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] arka plan rengini değiştirmek kullanıcının izin radyo düğmeleri kümesi sağlar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik ve birkaç yazı tipi ilgili özellikler.</span><span class="sxs-lookup"><span data-stu-id="447f8-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="447f8-233">Aşağıdaki örnek uygulama penceresi yordamdan (WndProc) bir alıntı aynıdır ve kendi ileti, işleme arka plan rengini de dahil olmak üzere farklı iletilerde çeşitli özelliklerini ayarlar.</span><span class="sxs-lookup"><span data-stu-id="447f8-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="447f8-234">Diğer benzer ve gösterilmez.</span><span class="sxs-lookup"><span data-stu-id="447f8-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="447f8-235">Tam örnek ayrıntıları ve bağlam için bkz.</span><span class="sxs-lookup"><span data-stu-id="447f8-235">See the complete sample for details and context.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]  
  
 <span data-ttu-id="447f8-236">Arka plan rengini ayarlamak için bir başvuru almak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği (`hostedPage`) gelen `WPFPageHost` ve uygun renk arka plan rengi özelliğini ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="447f8-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="447f8-237">Örnek üç renk seçeneklerini kullanır: açık yeşil ya da açık SOM, özgün rengi.</span><span class="sxs-lookup"><span data-stu-id="447f8-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="447f8-238">Özgün arka plan rengi statik bir alana olarak depolanan `WPFPageHost` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="447f8-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="447f8-239">Diğer iki ayarlamak için yeni oluşturduğunuz <xref:System.Windows.Media.SolidColorBrush> nesne ve bir statik renkleri değerinden Oluşturucusu geçirin <xref:System.Windows.Media.Colors> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>  
  
<a name="implementing_the_wpf_page"></a>   
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="447f8-240">WPF sayfası uygulama</span><span class="sxs-lookup"><span data-stu-id="447f8-240">Implementing the WPF Page</span></span>  
 <span data-ttu-id="447f8-241">Ana bilgisayar ve kullanmak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] gerçek uygulama bilgisi olmadan içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="447f8-242">Varsa [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik, ayrı bir paketlenmiş [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], onu birinde oluşturulmuş [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] dili.</span><span class="sxs-lookup"><span data-stu-id="447f8-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="447f8-243">Aşağıdadır kısa bir kılavuz [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] örnekte kullanılan uygulama.</span><span class="sxs-lookup"><span data-stu-id="447f8-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="447f8-244">Bu bölüm aşağıdaki alt bölümleri içerir.</span><span class="sxs-lookup"><span data-stu-id="447f8-244">This section contains the following subsections.</span></span>  
  
<a name="autoNestedSectionsOUTLINE2"></a>   
-   [<span data-ttu-id="447f8-245">Düzen</span><span class="sxs-lookup"><span data-stu-id="447f8-245">Layout</span></span>](#page_layout)  
  
-   [<span data-ttu-id="447f8-246">Konak penceresine veriyor</span><span class="sxs-lookup"><span data-stu-id="447f8-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)  
  
-   [<span data-ttu-id="447f8-247">WPF özelliklerini ayarlama</span><span class="sxs-lookup"><span data-stu-id="447f8-247">Setting the WPF Properties</span></span>](#set_page_properties)  
  
<a name="page_layout"></a>   
### <a name="layout"></a><span data-ttu-id="447f8-248">Düzen</span><span class="sxs-lookup"><span data-stu-id="447f8-248">Layout</span></span>  
 <span data-ttu-id="447f8-249">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Öğelerinde [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik oluşur beş <xref:System.Windows.Controls.TextBox> denetimleri, ilişkili <xref:System.Windows.Controls.Label> denetimleri: ad, adres, şehir, durumu ve Zip.</span><span class="sxs-lookup"><span data-stu-id="447f8-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="447f8-250">Ayrıca vardır iki <xref:System.Windows.Controls.Button> denetimleri **Tamam** ve **iptal et**</span><span class="sxs-lookup"><span data-stu-id="447f8-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>  
  
 <span data-ttu-id="447f8-251">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik uygulandığına `WPFPage` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="447f8-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="447f8-252">Düzen ile işlenir bir <xref:System.Windows.Controls.Grid> Düzen öğesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="447f8-253">Sınıfının devraldığı <xref:System.Windows.Controls.Grid>, hangi etkili bir şekilde kılar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik kök öğesi.</span><span class="sxs-lookup"><span data-stu-id="447f8-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>  
  
 <span data-ttu-id="447f8-254">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik Oluşturucusu alır gereken genişlik ve yükseklik ve boyutları <xref:System.Windows.Controls.Grid> uygun şekilde.</span><span class="sxs-lookup"><span data-stu-id="447f8-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="447f8-255">Bir dizi oluşturarak sonra temel düzeni tanımlar <xref:System.Windows.Controls.ColumnDefinition> ve <xref:System.Windows.Controls.RowDefinition> nesneleri ve bunlara ekleme <xref:System.Windows.Controls.Grid> nesne temel <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> ve <xref:System.Windows.Controls.Grid.RowDefinitions%2A> koleksiyonlar, sırasıyla.</span><span class="sxs-lookup"><span data-stu-id="447f8-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="447f8-256">Bu, beş satır ve yedi sütun oluşan bir kılavuz hücreleri içeriği tarafından belirlenen boyutlarla tanımlar.</span><span class="sxs-lookup"><span data-stu-id="447f8-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]  
  
 <span data-ttu-id="447f8-257">Ardından, Oluşturucusu ekler [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] öğelerine <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="447f8-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="447f8-258">Başlık metni ilk öğedir bir <xref:System.Windows.Controls.Label> ızgaranın ilk satırda ortalanmış denetim.</span><span class="sxs-lookup"><span data-stu-id="447f8-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]  
  
 <span data-ttu-id="447f8-259">Sonraki satıra adı içeren <xref:System.Windows.Controls.Label> denetim ve onun ilişkili <xref:System.Windows.Controls.TextBox> denetim.</span><span class="sxs-lookup"><span data-stu-id="447f8-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="447f8-260">Aynı kodu her etiket/textbox çifti için kullanıldığından, özel yöntemleri bir çiftinden yerleştirilir ve tüm beş etiket/textbox çiftleri için kullanılan.</span><span class="sxs-lookup"><span data-stu-id="447f8-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="447f8-261">Yöntemleri uygun oluşturmak denetlemek ve arama <xref:System.Windows.Controls.Grid> statik sınıf <xref:System.Windows.Controls.Grid.SetColumn%2A> ve <xref:System.Windows.Controls.Grid.SetRow%2A> yöntemleri denetimleri uygun hücreye yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="447f8-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="447f8-262">Denetim oluşturulduktan sonra örnek çağırır <xref:System.Windows.Controls.UIElementCollection.Add%2A> yöntemi <xref:System.Windows.Controls.Panel.Children%2A> özelliği <xref:System.Windows.Controls.Grid> kılavuza denetim eklemek için.</span><span class="sxs-lookup"><span data-stu-id="447f8-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="447f8-263">Kalan etiket/textbox çiftleri eklemek üzere kod benzer.</span><span class="sxs-lookup"><span data-stu-id="447f8-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="447f8-264">Örnek kod Ayrıntılar için bkz.</span><span class="sxs-lookup"><span data-stu-id="447f8-264">See the sample code for details.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]  
  
 <span data-ttu-id="447f8-265">İki yöntemden birini uygulaması aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="447f8-265">The implementation of the two methods is as follows:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]  
  
 <span data-ttu-id="447f8-266">Son olarak, örnek ekler **Tamam** ve **iptal** düğmeler ve bir olay işleyicisi ekler kendi <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olaylar.</span><span class="sxs-lookup"><span data-stu-id="447f8-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]  
  
<a name="returning_data_to_window"></a>   
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="447f8-267">Konak penceresine veriyor</span><span class="sxs-lookup"><span data-stu-id="447f8-267">Returning the Data to the Host Window</span></span>  
 <span data-ttu-id="447f8-268">Her iki düğmesine tıklandığında, kendi <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olayı oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="447f8-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="447f8-269">Konak penceresi yalnızca bu olaylara işleyicileri ekleyin ve doğrudan veri al <xref:System.Windows.Controls.TextBox> kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="447f8-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="447f8-270">Örnek biraz daha az doğrudan bir yaklaşım kullanır.</span><span class="sxs-lookup"><span data-stu-id="447f8-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="447f8-271">Bu işleme <xref:System.Windows.Controls.Primitives.ButtonBase.Click> içinde [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik ve özel bir olay başlatır `OnButtonClicked`bildirmek için [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği.</span><span class="sxs-lookup"><span data-stu-id="447f8-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="447f8-272">Böylece [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] konak bildiren önce bazı parametre doğrulaması yapmak içerik.</span><span class="sxs-lookup"><span data-stu-id="447f8-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="447f8-273">Metinden işleyici alır <xref:System.Windows.Controls.TextBox> denetler ve bilgilerin alınacağı konak alabilir genel özelliklerine atar.</span><span class="sxs-lookup"><span data-stu-id="447f8-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>  
  
 <span data-ttu-id="447f8-274">Olay bildirimi WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="447f8-274">The event declaration, in WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]  
  
 <span data-ttu-id="447f8-275"><xref:System.Windows.Controls.Primitives.ButtonBase.Click> WPFPage.cpp, olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="447f8-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]  
  
<a name="set_page_properties"></a>   
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="447f8-276">WPF özelliklerini ayarlama</span><span class="sxs-lookup"><span data-stu-id="447f8-276">Setting the WPF Properties</span></span>  
 <span data-ttu-id="447f8-277">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Ana bilgisayarın kullanıcının birkaç değiştirmesine izin verir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özellikleri.</span><span class="sxs-lookup"><span data-stu-id="447f8-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="447f8-278">Gelen [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] yan, olmasından özelliklerini değiştirme basitçe kurabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="447f8-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="447f8-279">Uygulamasında [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] denetimleri yazı tipleri tüm denetimler için tek bir genel özellik olduğundan içerik sınıfı biraz daha karmaşıktır.</span><span class="sxs-lookup"><span data-stu-id="447f8-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="447f8-280">Bunun yerine, her denetim için uygun özelliği özellikleri set erişimcileri değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="447f8-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="447f8-281">Aşağıdaki örnek kodunu gösterir `DefaultFontFamily` özelliği.</span><span class="sxs-lookup"><span data-stu-id="447f8-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="447f8-282">Özelliği bir özel yöntemini çağırır bu sırayla kümeleri <xref:System.Windows.Controls.Control.FontFamily%2A> çeşitli denetimlerin özelliklerini.</span><span class="sxs-lookup"><span data-stu-id="447f8-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>  
  
 <span data-ttu-id="447f8-283">WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="447f8-283">From WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]  
  
 <span data-ttu-id="447f8-284">WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="447f8-284">From WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]  
  
## <a name="see-also"></a><span data-ttu-id="447f8-285">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="447f8-285">See Also</span></span>  
 <xref:System.Windows.Interop.HwndSource>  
 [<span data-ttu-id="447f8-286">WPF ve Win32 birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="447f8-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)
