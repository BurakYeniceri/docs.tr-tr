---
title: "Birlikte Çalışma Hazırlama"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- marshaling, COM interop
- interop marshaling
- interop marshaling, about interop marshaling
ms.assetid: 115f7a2f-d422-4605-ab36-13a8dd28142a
caps.latest.revision: "22"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 17638390a07f752a7101209e5635752bc0511d1d
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/19/2018
---
# <a name="interop-marshaling"></a><span data-ttu-id="cbdc5-102">Birlikte Çalışma Hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-102">Interop Marshaling</span></span>
<a name="top"></a><span data-ttu-id="cbdc5-103">Birlikte çalışma hazırlama veri çağrı sırasında yönetilen ve yönetilmeyen bellek arasında yöntem bağımsız değişkenleri ve dönüş değerleri nasıl geçirilir yönetir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-103">Interop marshaling governs how data is passed in method arguments and return values between managed and unmanaged memory during calls.</span></span> <span data-ttu-id="cbdc5-104">Birlikte çalışma hazırlama ortak dil çalışma zamanı 's hazırlama hizmeti tarafından gerçekleştirilen bir çalışma zamanı etkinliğidir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-104">Interop marshaling is a run-time activity performed by the common language runtime's marshaling service.</span></span>  
  
 <span data-ttu-id="cbdc5-105">Çoğu veri türleri, yönetilen ve yönetilmeyen bellekte ortak Beyanları sahip.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-105">Most data types have common representations in both managed and unmanaged memory.</span></span> <span data-ttu-id="cbdc5-106">Birlikte çalışma Sıralayıcı bu tür işler.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-106">The interop marshaler handles these types for you.</span></span> <span data-ttu-id="cbdc5-107">Diğer türleri belirsiz veya hiç yönetilen bellekte gösterilen olabilir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-107">Other types can be ambiguous or not represented at all in managed memory.</span></span>  
  
 <span data-ttu-id="cbdc5-108">Belirsiz tür için tek bir yönetilen türü harita birden çok yönetilmeyen Beyanları ya da bir dizi boyutu gibi türü bilgileri eksik olabilir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-108">An ambiguous type can have either multiple unmanaged representations that map to a single managed type, or missing type information, such as the size of an array.</span></span> <span data-ttu-id="cbdc5-109">Belirsiz türleri için varsayılan gösterimi ve birden çok Beyanları var olduğu diğer gösterimler Sıralayıcı sağlar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-109">For ambiguous types, the marshaler provides a default representation and alternative representations where multiple representations exist.</span></span> <span data-ttu-id="cbdc5-110">Sıralayıcı nasıl belirsiz bir tür sıralamakta olduğu açık yönergeler sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-110">You can supply explicit instructions to the marshaler on how it is to marshal an ambiguous type.</span></span>  
  
 <span data-ttu-id="cbdc5-111">Bu genel bakışta aşağıdaki bölümleri içerir:</span><span class="sxs-lookup"><span data-stu-id="cbdc5-111">This overview contains the following sections:</span></span>  
  
-   [<span data-ttu-id="cbdc5-112">Platform çağırma ve COM birlikte çalışma modelleri</span><span class="sxs-lookup"><span data-stu-id="cbdc5-112">Platform Invoke and COM Interop Models</span></span>](#platform_invoke_and_com_interop_models)  
  
-   [<span data-ttu-id="cbdc5-113">Marshaling ve COM grupların</span><span class="sxs-lookup"><span data-stu-id="cbdc5-113">Marshaling and COM Apartments</span></span>](#marshaling_and_com_apartments)  
  
-   [<span data-ttu-id="cbdc5-114">Uzak çağrılar hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-114">Marshaling Remote Calls</span></span>](#marshaling_remote_calls)  
  
-   [<span data-ttu-id="cbdc5-115">İlgili Konular</span><span class="sxs-lookup"><span data-stu-id="cbdc5-115">Related Topics</span></span>](#related_topics)  
  
-   [<span data-ttu-id="cbdc5-116">Başvuru</span><span class="sxs-lookup"><span data-stu-id="cbdc5-116">Reference</span></span>](#reference)  
  
<a name="platform_invoke_and_com_interop_models"></a>   
## <a name="platform-invoke-and-com-interop-models"></a><span data-ttu-id="cbdc5-117">Platform çağırma ve COM birlikte çalışma modelleri</span><span class="sxs-lookup"><span data-stu-id="cbdc5-117">Platform Invoke and COM Interop Models</span></span>  
 <span data-ttu-id="cbdc5-118">Ortak dil çalışma zamanı yönetilmeyen kod ile birlikte çalışma için iki mekanizma sağlar:</span><span class="sxs-lookup"><span data-stu-id="cbdc5-118">The common language runtime provides two mechanisms for interoperating with unmanaged code:</span></span>  
  
-   <span data-ttu-id="cbdc5-119">Platform çağırma yönetilmeyen Kitaplığı'ndan dışarı aktarılan işlevleri çağırmak yönetilen kod sağlar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-119">Platform invoke, which enables managed code to call functions exported from an unmanaged library.</span></span>  
  
-   <span data-ttu-id="cbdc5-120">Arabirimleri aracılığıyla Bileşen Nesne Modeli (COM) nesnelerle etkileşim kurmak yönetilen kod sağlayan COM birlikte çalışma.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-120">COM interop, which enables managed code to interact with Component Object Model (COM) objects through interfaces.</span></span>  
  
 <span data-ttu-id="cbdc5-121">Her iki platform çağırma ve COM birlikte çalışma kullanım birlikte çalışma doğru yöntem bağımsız değişkenleri arasında çağıran ve çağrılan ve geri taşımak için hazırlama gerekli.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-121">Both platform invoke and COM interop use interop marshaling to accurately move method arguments between caller and callee and back, if required.</span></span> <span data-ttu-id="cbdc5-122">Aşağıdaki çizimde gösterildiği gibi bir platform çağırma yöntemi çağrısı akış yaptığı yönetilmeyen kod ve hiçbir zaman zaman dışındaki diğer yol yönetilen [geri arama işlevleri](../../../docs/framework/interop/callback-functions.md) karmaşıktır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-122">As the following illustration shows, a platform invoke method call flows from managed to unmanaged code and never the other way, except when [callback functions](../../../docs/framework/interop/callback-functions.md) are involved.</span></span> <span data-ttu-id="cbdc5-123">Platform çağırma olsa bile çağrıları yalnızca yönetilmeyen kod için yönetilen akabilir, veri giriş veya çıkış parametreleri olarak her iki yönde akmasını sağlamak.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-123">Even though platform invoke calls can flow only from managed to unmanaged code, data can flow in both directions as input or output parameters.</span></span> <span data-ttu-id="cbdc5-124">COM birlikte çalışma yöntem çağrıları herhangi bir yönde akabilir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-124">COM interop method calls can flow in either direction.</span></span>  
  
 <span data-ttu-id="cbdc5-125">![Platform Çağırma](../../../docs/framework/interop/media/interopmarshaling.png "interopmarshaling")</span><span class="sxs-lookup"><span data-stu-id="cbdc5-125">![Platform invoke](../../../docs/framework/interop/media/interopmarshaling.png "interopmarshaling")</span></span>  
<span data-ttu-id="cbdc5-126">Platform çağırma ve COM birlikte çalışma çağrısı akış</span><span class="sxs-lookup"><span data-stu-id="cbdc5-126">Platform invoke and COM interop call flow</span></span>  
  
 <span data-ttu-id="cbdc5-127">En düşük düzeyde her iki hizmet hazırlama aynı birlikte çalışabilirliği kullanın; Ancak, özel olarak COM birlikte çalışma tarafından desteklenen belirli veri türleri veya platform çağırma.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-127">At the lowest level, both mechanisms use the same interop marshaling service; however, certain data types are supported exclusively by COM interop or platform invoke.</span></span> <span data-ttu-id="cbdc5-128">Ayrıntılar için bkz [varsayılan hazırlama davranışı](../../../docs/framework/interop/default-marshaling-behavior.md).</span><span class="sxs-lookup"><span data-stu-id="cbdc5-128">For details, see [Default Marshaling Behavior](../../../docs/framework/interop/default-marshaling-behavior.md).</span></span>  
  
 [<span data-ttu-id="cbdc5-129">Başa dön</span><span class="sxs-lookup"><span data-stu-id="cbdc5-129">Back to top</span></span>](#top)  
  
<a name="marshaling_and_com_apartments"></a>   
## <a name="marshaling-and-com-apartments"></a><span data-ttu-id="cbdc5-130">Marshaling ve COM grupların</span><span class="sxs-lookup"><span data-stu-id="cbdc5-130">Marshaling and COM Apartments</span></span>  
 <span data-ttu-id="cbdc5-131">Birlikte çalışma Sıralayıcı ortak dil çalışma zamanı öbek ve yönetilmeyen yığın arasında veri sıralar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-131">The interop marshaler marshals data between the common language runtime heap and the unmanaged heap.</span></span> <span data-ttu-id="cbdc5-132">Çağıran ve çağrılan veri aynı örneğinde çalışamaz her hazırlama gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-132">Marshaling occurs whenever the caller and callee cannot operate on the same instance of data.</span></span> <span data-ttu-id="cbdc5-133">Birlikte çalışma Sıralayıcı çağıran ve çağrılan kendi verilerin kopyasını olsa bile aynı verileri çalışmanız için görünmesi mümkün kılar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-133">The interop marshaler makes it possible for the caller and callee to appear to be operating on the same data even if they have their own copy of the data.</span></span>  
  
 <span data-ttu-id="cbdc5-134">COM COM grupların veya farklı COM işlemler arasında veri sıralar Sıralayıcı de vardır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-134">COM also has a marshaler that marshals data between COM apartments or different COM processes.</span></span> <span data-ttu-id="cbdc5-135">Aynı COM grup içinde yönetilen ve yönetilmeyen kodu arasında çağrılırken birlikte çalışma Sıralayıcı söz konusu yalnızca Sıralayıcı ' dir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-135">When calling between managed and unmanaged code within the same COM apartment, the interop marshaler is the only marshaler involved.</span></span> <span data-ttu-id="cbdc5-136">Yönetilen kod ve farklı bir COM Grup ya da farklı bir işlem yönetilmeyen kod arasında çağrılırken birlikte çalışma Sıralayıcı ve COM Sıralayıcı ilgilidir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-136">When calling between managed code and unmanaged code in a different COM apartment or a different process, both the interop marshaler and the COM marshaler are involved.</span></span>  
  
### <a name="com-clients-and-managed-servers"></a><span data-ttu-id="cbdc5-137">COM istemcileri ve yönetilen sunucular</span><span class="sxs-lookup"><span data-stu-id="cbdc5-137">COM Clients and Managed Servers</span></span>  
 <span data-ttu-id="cbdc5-138">Tür kitaplığı dışarı aktarılan bir yönetilen sunucusuyla kayıtlı tarafından [Regasm.exe (derleme kayıt aracı)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) sahip bir `ThreadingModel` ayarlamak kayıt defteri girdisini `Both`.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-138">An exported managed server with a type library registered by the [Regasm.exe (Assembly Registration Tool)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) has a `ThreadingModel` registry entry set to `Both`.</span></span> <span data-ttu-id="cbdc5-139">Bu değer, sunucunun bir tek iş parçacıklı (STA) veya birden çok iş parçacıklı grup (MTA) etkinleştirilebilir gösterir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-139">This value indicates that the server can be activated in a single-threaded apartment (STA) or a multithreaded apartment (MTA).</span></span> <span data-ttu-id="cbdc5-140">Sunucu nesnesi aynı grup kendi arayan olarak aşağıdaki tabloda gösterildiği gibi oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-140">The server object is created in the same apartment as its caller, as shown in the following table.</span></span>  
  
|<span data-ttu-id="cbdc5-141">COM istemcisi</span><span class="sxs-lookup"><span data-stu-id="cbdc5-141">COM client</span></span>|<span data-ttu-id="cbdc5-142">.NET sunucusu</span><span class="sxs-lookup"><span data-stu-id="cbdc5-142">.NET server</span></span>|<span data-ttu-id="cbdc5-143">Gereksinimleri hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-143">Marshaling requirements</span></span>|  
|----------------|-----------------|-----------------------------|  
|<span data-ttu-id="cbdc5-144">STA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-144">STA</span></span>|<span data-ttu-id="cbdc5-145">`Both`STA olur</span><span class="sxs-lookup"><span data-stu-id="cbdc5-145">`Both` becomes STA.</span></span>|<span data-ttu-id="cbdc5-146">Grup aynı hazırlama.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-146">Same-apartment marshaling.</span></span>|  
|<span data-ttu-id="cbdc5-147">MTA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-147">MTA</span></span>|<span data-ttu-id="cbdc5-148">`Both`MTA haline gelir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-148">`Both` becomes MTA.</span></span>|<span data-ttu-id="cbdc5-149">Grup aynı hazırlama.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-149">Same-apartment marshaling.</span></span>|  
  
 <span data-ttu-id="cbdc5-150">İstemci ve sunucu aynı grupta olduğundan, hizmet otomatik olarak hazırlama birlikte çalışma hazırlama tüm verileri işler.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-150">Because the client and server are in the same apartment, the interop marshaling service automatically handles all data marshaling.</span></span> <span data-ttu-id="cbdc5-151">Aşağıdaki çizimde aynı COM Stili grup içinde yönetilen ve yönetilmeyen yığınlara arasında işletim birlikte çalışma hazırlama hizmet gösterir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-151">The following illustration shows the interop marshaling service operating between managed and unmanaged heaps within the same COM-style apartment.</span></span>  
  
 <span data-ttu-id="cbdc5-152">![Birlikte çalışma hazırlama](../../../docs/framework/interop/media/interopheap.gif "interopheap")</span><span class="sxs-lookup"><span data-stu-id="cbdc5-152">![Interop marshaling](../../../docs/framework/interop/media/interopheap.gif "interopheap")</span></span>  
<span data-ttu-id="cbdc5-153">Grup aynı Hazırlama işlemi</span><span class="sxs-lookup"><span data-stu-id="cbdc5-153">Same-apartment marshaling process</span></span>  
  
 <span data-ttu-id="cbdc5-154">Yönetilen bir sunucu dışa aktarmayı planlıyorsanız, COM istemcisi sunucu grup belirlediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-154">If you plan to export a managed server, be aware that the COM client determines the apartment of the server.</span></span> <span data-ttu-id="cbdc5-155">MTA içinde başlatılan bir COM istemcisi tarafından çağrılan yönetilen bir sunucu iş parçacığı güvenliği emin olmalısınız.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-155">A managed server called by a COM client initialized in an MTA must ensure thread safety.</span></span>  
  
### <a name="managed-clients-and-com-servers"></a><span data-ttu-id="cbdc5-156">Yönetilen istemciler ve COM sunucuları</span><span class="sxs-lookup"><span data-stu-id="cbdc5-156">Managed Clients and COM Servers</span></span>  
 <span data-ttu-id="cbdc5-157">MTA yönetilen istemci grupların için varsayılan ayardır; Ancak, .NET istemci uygulaması türü varsayılan ayarı değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-157">The default setting for managed client apartments is MTA; however, the application type of the .NET client can change the default setting.</span></span> <span data-ttu-id="cbdc5-158">Örneğin, bir [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] istemci grup ayardır STA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-158">For example, a [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] client apartment setting is STA.</span></span> <span data-ttu-id="cbdc5-159">Kullanabileceğiniz <xref:System.STAThreadAttribute?displayProperty=nameWithType>, <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> özelliği veya <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> incelemek ve yönetilen bir istemci grubu ayarını değiştirmek için özellik.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-159">You can use the <xref:System.STAThreadAttribute?displayProperty=nameWithType>, the <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, the <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> property, or the <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> property to examine and change the apartment setting of a managed client.</span></span>  
  
 <span data-ttu-id="cbdc5-160">Yazarın bileşenin iş parçacığı benzeşimini COM sunucusu ayarlar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-160">The author of the component sets the thread affinity of a COM server.</span></span> <span data-ttu-id="cbdc5-161">Aşağıdaki tabloda .NET istemcileri ve COM sunucuları için Grup ayarları birleşimlerini gösterir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-161">The following table shows the combinations of apartment settings for .NET clients and COM servers.</span></span> <span data-ttu-id="cbdc5-162">Ayrıca, birleşimler için gereksinimleri hazırlama elde edilen gösterir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-162">It also shows the resulting marshaling requirements for the combinations.</span></span>  
  
|<span data-ttu-id="cbdc5-163">.NET istemci</span><span class="sxs-lookup"><span data-stu-id="cbdc5-163">.NET client</span></span>|<span data-ttu-id="cbdc5-164">COM sunucusu</span><span class="sxs-lookup"><span data-stu-id="cbdc5-164">COM server</span></span>|<span data-ttu-id="cbdc5-165">Gereksinimleri hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-165">Marshaling requirements</span></span>|  
|-----------------|----------------|-----------------------------|  
|<span data-ttu-id="cbdc5-166">MTA (varsayılan)</span><span class="sxs-lookup"><span data-stu-id="cbdc5-166">MTA (default)</span></span>|<span data-ttu-id="cbdc5-167">MTA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-167">MTA</span></span><br /><br /> <span data-ttu-id="cbdc5-168">STA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-168">STA</span></span>|<span data-ttu-id="cbdc5-169">Birlikte çalışma hazırlama.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-169">Interop marshaling.</span></span><br /><br /> <span data-ttu-id="cbdc5-170">Birlikte çalışma ve COM hazırlama.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-170">Interop and COM marshaling.</span></span>|  
|<span data-ttu-id="cbdc5-171">STA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-171">STA</span></span>|<span data-ttu-id="cbdc5-172">MTA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-172">MTA</span></span><br /><br /> <span data-ttu-id="cbdc5-173">STA</span><span class="sxs-lookup"><span data-stu-id="cbdc5-173">STA</span></span>|<span data-ttu-id="cbdc5-174">Birlikte çalışma ve COM hazırlama.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-174">Interop and COM marshaling.</span></span><br /><br /> <span data-ttu-id="cbdc5-175">Birlikte çalışma hazırlama.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-175">Interop marshaling.</span></span>|  
  
 <span data-ttu-id="cbdc5-176">Yönetilen istemci ve yönetilmeyen sunucu aynı grupta olduğunda, tüm verileri hazırlama hizmet hazırlama birlikte çalışabilirliği işler.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-176">When a managed client and unmanaged server are in the same apartment, the interop marshaling service handles all data marshaling.</span></span> <span data-ttu-id="cbdc5-177">İstemci ve sunucu farklı grupların hazırlarken, ancak, COM hazırlama de gereklidir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-177">However, when client and server are initialized in different apartments, COM marshaling is also required.</span></span> <span data-ttu-id="cbdc5-178">Aşağıdaki çizimde bir çapraz grup çağrı öğelerini gösterir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-178">The following illustration shows the elements of a cross-apartment call.</span></span>  
  
 <span data-ttu-id="cbdc5-179">![COM hazırlama](../../../docs/framework/interop/media/singleprocessmultapt.gif "singleprocessmultapt")</span><span class="sxs-lookup"><span data-stu-id="cbdc5-179">![COM marshaling](../../../docs/framework/interop/media/singleprocessmultapt.gif "singleprocessmultapt")</span></span>  
<span data-ttu-id="cbdc5-180">Bir .NET istemcisi ve COM nesnesi arasında çapraz grup çağrısı</span><span class="sxs-lookup"><span data-stu-id="cbdc5-180">Cross-apartment call between a .NET client and COM object</span></span>  
  
 <span data-ttu-id="cbdc5-181">Çapraz Grup hazırlama için aşağıdakileri yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="cbdc5-181">For cross-apartment marshaling, you can do the following:</span></span>  
  
-   <span data-ttu-id="cbdc5-182">Yalnızca sınırından birçok çağrıları olduğunda, belirgin olan sıralama arası grup yükünü kabul edin.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-182">Accept the overhead of the cross-apartment marshaling, which is noticeable only when there are many calls across the boundary.</span></span> <span data-ttu-id="cbdc5-183">COM bileşeni başarıyla Grup sınır arası çağrılar için tür kitaplığı kaydetmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-183">You must register the type library of the COM component for calls to successfully cross the apartment boundary.</span></span>  
  
-   <span data-ttu-id="cbdc5-184">Ana iş parçacığı STA ya da MTA istemci iş parçacığı ayarlayarak değiştirin.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-184">Alter the main thread by setting the client thread to STA or MTA.</span></span> <span data-ttu-id="cbdc5-185">C# istemci birçok STA COM bileşenlerini çağırırsa, örneğin, ana iş parçacığı için STA ayarlayarak arası grup hazırlama önleyebilirsiniz</span><span class="sxs-lookup"><span data-stu-id="cbdc5-185">For example, if your C# client calls many STA COM components, you can avoid cross-apartment marshaling by setting the main thread to STA.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="cbdc5-186">Bir C# istemci iş parçacığı için STA ayarladıktan sonra geçici grup hazırlama MTA COM bileşenleri çağrıları gerektirir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-186">Once the thread of a C# client is set to STA, calls to MTA COM components will require cross-apartment marshaling.</span></span>  
  
 <span data-ttu-id="cbdc5-187">Açıkça bir apartman modeli seçme ile ilgili yönergeler için bkz: [yönetilen ve yönetilmeyen iş parçacığı oluşturma](http://msdn.microsoft.com/library/db425c20-4b2f-4433-bf96-76071c7881e5).</span><span class="sxs-lookup"><span data-stu-id="cbdc5-187">For instructions on explicitly selecting an apartment model, see [Managed and Unmanaged Threading](http://msdn.microsoft.com/library/db425c20-4b2f-4433-bf96-76071c7881e5).</span></span>  
  
 [<span data-ttu-id="cbdc5-188">Başa dön</span><span class="sxs-lookup"><span data-stu-id="cbdc5-188">Back to top</span></span>](#top)  
  
<a name="marshaling_remote_calls"></a>   
## <a name="marshaling-remote-calls"></a><span data-ttu-id="cbdc5-189">Uzak çağrılar hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-189">Marshaling Remote Calls</span></span>  
 <span data-ttu-id="cbdc5-190">Çapraz Grup gibi hazırlama ile COM hazırlama arasında nesneleri ayrı işlemlerde bulunan her yönetilen ve yönetilmeyen kodu her çağrıda katıldı.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-190">As with cross-apartment marshaling, COM marshaling is involved in each call between managed and unmanaged code whenever the objects reside in separate processes.</span></span> <span data-ttu-id="cbdc5-191">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="cbdc5-191">For example:</span></span>  
  
-   <span data-ttu-id="cbdc5-192">Uzak bir ana bilgisayarı yönetilen bir sunucuda çağıran COM istemci Dağıtılmış COM (DCOM) kullanır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-192">A COM client that invokes a managed server on a remote host uses distributed COM (DCOM).</span></span>  
  
-   <span data-ttu-id="cbdc5-193">Uzak bir ana bilgisayar üzerindeki COM sunucusu çağırır yönetilen bir istemci DCOM kullanır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-193">A managed client that invokes a COM server on a remote host uses DCOM.</span></span>  
  
 <span data-ttu-id="cbdc5-194">Nasıl birlikte çalışma hazırlama aşağıda gösterilmiştir ve COM hazırlama, işlem ve ana bilgisayar sınırlarındaki iletişim kanalı sağlayın.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-194">The following illustration shows how interop marshaling and COM marshaling provide communications channels across process and host boundaries.</span></span>  
  
 <span data-ttu-id="cbdc5-195">![COM hazırlama](../../../docs/framework/interop/media/interophost.gif "interophost")</span><span class="sxs-lookup"><span data-stu-id="cbdc5-195">![COM marshaling](../../../docs/framework/interop/media/interophost.gif "interophost")</span></span>  
<span data-ttu-id="cbdc5-196">Çapraz işlem hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-196">Cross-process marshaling</span></span>  
  
### <a name="preserving-identity"></a><span data-ttu-id="cbdc5-197">Kimlik koruma</span><span class="sxs-lookup"><span data-stu-id="cbdc5-197">Preserving Identity</span></span>  
 <span data-ttu-id="cbdc5-198">Ortak dil çalışma zamanı yönetilen ve yönetilmeyen başvuruları kimliğini korur.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-198">The common language runtime preserves the identity of managed and unmanaged references.</span></span> <span data-ttu-id="cbdc5-199">Aşağıdaki çizimde, işlem ve ana bilgisayar sınırlarındaki doğrudan yönetilmeyen başvurular (üst satır) ve doğrudan yönetilen başvuru (alt satır) akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-199">The following illustration shows the flow of direct unmanaged references (top row) and direct managed references (bottom row) across process and host boundaries.</span></span>  
  
 <span data-ttu-id="cbdc5-200">![COM aranabilir sarmalayıcısı ve çalışma zamanı aranabilir sarmalayıcısı](../../../docs/framework/interop/media/interopdirectref.gif "interopdirectref")</span><span class="sxs-lookup"><span data-stu-id="cbdc5-200">![COM callable wrapper and runtime callable wrapper](../../../docs/framework/interop/media/interopdirectref.gif "interopdirectref")</span></span>  
<span data-ttu-id="cbdc5-201">İşlem ve ana bilgisayar sınırlarından geçirirken başvurusu</span><span class="sxs-lookup"><span data-stu-id="cbdc5-201">Reference passing across process and host boundaries</span></span>  
  
 <span data-ttu-id="cbdc5-202">Bu çizimde:</span><span class="sxs-lookup"><span data-stu-id="cbdc5-202">In this illustration:</span></span>  
  
-   <span data-ttu-id="cbdc5-203">Yönetilmeyen istemci uzak bir ana bilgisayardan bu başvuruyu alır yönetilen bir nesnenin bir COM nesnesi için bir başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-203">An unmanaged client gets a reference to a COM object from a managed object that gets this reference from a remote host.</span></span> <span data-ttu-id="cbdc5-204">DCOM Uzaktan iletişim mekanizmasıdır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-204">The remoting mechanism is DCOM.</span></span>  
  
-   <span data-ttu-id="cbdc5-205">Yönetilen bir istemci uzak bir ana bilgisayardan bu başvuruyu alır bir COM nesnesi yönetilen bir nesne için bir başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-205">A managed client gets a reference to a managed object from a COM object that gets this reference from a remote host.</span></span> <span data-ttu-id="cbdc5-206">DCOM Uzaktan iletişim mekanizmasıdır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-206">The remoting mechanism is DCOM.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="cbdc5-207">Verilen tür kitaplığı yönetilen sunucunun kayıtlı olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-207">The exported type library of the managed server must be registered.</span></span>  
  
 <span data-ttu-id="cbdc5-208">Çağıran ve çağrılan arasındaki işlem sınırları ilgisiz sayısıdır; aynı doğrudan başvuran işlemdeki ve işlem dışı çağrıları için oluşur.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-208">The number of process boundaries between caller and callee is irrelevant; the same direct referencing occurs for in-process and out-of-process calls.</span></span>  
  
### <a name="managed-remoting"></a><span data-ttu-id="cbdc5-209">Yönetilen uzaktan iletişim</span><span class="sxs-lookup"><span data-stu-id="cbdc5-209">Managed Remoting</span></span>  
 <span data-ttu-id="cbdc5-210">Çalışma zamanı, işlem ve ana bilgisayar sınırları yönetilen nesneler arasında bir iletişim kanalı oluşturmak için kullanabileceğiniz yönetilen remoting de sağlar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-210">The runtime also provides managed remoting, which you can use to establish a communications channel between managed objects across process and host boundaries.</span></span> <span data-ttu-id="cbdc5-211">Yönetilen remoting aşağıdaki çizimde gösterildiği gibi iletişim kuran bileşenleri arasında bir güvenlik duvarı barındırabilir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-211">Managed remoting can accommodate a firewall between the communicating components, as the following illustration shows.</span></span>  
  
 <span data-ttu-id="cbdc5-212">![SOAP veya TcpChannel](../../../docs/framework/interop/media/interopremotesoap.gif "interopremotesoap")</span><span class="sxs-lookup"><span data-stu-id="cbdc5-212">![SOAP or TcpChannel](../../../docs/framework/interop/media/interopremotesoap.gif "interopremotesoap")</span></span>  
<span data-ttu-id="cbdc5-213">Güvenlik duvarları SOAP veya TcpChannel sınıfı kullanarak uzak çağrılar</span><span class="sxs-lookup"><span data-stu-id="cbdc5-213">Remote calls across firewalls using SOAP or the TcpChannel class</span></span>  
  
 <span data-ttu-id="cbdc5-214">Yönetilmeyen bazı çağrıları SOAP arasındaki çağrıları gibi channeled [bileşenleri hizmet](http://msdn.microsoft.com/library/f109ee24-81ad-4d99-9892-51ac6f34978c) ve COM</span><span class="sxs-lookup"><span data-stu-id="cbdc5-214">Some unmanaged calls can be channeled through SOAP, such as the calls between [serviced components](http://msdn.microsoft.com/library/f109ee24-81ad-4d99-9892-51ac6f34978c) and COM.</span></span>  
  
 [<span data-ttu-id="cbdc5-215">Başa dön</span><span class="sxs-lookup"><span data-stu-id="cbdc5-215">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="cbdc5-216">İlgili Konular</span><span class="sxs-lookup"><span data-stu-id="cbdc5-216">Related Topics</span></span>  
  
|<span data-ttu-id="cbdc5-217">Başlık</span><span class="sxs-lookup"><span data-stu-id="cbdc5-217">Title</span></span>|<span data-ttu-id="cbdc5-218">Açıklama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-218">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="cbdc5-219">Varsayılan Hazırlama Davranışı</span><span class="sxs-lookup"><span data-stu-id="cbdc5-219">Default Marshaling Behavior</span></span>](../../../docs/framework/interop/default-marshaling-behavior.md)|<span data-ttu-id="cbdc5-220">Birlikte çalışma hazırlama hizmetinin verileri hazırlamak için kullandığı kurallar açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-220">Describes the rules that the interop marshaling service uses to marshal data.</span></span>|  
|[<span data-ttu-id="cbdc5-221">Platform Çağırma ile Veri Hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-221">Marshaling Data with Platform Invoke</span></span>](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)|<span data-ttu-id="cbdc5-222">Yöntem parametreleri bildirme ve yönetilmeyen kitaplıkları tarafından dışarı aktarılan işlevler için bağımsız değişkenler geçirmek açıklar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-222">Describes how to declare method parameters and pass arguments to functions exported by unmanaged libraries.</span></span>|  
|[<span data-ttu-id="cbdc5-223">COM Birlikte Çalışma ile Verileri Hazırlama</span><span class="sxs-lookup"><span data-stu-id="cbdc5-223">Marshaling Data with COM Interop</span></span>](../../../docs/framework/interop/marshaling-data-with-com-interop.md)|<span data-ttu-id="cbdc5-224">Hazırlama davranışı değiştirmek için COM sarmalayıcıları özelleştirmeyi açıklar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-224">Describes how to customize COM wrappers to alter marshaling behavior.</span></span>|  
|[<span data-ttu-id="cbdc5-225">Nasıl yapılır: Yönetilen Kodu DCOM’dan WCF’ye Geçirme</span><span class="sxs-lookup"><span data-stu-id="cbdc5-225">How to: Migrate Managed-Code DCOM to WCF</span></span>](../../../docs/framework/interop/how-to-migrate-managed-code-dcom-to-wcf.md)|<span data-ttu-id="cbdc5-226">DCOM'dan WCF'ye geçirme açıklar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-226">Describes how to migrate from DCOM to WCF.</span></span>|  
|[<span data-ttu-id="cbdc5-227">Nasıl yapılır: HRESULTs ve Özel Durumları Eşleme</span><span class="sxs-lookup"><span data-stu-id="cbdc5-227">How to: Map HRESULTs and Exceptions</span></span>](../../../docs/framework/interop/how-to-map-hresults-and-exceptions.md)|<span data-ttu-id="cbdc5-228">HRESULTs için özel durumları eşleme açıklar ve .NET Framework kendi karşılaştırılabilir özel durum sınıfına her HRESULT tam eşleme sağlar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-228">Describes how to map custom exceptions to HRESULTs and provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.</span></span>|  
|[<span data-ttu-id="cbdc5-229">Genel türler kullanma birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="cbdc5-229">Interoperating Using Generic Types</span></span>](http://msdn.microsoft.com/library/26b88e03-085b-4b53-94ba-a5a9c709ce58)|<span data-ttu-id="cbdc5-230">Genel türler COM birlikte çalışabilirlik için kullanılırken hangi eylemleri desteklenen açıklar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-230">Describes which actions are supported when using generic types for COM interoperability.</span></span>|  
|[<span data-ttu-id="cbdc5-231">Yönetilmeyen Kod ile Birlikte Çalışma</span><span class="sxs-lookup"><span data-stu-id="cbdc5-231">Interoperating with Unmanaged Code</span></span>](../../../docs/framework/interop/index.md)|<span data-ttu-id="cbdc5-232">Ortak dil çalışma zamanı tarafından sağlanan birlikte çalışabilirlik hizmetlerini açıklar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-232">Describes interoperability services provided by the common language runtime.</span></span>|  
|[<span data-ttu-id="cbdc5-233">Gelişmiş COM birlikte çalışabilirliği</span><span class="sxs-lookup"><span data-stu-id="cbdc5-233">Advanced COM Interoperability</span></span>](http://msdn.microsoft.com/library/3ada36e5-2390-4d70-b490-6ad8de92f2fb)|<span data-ttu-id="cbdc5-234">COM bileşenlerini .NET Framework uygulamasına ekleme hakkında daha fazla bilgi için bağlantılar sağlar.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-234">Provides links to more information about incorporating COM components into your .NET Framework application.</span></span>|  
|[<span data-ttu-id="cbdc5-235">Birlikte çalışma için tasarım konuları</span><span class="sxs-lookup"><span data-stu-id="cbdc5-235">Design Considerations for Interoperation</span></span>](http://msdn.microsoft.com/library/b59637f6-fe35-40d6-ae72-901e7a707689)|<span data-ttu-id="cbdc5-236">Tümleşik COM bileşenlerini yazmak için ipuçları verilmektedir.</span><span class="sxs-lookup"><span data-stu-id="cbdc5-236">Provides tips for writing integrated COM components.</span></span>|  
  
 [<span data-ttu-id="cbdc5-237">Başa dön</span><span class="sxs-lookup"><span data-stu-id="cbdc5-237">Back to top</span></span>](#top)  
  
<a name="reference"></a>   
## <a name="reference"></a><span data-ttu-id="cbdc5-238">Başvuru</span><span class="sxs-lookup"><span data-stu-id="cbdc5-238">Reference</span></span>  
 <xref:System.Runtime.InteropServices?displayProperty=nameWithType>  
  
 [<span data-ttu-id="cbdc5-239">Başa dön</span><span class="sxs-lookup"><span data-stu-id="cbdc5-239">Back to top</span></span>](#top)
