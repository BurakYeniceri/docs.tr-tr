---
title: Bir Hizmetin Kimliğini Kimlik Doğrulama için Geçersiz Kılma
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: d613a22b-07d7-41a4-bada-1adc653b9b5d
ms.openlocfilehash: 3df1f2490f8636d52ac75fad2469adadec2a57da
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/07/2018
ms.locfileid: "33806948"
---
# <a name="overriding-the-identity-of-a-service-for-authentication"></a><span data-ttu-id="f02c3-102">Bir Hizmetin Kimliğini Kimlik Doğrulama için Geçersiz Kılma</span><span class="sxs-lookup"><span data-stu-id="f02c3-102">Overriding the Identity of a Service for Authentication</span></span>
<span data-ttu-id="f02c3-103">Genellikle, bir istemci kimlik bilgisi türü seçimi hizmet metaveri kimliği türü belirler olduğu bir hizmette kimlik Ayarla gerekmez.</span><span class="sxs-lookup"><span data-stu-id="f02c3-103">Typically, you do not have to set the identity on a service because the selection of a client credential type dictates the type of identity exposed in the service metadata.</span></span> <span data-ttu-id="f02c3-104">Örneğin, aşağıdaki yapılandırma kodunu kullanan [ \<wsHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) öğesi ve kümelerini `clientCredentialType` özniteliği Windows.</span><span class="sxs-lookup"><span data-stu-id="f02c3-104">For example, the following configuration code uses the [\<wsHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wshttpbinding.md) element and sets the `clientCredentialType` attribute to Windows.</span></span>  
  
  
  
 <span data-ttu-id="f02c3-105">Aşağıdaki Web Hizmetleri Açıklama Dili (WSDL) parça kimliği önceden tanımlanmış uç nokta için gösterir.</span><span class="sxs-lookup"><span data-stu-id="f02c3-105">The following Web Services Description Language (WSDL) fragment shows the identity for the endpoint previously defined.</span></span> <span data-ttu-id="f02c3-106">Bu örnekte, belirli bir kullanıcı hesabının altında kendini barındıran hizmet hizmetinin çalıştığı (username@contoso.com) ve bu nedenle kullanıcı asıl adı (UPN) kimlik hesap adını içerir.</span><span class="sxs-lookup"><span data-stu-id="f02c3-106">In this example, the service is running as a self-hosted service under a particular user account (username@contoso.com) and therefore the user principal name (UPN) identity contains the account name.</span></span> <span data-ttu-id="f02c3-107">UPN bir Windows etki alanındaki kullanıcı oturum açma adı da denir.</span><span class="sxs-lookup"><span data-stu-id="f02c3-107">The UPN is also known as the user logon name in a Windows domain.</span></span>  
  
  
  
 <span data-ttu-id="f02c3-108">Kimlik ayarı gösteren örnek bir uygulama için bkz: [hizmet kimliği örneği](../../../../docs/framework/wcf/samples/service-identity-sample.md).</span><span class="sxs-lookup"><span data-stu-id="f02c3-108">For a sample application that demonstrates identity setting, see [Service Identity Sample](../../../../docs/framework/wcf/samples/service-identity-sample.md).</span></span> <span data-ttu-id="f02c3-109">Hizmet kimliği hakkında daha fazla bilgi için bkz: [hizmet kimliği ve kimlik doğrulama](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="f02c3-109">For more information about service identity, see [Service Identity and Authentication](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span></span>  
  
## <a name="kerberos-authentication-and-identity"></a><span data-ttu-id="f02c3-110">Kerberos kimlik doğrulaması ve kimlik</span><span class="sxs-lookup"><span data-stu-id="f02c3-110">Kerberos Authentication and Identity</span></span>  
 <span data-ttu-id="f02c3-111">Bir hizmeti bir Windows kimlik bilgisi kullanmak için yapılandırıldığında varsayılan olarak, bir [ \<kimliği >](../../../../docs/framework/configure-apps/file-schema/wcf/identity.md) içeren öğe bir [ \<userPrincipalName >](../../../../docs/framework/configure-apps/file-schema/wcf/userprincipalname.md) veya [ \<servicePrincipalName >](../../../../docs/framework/configure-apps/file-schema/wcf/serviceprincipalname.md) öğesi WSDL içinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="f02c3-111">By default, when a service is configured to use a Windows credential, an [\<identity>](../../../../docs/framework/configure-apps/file-schema/wcf/identity.md) element that contains a [\<userPrincipalName>](../../../../docs/framework/configure-apps/file-schema/wcf/userprincipalname.md) or [\<servicePrincipalName>](../../../../docs/framework/configure-apps/file-schema/wcf/serviceprincipalname.md) element is generated in the WSDL.</span></span> <span data-ttu-id="f02c3-112">Hizmet altında çalışıyorsa, `LocalSystem`, `LocalService`, veya `NetworkService` hesabı, bir hizmet asıl adı (SPN) biçiminde varsayılan oluşturulur `host/` \< *ana bilgisayar adı*> için Bu hesaplar bilgisayarın SPN veri erişimi.</span><span class="sxs-lookup"><span data-stu-id="f02c3-112">If the service is running under the `LocalSystem`, `LocalService`, or `NetworkService` account, a service principal name (SPN) is generated by default in the form of `host/`\<*hostname*> because those accounts have access to the computer's SPN data.</span></span> <span data-ttu-id="f02c3-113">Windows Communication Foundation (WCF) hizmetini başka bir hesap altında çalışıyorsa, UPN biçiminde oluşturur. \< *kullanıcıadı*>@<*domainName* `>` .</span><span class="sxs-lookup"><span data-stu-id="f02c3-113">If the service is running under a different account, Windows Communication Foundation (WCF) generates a UPN in the form of \<*username*>@<*domainName*`>`.</span></span> <span data-ttu-id="f02c3-114">Bu durum, UPN veya SPN bir hizmetin kimliğini istemciye sağlanması Kerberos kimlik doğrulaması gerektiren kaynaklanır.</span><span class="sxs-lookup"><span data-stu-id="f02c3-114">This occurs because Kerberos authentication requires that a UPN or SPN be supplied to the client to authenticate the service.</span></span>  
  
 <span data-ttu-id="f02c3-115">Bir hizmetin hesabının bir etki alanındaki ek bir SPN kaydolmak için Setspn.exe Aracı'nı da kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f02c3-115">You can also use the Setspn.exe tool to register an additional SPN with a service's account in a domain.</span></span> <span data-ttu-id="f02c3-116">Bu gibi durumlarda, SPN sonra hizmet kimliği olarak kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f02c3-116">You can then use the SPN as the identity of the service.</span></span> <span data-ttu-id="f02c3-117">Aracı indirmek için bkz: [Windows 2000 Kaynak Seti aracı: Setspn.exe](http://go.microsoft.com/fwlink/?LinkId=91752).</span><span class="sxs-lookup"><span data-stu-id="f02c3-117">To download the tool, see [Windows 2000 Resource Kit Tool : Setspn.exe](http://go.microsoft.com/fwlink/?LinkId=91752).</span></span> <span data-ttu-id="f02c3-118">Aracı hakkında daha fazla bilgi için bkz: [setspn aracına genel bakış](http://go.microsoft.com/fwlink/?LinkId=61374).</span><span class="sxs-lookup"><span data-stu-id="f02c3-118">For more information about the tool, see [Setspn Overview](http://go.microsoft.com/fwlink/?LinkId=61374).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f02c3-119">Windows kimlik bilgisi türü anlaşma olmadan kullanmak için hizmetin kullanıcı hesabının Active Directory etki alanı ile kayıtlı SPN erişiminiz olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="f02c3-119">To use the Windows credential type without negotiation, the service's user account must have access to the SPN that is registered with the Active Directory domain.</span></span> <span data-ttu-id="f02c3-120">Bunu aşağıdaki yöntemlerle yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="f02c3-120">You can do this in the following ways:</span></span>  
  
-   <span data-ttu-id="f02c3-121">NetworkService veya LocalSystem hesabı, hizmetinizi çalıştırmak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="f02c3-121">Use the NetworkService or LocalSystem account to run your service.</span></span> <span data-ttu-id="f02c3-122">Bu hesapların makine Active Directory etki alanına katıldığında, kurulur SPN makine erişiminiz olduğundan WCF uygun SPN öğe içinde hizmet uç noktası hizmetin meta veriler (WSDL) otomatik olarak oluşturur.</span><span class="sxs-lookup"><span data-stu-id="f02c3-122">Because those accounts have access to the machine SPN that is established when the machine joins the Active Directory domain, WCF automatically generates the proper SPN element inside the service's endpoint in the service's metadata (WSDL).</span></span>  
  
-   <span data-ttu-id="f02c3-123">Hizmetinizi çalıştırmak için rasgele bir Active Directory etki alanı hesabı kullanın.</span><span class="sxs-lookup"><span data-stu-id="f02c3-123">Use an arbitrary Active Directory domain account to run your service.</span></span> <span data-ttu-id="f02c3-124">Bu durumda, Setspn.exe yardımcı programı aracını kullanarak yapabilirsiniz, etki alanı hesabı için bir SPN kurun.</span><span class="sxs-lookup"><span data-stu-id="f02c3-124">In this case, establish an SPN for that domain account, which you can do by using the Setspn.exe utility tool.</span></span> <span data-ttu-id="f02c3-125">Hizmet hesabı için SPN oluşturduğunuzda, bu SPN hizmetin istemcileri meta verilerini (WSDL) aracılığıyla yayımlamak için WCF yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="f02c3-125">Once you create the SPN for the service's account, configure WCF to publish that SPN to the service's clients through its metadata (WSDL).</span></span> <span data-ttu-id="f02c3-126">Bu uç noktası kimlik gösterilen uç noktası için bir uygulama yapılandırma dosyası veya kod aracılığıyla ya da ayarlayarak yapılır.</span><span class="sxs-lookup"><span data-stu-id="f02c3-126">This is done by setting the endpoint identity for the exposed endpoint, either through an application configuration file or code.</span></span>  
  
 <span data-ttu-id="f02c3-127">SPN'ler hakkında daha fazla bilgi, Kerberos protokolü ve Active Directory için bkz: [Kerberos teknik Eki'ni Windows için](http://go.microsoft.com/fwlink/?LinkId=88330).</span><span class="sxs-lookup"><span data-stu-id="f02c3-127">For more information about SPNs, the Kerberos protocol, and Active Directory, see [Kerberos Technical Supplement for Windows](http://go.microsoft.com/fwlink/?LinkId=88330).</span></span>  
  
### <a name="when-spn-or-upn-equals-the-empty-string"></a><span data-ttu-id="f02c3-128">Ne zaman boş dize SPN veya UPN'e eşittir</span><span class="sxs-lookup"><span data-stu-id="f02c3-128">When SPN or UPN Equals the Empty String</span></span>  
 <span data-ttu-id="f02c3-129">SPN veya UPN boş bir dize eşit ayarlarsanız birkaç farklı işlemler, kullanılan güvenlik düzeyini ve kimlik doğrulama modu bağlı olarak gerçekleşir:</span><span class="sxs-lookup"><span data-stu-id="f02c3-129">If you set the SPN or UPN equal to an empty string, a number of different things happen, depending on the security level and authentication mode being used:</span></span>  
  
-   <span data-ttu-id="f02c3-130">Aktarım düzeyi güvenlik kullanıyorsanız, NT LanMan (NTLM) kimlik doğrulamasını seçilir.</span><span class="sxs-lookup"><span data-stu-id="f02c3-130">If you are using transport level security, NT LanMan (NTLM) authentication is chosen.</span></span>  
  
-   <span data-ttu-id="f02c3-131">İleti düzeyi güvenlik kullanıyorsanız, kimlik doğrulaması, kimlik doğrulama modu bağlı olarak başarısız olabilir:</span><span class="sxs-lookup"><span data-stu-id="f02c3-131">If you are using message level security, authentication may fail, depending on the authentication mode:</span></span>  
  
-   <span data-ttu-id="f02c3-132">Kullanıyorsanız `spnego` modu ve `AllowNtlm` özniteliği `false`, kimlik doğrulama başarısız.</span><span class="sxs-lookup"><span data-stu-id="f02c3-132">If you are using `spnego` mode and the `AllowNtlm` attribute is set to `false`, authentication fail.</span></span>  
  
-   <span data-ttu-id="f02c3-133">Kullanıyorsanız `spnego` modu ve `AllowNtlm` özniteliği `true`, UPN boş ancak SPN boşsa, başarılı kimlik doğrulaması başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="f02c3-133">If you are using `spnego` mode and the `AllowNtlm` attribute is set to `true`, authentication fails if the UPN is empty, but succeeds if the SPN is empty.</span></span>  
  
-   <span data-ttu-id="f02c3-134">Kullanıyorsanız Kerberos doğrudan (olarak da bilinen "tek adımda"), kimlik doğrulaması başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="f02c3-134">If you are using Kerberos direct (also known as "one-shot"), authentication fails.</span></span>  
  
### <a name="using-the-identity-element-in-configuration"></a><span data-ttu-id="f02c3-135">Kullanarak \<kimliği > yapılandırma öğesi</span><span class="sxs-lookup"><span data-stu-id="f02c3-135">Using the \<identity> Element in Configuration</span></span>  
 <span data-ttu-id="f02c3-136">Sertifika için daha önce gösterilen bağlamadaki istemci kimlik bilgisi türü değiştirirseniz`,` oluşturulan WSDL seri hale getirilmiş bir Base64 içeriyorsa aşağıdaki kodda gösterildiği gibi kimlik değeri X.509 sertifikası.</span><span class="sxs-lookup"><span data-stu-id="f02c3-136">If you change the client credential type in the binding previously shown to Certificate`,` then the generated WSDL contains a Base64 serialized X.509 certificate for the identity value as shown in the following code.</span></span> <span data-ttu-id="f02c3-137">Bu Windows dışındaki tüm istemci kimlik bilgisi türü için varsayılan değerdir.</span><span class="sxs-lookup"><span data-stu-id="f02c3-137">This is the default for all client credential types other than Windows.</span></span>  
  
  
  
 <span data-ttu-id="f02c3-138">Varsayılan hizmet kimliği değerini değiştirin ya da kullanarak kimliği türü değiştirme <`identity`> öğesi yapılandırmasında veya kodda kimliği ayarlayarak.</span><span class="sxs-lookup"><span data-stu-id="f02c3-138">You can change the value of the default service identity or change the type of the identity by using the <`identity`> element in configuration or by setting the identity in code.</span></span> <span data-ttu-id="f02c3-139">Bir etki alanı adı sistemi (DNS) kimlik değeri olan aşağıdaki yapılandırma kodunu ayarlar `contoso.com`.</span><span class="sxs-lookup"><span data-stu-id="f02c3-139">The following configuration code sets a domain name system (DNS) identity with the value `contoso.com`.</span></span>  
  
  
  
### <a name="setting-identity-programmatically"></a><span data-ttu-id="f02c3-140">Kimlik programlı olarak ayarlama</span><span class="sxs-lookup"><span data-stu-id="f02c3-140">Setting Identity Programmatically</span></span>  
 <span data-ttu-id="f02c3-141">WCF formu otomatik olarak belirlediğinden hizmetiniz bir kimlik açıkça belirtmek yok.</span><span class="sxs-lookup"><span data-stu-id="f02c3-141">Your service does not have to explicitly specify an identity, because WCF automatically determines it.</span></span> <span data-ttu-id="f02c3-142">Ancak, WCF bir noktadaki bir kimlik belirtmek gerekirse sağlar.</span><span class="sxs-lookup"><span data-stu-id="f02c3-142">However, WCF allows you to specify an identity on an endpoint, if required.</span></span> <span data-ttu-id="f02c3-143">Aşağıdaki kod, belirli bir DNS kimlik ile yeni bir hizmet uç noktası ekler.</span><span class="sxs-lookup"><span data-stu-id="f02c3-143">The following code adds a new service endpoint with a specific DNS identity.</span></span>  
  
 [!code-csharp[C_Identity#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#5)]
 [!code-vb[C_Identity#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#5)]  
  
## <a name="see-also"></a><span data-ttu-id="f02c3-144">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="f02c3-144">See Also</span></span>  
 [<span data-ttu-id="f02c3-145">Nasıl yapılır: Özel İstemci Kimliği Doğrulayıcı Oluşturma</span><span class="sxs-lookup"><span data-stu-id="f02c3-145">How to: Create a Custom Client Identity Verifier</span></span>](../../../../docs/framework/wcf/extending/how-to-create-a-custom-client-identity-verifier.md)  
 [<span data-ttu-id="f02c3-146">Kimlik Doğrulama ile Hizmet Kimliği</span><span class="sxs-lookup"><span data-stu-id="f02c3-146">Service Identity and Authentication</span></span>](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)
