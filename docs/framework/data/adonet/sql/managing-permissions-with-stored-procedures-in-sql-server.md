---
title: "Saklı yordamlar SQL Server'daki izinlerle yönetme"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 08fa34e8-2ffa-470d-ba62-e511a5f8558e
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 58129cf690d4d46cda1e59671ae1423b8a64163f
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/22/2017
---
# <a name="managing-permissions-with-stored-procedures-in-sql-server"></a><span data-ttu-id="51fcd-102">Saklı yordamlar SQL Server'daki izinlerle yönetme</span><span class="sxs-lookup"><span data-stu-id="51fcd-102">Managing Permissions with Stored Procedures in SQL Server</span></span>
<span data-ttu-id="51fcd-103">Veritabanınızı geçici savunma çok satırlı oluşturma yöntemi, saklı yordam veya kullanıcı tanımlı işlevler kullanarak tüm veri erişim uygulamaktır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-103">One method of creating multiple lines of defense around your database is to implement all data access using stored procedures or user-defined functions.</span></span> <span data-ttu-id="51fcd-104">Tablolar gibi temel nesneler için tüm izinleri reddetme iptal etme ve saklı yordamlar Yürütme izinleri.</span><span class="sxs-lookup"><span data-stu-id="51fcd-104">You revoke or deny all permissions to underlying objects, such as tables, and grant EXECUTE permissions on stored procedures.</span></span> <span data-ttu-id="51fcd-105">Bu etkin bir güvenlik çevre geçici verileri ve veritabanı nesnelerini oluşturur.</span><span class="sxs-lookup"><span data-stu-id="51fcd-105">This effectively creates a security perimeter around your data and database objects.</span></span>  
  
## <a name="stored-procedure-benefits"></a><span data-ttu-id="51fcd-106">Saklı yordam avantajları</span><span class="sxs-lookup"><span data-stu-id="51fcd-106">Stored Procedure Benefits</span></span>  
 <span data-ttu-id="51fcd-107">Saklı yordamlar aşağıdaki avantajlara sahiptir:</span><span class="sxs-lookup"><span data-stu-id="51fcd-107">Stored procedures have the following benefits:</span></span>  
  
-   <span data-ttu-id="51fcd-108">Kullanıcıların veri ve nesneleri geliştiricilerinin ve veritabanı yöneticilerinin amaçladığınız şekilde erişebilmesi için veri mantığı ve iş kuralları kapsüllenmiş.</span><span class="sxs-lookup"><span data-stu-id="51fcd-108">Data logic and business rules can be encapsulated so that users can access data and objects only in ways that developers and database administrators intend.</span></span>  
  
-   <span data-ttu-id="51fcd-109">Tüm kullanıcı girişi doğrulama parametreli saklı yordamlar SQL ekleme saldırıları engel olmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-109">Parameterized stored procedures that validate all user input can be used to thwart SQL injection attacks.</span></span> <span data-ttu-id="51fcd-110">Dinamik SQL kullanırsanız, komutlarınızı Parametreleştirme emin olun ve hiçbir zaman doğrudan bir sorgu dizesi parametre değerlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-110">If you use dynamic SQL, be sure to parameterize your commands, and never include parameter values directly into a query string.</span></span>  
  
-   <span data-ttu-id="51fcd-111">Geçici sorgular ve veri değişiklikleri izin verilmeyen.</span><span class="sxs-lookup"><span data-stu-id="51fcd-111">Ad hoc queries and data modifications can be disallowed.</span></span> <span data-ttu-id="51fcd-112">Bu, kullanıcıların kötü amaçlı olarak veya yanlışlıkla veri yok etme veya sunucu veya ağ performansına bozacak sorguları yürütme engeller.</span><span class="sxs-lookup"><span data-stu-id="51fcd-112">This prevents users from maliciously or inadvertently destroying data or executing queries that impair performance on the server or the network.</span></span>  
  
-   <span data-ttu-id="51fcd-113">Hataları doğrudan istemci uygulamaları için geçirilen olmadan yordamı kodda işlenebilir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-113">Errors can be handled in procedure code without being passed directly to client applications.</span></span> <span data-ttu-id="51fcd-114">Bu, hata iletileri yoklama saldırısında yardımcı döndürülmesini engeller.</span><span class="sxs-lookup"><span data-stu-id="51fcd-114">This prevents error messages from being returned that could aid in a probing attack.</span></span> <span data-ttu-id="51fcd-115">Hataları günlüğe kaydetmek ve sunucu üzerinde tanıtıcı.</span><span class="sxs-lookup"><span data-stu-id="51fcd-115">Log errors and handle them on the server.</span></span>  
  
-   <span data-ttu-id="51fcd-116">Saklı yordamlar kez yazılmış ve birçok uygulamalar tarafından erişilen.</span><span class="sxs-lookup"><span data-stu-id="51fcd-116">Stored procedures can be written once, and accessed by many applications.</span></span>  
  
-   <span data-ttu-id="51fcd-117">İstemci uygulamaları temel alınan veri yapılarını hakkında hiçbir şey bilmeniz gerek yoktur.</span><span class="sxs-lookup"><span data-stu-id="51fcd-117">Client applications do not need to know anything about the underlying data structures.</span></span> <span data-ttu-id="51fcd-118">Saklı yordam kod değişiklikleri parametre listeleri etkilemez sürece istemci uygulamalarında değişiklik gerek kalmadan değiştirilemez veya veri türleri döndürüldü.</span><span class="sxs-lookup"><span data-stu-id="51fcd-118">Stored procedure code can be changed without requiring changes in client applications as long as the changes do not affect parameter lists or returned data types.</span></span>  
  
-   <span data-ttu-id="51fcd-119">Saklı yordamlar, bir yordam çağrısı birden çok işleme birleştirerek ağ trafiğini azaltabilir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-119">Stored procedures can reduce network traffic by combining multiple operations into one procedure call.</span></span>  
  
## <a name="stored-procedure-execution"></a><span data-ttu-id="51fcd-120">Saklı yordam yürütme</span><span class="sxs-lookup"><span data-stu-id="51fcd-120">Stored Procedure Execution</span></span>  
 <span data-ttu-id="51fcd-121">Böylece kullanıcılar, açık veritabanı nesnelerini erişim iznine sahip gerekmez. veri erişim sağlamak için zincirleme sahipliği yordamları yararlanma depolanır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-121">Stored procedures take advantage of ownership chaining to provide access to data so that users do not need to have explicit permission to access database objects.</span></span> <span data-ttu-id="51fcd-122">Birbirine sırayla erişim nesneler aynı kullanıcı tarafından sahip olunan bir sahiplik zinciri bulunmaktadır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-122">An ownership chain exists when objects that access each other sequentially are owned by the same user.</span></span> <span data-ttu-id="51fcd-123">Örneğin, bir saklı yordam diğer saklı yordamları çağırabilir veya saklı yordam birden çok tablo erişebilir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-123">For example, a stored procedure can call other stored procedures, or a stored procedure can access multiple tables.</span></span> <span data-ttu-id="51fcd-124">Yürütme zincirindeki tüm nesnelerin aynı sahip sonra SQL Server, çağıran EXECUTE izni yalnızca denetler olmayan diğer nesneleri arayanın izinleri.</span><span class="sxs-lookup"><span data-stu-id="51fcd-124">If all objects in the chain of execution have the same owner, then SQL Server only checks the EXECUTE permission for the caller, not the caller's permissions on other objects.</span></span> <span data-ttu-id="51fcd-125">Bu nedenle yalnızca saklı yordam Yürütme izinleri vermeniz gerekir; iptal etmek veya arka plandaki tablolar üzerindeki tüm izinleri reddetme.</span><span class="sxs-lookup"><span data-stu-id="51fcd-125">Therefore you need to grant only EXECUTE permissions on stored procedures; you can revoke or deny all permissions on the underlying tables.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="51fcd-126">En İyi Yöntemler</span><span class="sxs-lookup"><span data-stu-id="51fcd-126">Best Practices</span></span>  
 <span data-ttu-id="51fcd-127">Saklı yordamlar yalnızca yazma yeterli uygulamanızın güvenliğini sağlamak için yeterli değildir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-127">Simply writing stored procedures isn't enough to adequately secure your application.</span></span> <span data-ttu-id="51fcd-128">Ayrıca, aşağıdaki olası güvenlik açıklarını düşünmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-128">You should also consider the following potential security holes.</span></span>  
  
-   <span data-ttu-id="51fcd-129">Saklı yordamlar verilerine erişebilir olmasını istediğiniz veritabanı rolleri için yürütme izinlerini verin.</span><span class="sxs-lookup"><span data-stu-id="51fcd-129">Grant EXECUTE permissions on the stored procedures for database roles you want to be able to access the data.</span></span>  
  
-   <span data-ttu-id="51fcd-130">İptal etmek veya tüm rolleri ve kullanıcılar veritabanında temel alınan tablolara tüm izinleri reddetme dahil olmak üzere `public` rol.</span><span class="sxs-lookup"><span data-stu-id="51fcd-130">Revoke or deny all permissions to the underlying tables for all roles and users in the database, including the `public` role.</span></span> <span data-ttu-id="51fcd-131">Tüm kullanıcıların izinleri gelen ortak devralır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-131">All users inherit permissions from public.</span></span> <span data-ttu-id="51fcd-132">Bu nedenle izinleri reddetme `public` anlamına gelir, yalnızca sahipleri ve `sysadmin` üyeleri erişimi vardır; diğer tüm kullanıcıların diğer rollerdeki üyeliğinin devralmak mümkün olmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-132">Therefore denying permissions to `public` means that only owners and `sysadmin` members have access; all other users will be unable to inherit permissions from membership in other roles.</span></span>  
  
-   <span data-ttu-id="51fcd-133">Kullanıcıları veya rolleriyle eklemeyin `sysadmin` veya `db_owner` rolleri.</span><span class="sxs-lookup"><span data-stu-id="51fcd-133">Do not add users or roles to the `sysadmin` or `db_owner` roles.</span></span> <span data-ttu-id="51fcd-134">Sistem yöneticileri ve veritabanı sahipleri tüm veritabanı nesnelerini erişebilir.</span><span class="sxs-lookup"><span data-stu-id="51fcd-134">System administrators and database owners can access all database objects.</span></span>  
  
-   <span data-ttu-id="51fcd-135">Devre dışı `guest` hesabı.</span><span class="sxs-lookup"><span data-stu-id="51fcd-135">Disable the `guest` account.</span></span> <span data-ttu-id="51fcd-136">Bu, anonim kullanıcılar veritabanına bağlanırken engeller.</span><span class="sxs-lookup"><span data-stu-id="51fcd-136">This will prevent anonymous users from connecting to the database.</span></span> <span data-ttu-id="51fcd-137">Konuk hesabını yeni veritabanları varsayılan olarak devre dışıdır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-137">The guest account is disabled by default in new databases.</span></span>  
  
-   <span data-ttu-id="51fcd-138">Hata işleme ve günlük hatalar uygulayın.</span><span class="sxs-lookup"><span data-stu-id="51fcd-138">Implement error handling and log errors.</span></span>  
  
-   <span data-ttu-id="51fcd-139">Tüm kullanıcı girişi doğrulama parametreli saklı yordamlar oluşturun.</span><span class="sxs-lookup"><span data-stu-id="51fcd-139">Create parameterized stored procedures that validate all user input.</span></span> <span data-ttu-id="51fcd-140">Tüm kullanıcı girişi olarak güvenilmeyen kabul eder.</span><span class="sxs-lookup"><span data-stu-id="51fcd-140">Treat all user input as untrusted.</span></span>  
  
-   <span data-ttu-id="51fcd-141">Dinamik SQL sürece kaçının kesinlikle gerekli.</span><span class="sxs-lookup"><span data-stu-id="51fcd-141">Avoid dynamic SQL unless absolutely necessary.</span></span> <span data-ttu-id="51fcd-142">Bir dize değeri sınırlandırmak ve giriş dizisinde sınırlayıcısı olayı kaçınmak için Transact-SQL QUOTENAME() işlevini kullanın.</span><span class="sxs-lookup"><span data-stu-id="51fcd-142">Use the Transact-SQL QUOTENAME() function to delimit a string value and escape any occurrence of the delimiter in the input string.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="51fcd-143">Dış Kaynaklar</span><span class="sxs-lookup"><span data-stu-id="51fcd-143">External Resources</span></span>  
 <span data-ttu-id="51fcd-144">Daha fazla bilgi için aşağıdaki kaynaklara bakın.</span><span class="sxs-lookup"><span data-stu-id="51fcd-144">For more information, see the following resources.</span></span>  
  
|<span data-ttu-id="51fcd-145">Kaynak</span><span class="sxs-lookup"><span data-stu-id="51fcd-145">Resource</span></span>|<span data-ttu-id="51fcd-146">Açıklama</span><span class="sxs-lookup"><span data-stu-id="51fcd-146">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="51fcd-147">[Saklı yordamlar](http://msdn.microsoft.com/library/ms190782.aspx) ve [SQL ekleme](http://go.microsoft.com/fwlink/?LinkId=98234) SQL Server Çevrimiçi Kitapları'nda</span><span class="sxs-lookup"><span data-stu-id="51fcd-147">[Stored Procedures](http://msdn.microsoft.com/library/ms190782.aspx) and [SQL Injection](http://go.microsoft.com/fwlink/?LinkId=98234) in SQL Server Books Online</span></span>|<span data-ttu-id="51fcd-148">Konularda saklı yordamlar oluşturma ve SQL ekleme nasıl çalıştığı açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="51fcd-148">Topics describe how to create stored procedures and how SQL Injection works.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="51fcd-149">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="51fcd-149">See Also</span></span>  
 [<span data-ttu-id="51fcd-150">ADO.NET Uygulamalarının Güvenliğini Sağlama</span><span class="sxs-lookup"><span data-stu-id="51fcd-150">Securing ADO.NET Applications</span></span>](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)  
 [<span data-ttu-id="51fcd-151">SQL Server Güvenliğine Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="51fcd-151">Overview of SQL Server Security</span></span>](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)  
 [<span data-ttu-id="51fcd-152">SQL Server'da Uygulama Güvenliği Senaryoları</span><span class="sxs-lookup"><span data-stu-id="51fcd-152">Application Security Scenarios in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/application-security-scenarios-in-sql-server.md)  
 [<span data-ttu-id="51fcd-153">SQL Server’da Secure Dynamic SQL Yazma</span><span class="sxs-lookup"><span data-stu-id="51fcd-153">Writing Secure Dynamic SQL in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)  
 [<span data-ttu-id="51fcd-154">SQL Server'da Saklı Yordam İmzalama</span><span class="sxs-lookup"><span data-stu-id="51fcd-154">Signing Stored Procedures in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)  
 [<span data-ttu-id="51fcd-155">SQL Server'da Kimliğe Bürünme İzinlerini Özelleştirme</span><span class="sxs-lookup"><span data-stu-id="51fcd-155">Customizing Permissions with Impersonation in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server.md)  
 [<span data-ttu-id="51fcd-156">Saklı Yordamlarla Verileri Değiştirme</span><span class="sxs-lookup"><span data-stu-id="51fcd-156">Modifying Data with Stored Procedures</span></span>](../../../../../docs/framework/data/adonet/modifying-data-with-stored-procedures.md)  
 [<span data-ttu-id="51fcd-157">ADO.NET yönetilen sağlayıcıları ve veri kümesi Geliştirici Merkezi</span><span class="sxs-lookup"><span data-stu-id="51fcd-157">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
