---
title: "Windows Forms DataGridView Denetiminde Zamanında Veri Yükleme ile Sanal Modu Uygulama"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- examples [Windows Forms], just-in-time data loading
- data [Windows Forms], managing large data sets
- DataGridView control [Windows Forms], virtual mode
- just-in-time data loading
- DataGridView control [Windows Forms], large data sets
- virtual mode [Windows Forms], just-in-time data loading
ms.assetid: c2a052b9-423c-4ff7-91dc-d8c7c79345f6
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 0bddac01a0d85ae985b54587619bcac6de5f966f
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/21/2017
---
# <a name="implementing-virtual-mode-with-just-in-time-data-loading-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="12415-102">Windows Forms DataGridView Denetiminde Zamanında Veri Yükleme ile Sanal Modu Uygulama</span><span class="sxs-lookup"><span data-stu-id="12415-102">Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="12415-103">Sanal mod uygulamak için bir sebep <xref:System.Windows.Forms.DataGridView> denetimidir yalnızca gerektiği gibi veri alınamadı.</span><span class="sxs-lookup"><span data-stu-id="12415-103">One reason to implement virtual mode in the <xref:System.Windows.Forms.DataGridView> control is to retrieve data only as it is needed.</span></span> <span data-ttu-id="12415-104">Bu adlı *tam zamanında veri yükleme*.</span><span class="sxs-lookup"><span data-stu-id="12415-104">This is called *just-in-time data loading*.</span></span>  
  
 <span data-ttu-id="12415-105">Örneğin, bir uzak veritabanı çok büyük bir tabloda ile çalışıyorsanız, görüntü için gerekli olan veri alma ve yalnızca kullanıcı görünüme yeni satırlar kaydırdığında ek veri alma başlangıç gecikmelerden kaçınmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12415-105">If you are working with a very large table in a remote database, for example, you might want to avoid startup delays by retrieving only the data that is necessary for display and retrieving additional data only when the user scrolls new rows into view.</span></span> <span data-ttu-id="12415-106">Uygulamanızı çalıştıran istemci bilgisayarlar sınırlı miktarda veri depolamak için kullanılabilir bellek varsa, yeni değerleri veritabanından alınırken kullanılmayan verileri atmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12415-106">If the client computers running your application have a limited amount of memory available for storing data, you might also want to discard unused data when retrieving new values from the database.</span></span>  
  
 <span data-ttu-id="12415-107">Aşağıdaki bölümlerde nasıl kullanılacağını bir <xref:System.Windows.Forms.DataGridView> denetimi yalnızca zaman önbellek ile.</span><span class="sxs-lookup"><span data-stu-id="12415-107">The following sections describe how to use a <xref:System.Windows.Forms.DataGridView> control with a just-in-time cache.</span></span>  
  
 <span data-ttu-id="12415-108">Bu konudaki tek bir liste olarak kodu kopyalamak için bkz: [nasıl yapılır: Windows Forms DataGridView denetimini Just-In-Time veri yükleme ile sanal modu uygulama](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span><span class="sxs-lookup"><span data-stu-id="12415-108">To copy the code in this topic as a single listing, see [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span></span>  
  
## <a name="the-form"></a><span data-ttu-id="12415-109">Formu</span><span class="sxs-lookup"><span data-stu-id="12415-109">The Form</span></span>  
 <span data-ttu-id="12415-110">Aşağıdaki kod örneğinde salt okunur içeren bir form tanımlar <xref:System.Windows.Forms.DataGridView> etkileşimde denetim bir `Cache` nesnesi aracılığıyla bir <xref:System.Windows.Forms.DataGridView.CellValueNeeded> olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="12415-110">The following code example defines a form containing a read-only <xref:System.Windows.Forms.DataGridView> control that interacts with a `Cache` object through a <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler.</span></span> <span data-ttu-id="12415-111">`Cache` Nesne yerel olarak depolanmış değerlerini yönetir ve kullandığı bir `DataRetriever` örnek Northwind veritabanı Siparişler tablosundan değerleri almak için nesne.</span><span class="sxs-lookup"><span data-stu-id="12415-111">The `Cache` object manages the locally stored values and uses a `DataRetriever` object to retrieve values from the Orders table of the sample Northwind database.</span></span> <span data-ttu-id="12415-112">`DataRetriever` Uygulayan nesne `IDataPageRetriever` gerektirdiği arabirimi `Cache` sınıfı, ayrıca başlatmak için kullanılan <xref:System.Windows.Forms.DataGridView> kontrol satırları ve sütunları.</span><span class="sxs-lookup"><span data-stu-id="12415-112">The `DataRetriever` object, which implements the `IDataPageRetriever` interface required by the `Cache` class, is also used to initialize the <xref:System.Windows.Forms.DataGridView> control rows and columns.</span></span>  
  
 <span data-ttu-id="12415-113">`IDataPageRetriever`, `DataRetriever`, Ve `Cache` türleri, bu konunun ilerleyen bölümlerinde açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="12415-113">The `IDataPageRetriever`, `DataRetriever`, and `Cache` types are described later in this topic.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="12415-114">Bağlantı dizesindeki bir parola gibi hassas bilgileri depolamak, uygulamanızın güvenliğini etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="12415-114">Storing sensitive information, such as a password, within the connection string can affect the security of your application.</span></span> <span data-ttu-id="12415-115">Windows Kimlik Doğrulaması (tümleşik güvenlik olarak da bilinir) kullanılarak bir veritabanına erişimi denetlemek için daha güvenli bir yoldur.</span><span class="sxs-lookup"><span data-stu-id="12415-115">Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database.</span></span> <span data-ttu-id="12415-116">Daha fazla bilgi için bkz: [koruma bağlantı bilgilerini](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span><span class="sxs-lookup"><span data-stu-id="12415-116">For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)]  
  
## <a name="the-idatapageretriever-interface"></a><span data-ttu-id="12415-117">IDataPageRetriever arabirimi</span><span class="sxs-lookup"><span data-stu-id="12415-117">The IDataPageRetriever Interface</span></span>  
 <span data-ttu-id="12415-118">Aşağıdaki kod örneğinde tanımlar `IDataPageRetriever` tarafından uygulanan arabirimi `DataRetriever` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="12415-118">The following code example defines the `IDataPageRetriever` interface, which is implemented by the `DataRetriever` class.</span></span> <span data-ttu-id="12415-119">Bu arabirimde bildirilen tek yöntemdir `SupplyPageOfData` ilk satır dizini ve verilerin tek bir sayfayla satır sayısını gerektirir yöntemi.</span><span class="sxs-lookup"><span data-stu-id="12415-119">The only method declared in this interface is the `SupplyPageOfData` method, which requires an initial row index and a count of the number of rows in a single page of data.</span></span> <span data-ttu-id="12415-120">Bu değerleri tarafından uygulayan bir veri alt kümesini bir veri kaynağından veri almak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="12415-120">These values are used by the implementer to retrieve a subset of data from a data source.</span></span>  
  
 <span data-ttu-id="12415-121">A `Cache` nesnesi iki ilk sayfa veri yüklemek için bu arabirimi uygulaması oluşturma sırasında kullanır.</span><span class="sxs-lookup"><span data-stu-id="12415-121">A `Cache` object uses an implementation of this interface during construction to load two initial pages of data.</span></span> <span data-ttu-id="12415-122">Önbellek önbelleğe alınmamış bir değer gerekli olduğunda, bu sayfaları birini atar ve değerini içeren yeni bir sayfa istekleri `IDataPageRetriever`.</span><span class="sxs-lookup"><span data-stu-id="12415-122">Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the `IDataPageRetriever`.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)]  
  
## <a name="the-dataretriever-class"></a><span data-ttu-id="12415-123">DataRetriever sınıfı</span><span class="sxs-lookup"><span data-stu-id="12415-123">The DataRetriever Class</span></span>  
 <span data-ttu-id="12415-124">Aşağıdaki kod örneğinde tanımlar `DataRetriever` sınıfı, hangi uygulayan `IDataPageRetriever` bir sunucudan sayfa veri almak için arabirim.</span><span class="sxs-lookup"><span data-stu-id="12415-124">The following code example defines the `DataRetriever` class, which implements the `IDataPageRetriever` interface to retrieve pages of data from a server.</span></span> <span data-ttu-id="12415-125">`DataRetriever` Sınıfı sağlar `Columns` ve `RowCount` özellikler, hangi <xref:System.Windows.Forms.DataGridView> ekleyeceğini gerekli sütunları oluşturun ve boş satırlar için uygun sayıda eklemek için <xref:System.Windows.Forms.DataGridView.Rows%2A> koleksiyonu.</span><span class="sxs-lookup"><span data-stu-id="12415-125">The `DataRetriever` class also provides `Columns` and `RowCount` properties, which the <xref:System.Windows.Forms.DataGridView> control uses to create the necessary columns and to add the appropriate number of empty rows to the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection.</span></span> <span data-ttu-id="12415-126">Boş satır ekleme, böylece denetimi tablosundaki tüm verileri içerir ancak gibi davranacak gereklidir.</span><span class="sxs-lookup"><span data-stu-id="12415-126">Adding the empty rows is necessary so that the control will behave as though it contains all the data in the table.</span></span> <span data-ttu-id="12415-127">Bunun anlamı kaydırma çubuğunun kaydırma kutusuna uygun boyuta sahip olur ve kullanıcı tablodaki herhangi bir satır erişebilir.</span><span class="sxs-lookup"><span data-stu-id="12415-127">This means that the scroll box in the scroll bar will have the appropriate size, and the user will be able to access any row in the table.</span></span> <span data-ttu-id="12415-128">Satırları tarafından doldurulur <xref:System.Windows.Forms.DataGridView.CellValueNeeded> görünüme yalnızca kaydırılan olduğunda olay işleyicisi.</span><span class="sxs-lookup"><span data-stu-id="12415-128">The rows are filled by the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler only when they are scrolled into view.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)]  
  
## <a name="the-cache-class"></a><span data-ttu-id="12415-129">Önbellek sınıfı</span><span class="sxs-lookup"><span data-stu-id="12415-129">The Cache Class</span></span>  
 <span data-ttu-id="12415-130">Aşağıdaki kod örneğinde tanımlar `Cache` iki sayfa aracılığıyla doldurulmuş veri yöneten sınıf bir `IDataPageRetriever` uygulaması.</span><span class="sxs-lookup"><span data-stu-id="12415-130">The following code example defines the `Cache` class, which manages two pages of data populated through an `IDataPageRetriever` implementation.</span></span> <span data-ttu-id="12415-131">`Cache` Sınıfı tanımlayan bir iç `DataPage` içeren yapısı bir <xref:System.Data.DataTable> değerleri tek bir önbellekte depolamak için sayfa ve satır dizinler hesaplar sayfanın üst ve alt sınırlarını temsil eder.</span><span class="sxs-lookup"><span data-stu-id="12415-131">The `Cache` class defines an inner `DataPage` structure, which contains a <xref:System.Data.DataTable> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page.</span></span>  
  
 <span data-ttu-id="12415-132">`Cache` Sınıfı yapım aynı anda iki sayfa veri yükler.</span><span class="sxs-lookup"><span data-stu-id="12415-132">The `Cache` class loads two pages of data at construction time.</span></span> <span data-ttu-id="12415-133">Her <xref:System.Windows.Forms.DataGridView.CellValueNeeded> olay isteklerini bir değer `Cache` nesne belirleyen değeri kullanılabilir ise, iki birini sayfaları ve, varsa, döndürür.</span><span class="sxs-lookup"><span data-stu-id="12415-133">Whenever the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event requests a value, the `Cache` object determines if the value is available in one of its two pages and, if so, returns it.</span></span> <span data-ttu-id="12415-134">Değer yerel olarak kullanılabilir değilse `Cache` nesne belirler, iki sayfalarını en uzak şu anda görüntülenen satır ve sayfa sonra döndürür istenen değeri içeren yeni bir tane ile değiştirir.</span><span class="sxs-lookup"><span data-stu-id="12415-134">If the value is not available locally, the `Cache` object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns.</span></span>  
  
 <span data-ttu-id="12415-135">Veri sayfası satır sayısı ekranda aynı anda görüntülenecek satırların sayısı ile aynı olduğu varsayılarak, bu model verimli bir şekilde en son görüntülenen sayfaya geri dönmek kullanıcıların tabloda disk belleği sağlar.</span><span class="sxs-lookup"><span data-stu-id="12415-135">Assuming that the number of rows in a data page is the same as the number of rows that can be displayed on screen at once, this model allows users paging through the table to efficiently return to the most recently viewed page.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)]  
  
## <a name="additional-considerations"></a><span data-ttu-id="12415-136">Ek hususlar</span><span class="sxs-lookup"><span data-stu-id="12415-136">Additional Considerations</span></span>  
 <span data-ttu-id="12415-137">Yukarıdaki kod örnekleri, tam zamanında veri yükleme Tanıtımı sağlanır.</span><span class="sxs-lookup"><span data-stu-id="12415-137">The previous code examples are provided as a demonstration of just-in-time data loading.</span></span> <span data-ttu-id="12415-138">En yüksek verimlilik elde etmek kendi gereksinimlerine göre kodu değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="12415-138">You will need to modify the code for your own needs to achieve maximum efficiency.</span></span> <span data-ttu-id="12415-139">En azından, önbellekte veri sayfa başına satır sayısı için uygun bir değer seçin gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="12415-139">At minimum, you will need to choose an appropriate value for the number of rows per page of data in the cache.</span></span> <span data-ttu-id="12415-140">Bu değer içine geçirilir `Cache` Oluşturucusu.</span><span class="sxs-lookup"><span data-stu-id="12415-140">This value is passed into the `Cache` constructor.</span></span> <span data-ttu-id="12415-141">Sayfa başına satır sayısı az aynı anda görüntülenen satır sayısından olmalıdır, <xref:System.Windows.Forms.DataGridView> denetim.</span><span class="sxs-lookup"><span data-stu-id="12415-141">The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <xref:System.Windows.Forms.DataGridView> control.</span></span>  
  
 <span data-ttu-id="12415-142">En iyi sonuçlar için performans testi ve kullanılabilirlik sisteminizi ve kullanıcılarınızın gereksinimlerini belirlemek için sınama gerçekleştir gerekecektir.</span><span class="sxs-lookup"><span data-stu-id="12415-142">For best results, you will need to conduct performance testing and usability testing to determine the requirements of your system and your users.</span></span> <span data-ttu-id="12415-143">Dikkate gerekecek birkaç etkene bellek miktarı, uygulamanızın, kullanılan ağ bağlantısının kullanılabilir bant genişliğini ve kullanılan Server gecikme çalıştıran istemci makinelerinizde içerir.</span><span class="sxs-lookup"><span data-stu-id="12415-143">Several factors that you will need to take into consideration include the amount of memory in the client machines running your application, the available bandwidth of the network connection used, and the latency of the server used.</span></span> <span data-ttu-id="12415-144">Gecikme süresi ve bant genişliği bazen en yüksek kullanım belirlenmesi.</span><span class="sxs-lookup"><span data-stu-id="12415-144">The bandwidth and latency should be determined at times of peak usage.</span></span>  
  
 <span data-ttu-id="12415-145">Kaydırma, uygulamanızın performansını artırmak için yerel olarak depolanan veri miktarını artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12415-145">To improve the scrolling performance of your application, you can increase the amount of data stored locally.</span></span> <span data-ttu-id="12415-146">Ancak, başlangıç zamanını geliştirmek için çok fazla veri başlangıçta yüklenirken olmadığını kaçının gerekir.</span><span class="sxs-lookup"><span data-stu-id="12415-146">To improve startup time, however, you must avoid loading too much data initially.</span></span> <span data-ttu-id="12415-147">Değiştirmek istediğiniz `Cache` , onu saklayabilir veri sayfaların sayısını artırmak için sınıf.</span><span class="sxs-lookup"><span data-stu-id="12415-147">You may want to modify the `Cache` class to increase the number of data pages it can store.</span></span> <span data-ttu-id="12415-148">Daha fazla veri sayfalarını kullanarak kaydırma verimliliği artırabilir, ancak ideal bir veri sayfasında, kullanılabilir bant genişliğini ve sunucu gecikme süresi bağlı olarak satır sayısı belirlemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="12415-148">Using more data pages can improve scrolling efficiency, but you will need to determine the ideal number of rows in a data page, depending on the available bandwidth and the server latency.</span></span> <span data-ttu-id="12415-149">Daha küçük sayfaları ile sunucunun daha sık erişilen, ancak istenen veri döndürülemiyor daha az zaman alır.</span><span class="sxs-lookup"><span data-stu-id="12415-149">With smaller pages, the server will be accessed more frequently, but will take less time to return the requested data.</span></span> <span data-ttu-id="12415-150">Gecikme süresi daha fazla bant genişliği daha ilgili bir sorun varsa, daha büyük veri sayfaları kullanmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12415-150">If latency is more of an issue than bandwidth, you may want to use larger data pages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="12415-151">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="12415-151">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>  
 [<span data-ttu-id="12415-152">Performans ayarlama Windows Forms DataGridView denetimi</span><span class="sxs-lookup"><span data-stu-id="12415-152">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12415-153">Windows Forms DataGridView denetimini ölçeklendirme için en iyi uygulamalar</span><span class="sxs-lookup"><span data-stu-id="12415-153">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12415-154">Sanal mod Windows Forms DataGridView denetimi</span><span class="sxs-lookup"><span data-stu-id="12415-154">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12415-155">İzlenecek yol: Windows Forms DataGridView denetiminde sanal modu uygulama</span><span class="sxs-lookup"><span data-stu-id="12415-155">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)  
 [<span data-ttu-id="12415-156">Nasıl yapılır: Windows tam zamanında veri yükleme ile sanal modu uygulama Forms DataGridView denetiminde</span><span class="sxs-lookup"><span data-stu-id="12415-156">How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)
