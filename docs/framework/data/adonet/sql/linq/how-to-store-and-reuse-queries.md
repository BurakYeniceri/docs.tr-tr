---
title: 'Nasıl yapılır: depolamak ve yeniden sorgular'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: a2d16cd5dce033c563783a0882f3de73194cf2d1
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33360144"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="921c0-102">Nasıl yapılır: depolamak ve yeniden sorgular</span><span class="sxs-lookup"><span data-stu-id="921c0-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="921c0-103">Birçok kez yapısal olarak benzer sorguları yürüten bir uygulamanız varsa, genellikle bir kez sorgu derleme ve farklı parametrelerle birkaç kez yürütme tarafından performansını artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="921c0-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="921c0-104">Örneğin, burada Şehir çalışma zamanında bir form kullanıcı tarafından belirtilen belirli bir şehir bulunan tüm müşterilerin almak bir uygulama olabilir.</span><span class="sxs-lookup"><span data-stu-id="921c0-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="921c0-105"> kullanımını destekleyen *sorguları derlenmiş* bu amaç için.</span><span class="sxs-lookup"><span data-stu-id="921c0-105"> supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="921c0-106">Bu desen kullanımı, derlenmiş sorguları için en yaygın kullanımı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="921c0-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="921c0-107">Diğer yaklaşımlar mümkündür.</span><span class="sxs-lookup"><span data-stu-id="921c0-107">Other approaches are possible.</span></span> <span data-ttu-id="921c0-108">Örneğin, derlenmiş sorgu tasarımcısı tarafından oluşturulan kodu genişleten bir parçalı sınıf statik üyeleri olarak depolanabilir.</span><span class="sxs-lookup"><span data-stu-id="921c0-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="921c0-109">Örnek</span><span class="sxs-lookup"><span data-stu-id="921c0-109">Example</span></span>  
 <span data-ttu-id="921c0-110">Birçok senaryoda iş parçacığı sınırları boyunca sorguları yeniden isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="921c0-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="921c0-111">Statik değişkenler derlenmiş sorguları depolamak bu gibi durumlarda, özellikle etkili olur.</span><span class="sxs-lookup"><span data-stu-id="921c0-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="921c0-112">Aşağıdaki kod örneğinde varsayar bir `Queries` depolamak için tasarlanan sınıfı sorguları derlenmiş ve kesin türü belirtilmiş temsil eden bir Northwind sınıf varsayar <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="921c0-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="921c0-113">Örnek</span><span class="sxs-lookup"><span data-stu-id="921c0-113">Example</span></span>  
 <span data-ttu-id="921c0-114">Şu anda döndüren deposunda (statik değişkenler) sorgular olamaz bir *anonim tür*, genel bir bağımsız değişken olarak sağlamak için adı türü yok.</span><span class="sxs-lookup"><span data-stu-id="921c0-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="921c0-115">Aşağıdaki örnek, sonucunu temsil eder ve daha genel bir bağımsız değişken olarak kullanan bir tür oluşturarak sorunu nasıl çalışabileceğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="921c0-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="921c0-116">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="921c0-116">See Also</span></span>  
 <xref:System.Data.Linq.CompiledQuery>  
 [<span data-ttu-id="921c0-117">Sorgu Kavramları</span><span class="sxs-lookup"><span data-stu-id="921c0-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)  
 [<span data-ttu-id="921c0-118">Veritabanını Sorgulama</span><span class="sxs-lookup"><span data-stu-id="921c0-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
