---
title: LINQ-SQL N katmanlı Web Hizmetleri
ms.date: 03/30/2017
ms.assetid: 9cb10eb8-957f-4beb-a271-5f682016fed2
ms.openlocfilehash: 94b00c5b9a433aa53fecef10d865db76d5577c84
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33356107"
---
# <a name="linq-to-sql-n-tier-with-web-services"></a><span data-ttu-id="51da8-102">LINQ-SQL N katmanlı Web Hizmetleri</span><span class="sxs-lookup"><span data-stu-id="51da8-102">LINQ to SQL N-Tier with Web Services</span></span>
[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="51da8-103"> özellikle orta katman bir Web hizmeti gibi birbirine sıkı şekilde bağlı veri erişim katmanı (DAL) olarak kullanılmak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="51da8-103"> is designed especially for use on the middle tier in a loosely-coupled data access layer (DAL) such as a Web service.</span></span> <span data-ttu-id="51da8-104">Sunu katmanı bir ASP.NET Web sayfasıdır sonra kullandığınız <xref:System.Web.UI.WebControls.LinqDataSource> Web kullanıcı arabirimi arasında veri aktarımını yönetmek için sunucu denetimi ve [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] Orta katmanda.</span><span class="sxs-lookup"><span data-stu-id="51da8-104">If the presentation tier is an ASP.NET Web page, then you use the <xref:System.Web.UI.WebControls.LinqDataSource> Web server control to manage the data transfer between the user interface and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] on the middle-tier.</span></span> <span data-ttu-id="51da8-105">Sunu katmanı ASP.NET sayfası değilse, seri hale getirme ve seri durumundan çıkarılması veri yönetmek için bazı ek iş Orta katmanda ve sunu katmanı yapmalısınız.</span><span class="sxs-lookup"><span data-stu-id="51da8-105">If the presentation tier is not an ASP.NET page, then both the middle-tier and the presentation tier must do some additional work to manage the serialization and deserialization of data.</span></span>  
  
## <a name="setting-up-linq-to-sql-on-the-middle-tier"></a><span data-ttu-id="51da8-106">LINQ-SQL orta katman ayarlama</span><span class="sxs-lookup"><span data-stu-id="51da8-106">Setting up LINQ to SQL on the Middle Tier</span></span>  
 <span data-ttu-id="51da8-107">Web hizmeti veya n katmanlı uygulama, orta katman veri bağlamı ve sınıflar içerir.</span><span class="sxs-lookup"><span data-stu-id="51da8-107">In a Web service or n-tier application, the middle tier contains the data context and the entity classes.</span></span> <span data-ttu-id="51da8-108">El ile veya her iki SQLMetal.exe kullanarak bu sınıfları oluşturabilirsiniz veya [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] başka bir yerde belgelerinde açıklandığı gibi.</span><span class="sxs-lookup"><span data-stu-id="51da8-108">You can create these classes manually, or by using either SQLMetal.exe or the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] as described elsewhere in the documentation.</span></span> <span data-ttu-id="51da8-109">Tasarım zamanında varlık sınıflarının seri hale getirilebilir seçeneğiniz vardır.</span><span class="sxs-lookup"><span data-stu-id="51da8-109">At design time, you have the option to make the entity classes serializable.</span></span> <span data-ttu-id="51da8-110">Daha fazla bilgi için bkz: [nasıl yapılır: varlıklar serileştirilebilir olun](../../../../../../docs/framework/data/adonet/sql/linq/how-to-make-entities-serializable.md).</span><span class="sxs-lookup"><span data-stu-id="51da8-110">For more information, see [How to: Make Entities Serializable](../../../../../../docs/framework/data/adonet/sql/linq/how-to-make-entities-serializable.md).</span></span> <span data-ttu-id="51da8-111">Verileri geri döndüğünüzde verilerin serileştirilmesi için kapsülleyen sınıfları ve proje ayrı bir dizi bu seri hale getirilebilir türler oluşturmak için başka bir seçenektir, [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] sorgular.</span><span class="sxs-lookup"><span data-stu-id="51da8-111">Another option is to create a separate set of classes that encapsulate the data to be serialized, and then project into those serializable types when you return data in your [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries.</span></span>  
  
 <span data-ttu-id="51da8-112">Ardından istemcilerin almak, eklemek ve verileri güncelleştirmek için arayacağı yöntemleriyle arabirimi tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="51da8-112">You then define the interface with the methods that the clients will call to retrieve, insert and update data.</span></span> <span data-ttu-id="51da8-113">Arabirim yöntemleri sarmalama, [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] sorgular.</span><span class="sxs-lookup"><span data-stu-id="51da8-113">The interface methods wrap your [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries.</span></span> <span data-ttu-id="51da8-114">Uzak yöntem çağrılarını ve veri serileştirmek işlemek için seri hale getirme mekanizmasını herhangi bir tür kullanın.</span><span class="sxs-lookup"><span data-stu-id="51da8-114">You can use any kind of serialization mechanism to handle the remote method calls and the serialization of data.</span></span> <span data-ttu-id="51da8-115">Tek gereksinim, müşteriler ve standart Northwind nesne modelindeki Siparişler arasında gibi nesne modelinde döngüsel ya da çift yönlü ilişkiler varsa, daha sonra onu destekleyen bir seri hale getirici kullanmasıdır.</span><span class="sxs-lookup"><span data-stu-id="51da8-115">The only requirement is that if you have cyclic or bi-directional relationships in your object model, such as that between Customers and Orders in the standard Northwind object model, then you must use a serializer that supports it.</span></span> <span data-ttu-id="51da8-116">Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> destekleyen iki yönlü ilişkileri ancak WCF Web Hizmetleri ile kullanılan XmlSerializer desteklemez.</span><span class="sxs-lookup"><span data-stu-id="51da8-116">The Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> supports bi-directional relationships but the XmlSerializer that is used with non-WCF Web services does not.</span></span> <span data-ttu-id="51da8-117">Ardından XmlSerializer kullanmayı seçerseniz, nesne modeli hiçbir döngüsel ilişki sahip olduğundan emin olmalısınız.</span><span class="sxs-lookup"><span data-stu-id="51da8-117">If you select to use the XmlSerializer, then you must make sure that your object model has no cyclic relationships.</span></span>  
  
 <span data-ttu-id="51da8-118">Windows Communication Foundation hakkında daha fazla bilgi için bkz: [Windows Communication Foundation Hizmetleri ve Visual Studio'da WCF Veri Hizmetleri](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="51da8-118">For more information about Windows Communication Foundation, see [Windows Communication Foundation Services and WCF Data Services in Visual Studio](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span></span>  
  
 <span data-ttu-id="51da8-119">Kısmi sınıflar ve yöntemler kullanarak, iş kurallarını veya diğer etki alanına özgü mantığı uygulamak <xref:System.Data.Linq.DataContext> ve uygulamasına olanak sınıflar [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] çalışma zamanı olayları.</span><span class="sxs-lookup"><span data-stu-id="51da8-119">Implement your business rules or other domain-specific logic by using the partial classes and methods on the <xref:System.Data.Linq.DataContext> and entity classes to hook into [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] runtime events.</span></span> <span data-ttu-id="51da8-120">Daha fazla bilgi için bkz: [N katmanlı iş mantığı uygulama](../../../../../../docs/framework/data/adonet/sql/linq/implementing-business-logic-linq-to-sql.md).</span><span class="sxs-lookup"><span data-stu-id="51da8-120">For more information, see [Implementing N-Tier Business Logic](../../../../../../docs/framework/data/adonet/sql/linq/implementing-business-logic-linq-to-sql.md).</span></span>  
  
## <a name="defining-the-serializable-types"></a><span data-ttu-id="51da8-121">Seri hale getirilebilir türleri tanımlama</span><span class="sxs-lookup"><span data-stu-id="51da8-121">Defining the Serializable Types</span></span>  
 <span data-ttu-id="51da8-122">İstemci veya sunu katmanı orta katmandan alabilmesi sınıfları için tür tanımları olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="51da8-122">The client or presentation tier must have type definitions for the classes that it will be receiving from the middle tier.</span></span> <span data-ttu-id="51da8-123">Bu türlerde varlık sınıfları kendilerini ya da yalnızca belirli alanlar uzaktan iletişim için varlık sınıflardan sarmalamak özel sınıfları olabilir.</span><span class="sxs-lookup"><span data-stu-id="51da8-123">Those types may be the entity classes themselves, or special classes that wrap only certain fields from the entity classes for remoting.</span></span> <span data-ttu-id="51da8-124">Her iki durumda da [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] sunu katmanı bu tür tanımları nasıl edinme hakkında tamamen unconcerned değil.</span><span class="sxs-lookup"><span data-stu-id="51da8-124">In any case, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] is completely unconcerned about how the presentation tier acquires those type definitions.</span></span> <span data-ttu-id="51da8-125">Örneğin, sunu katmanı türleri otomatik olarak oluşturmak için WCF kullanabilir veya bu türlerinin tanımlı olduğu DLL bir kopyasına sahip veya yalnızca kendi türlerinin sürümlerini tanımlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="51da8-125">For example, the presentation tier could use WCF to generate the types automatically, or it could have a copy of a DLL in which those types are defined, or it could just define its own versions of the types.</span></span>  
  
## <a name="retrieving-and-inserting-data"></a><span data-ttu-id="51da8-126">Alma ve veri ekleme</span><span class="sxs-lookup"><span data-stu-id="51da8-126">Retrieving and Inserting Data</span></span>  
 <span data-ttu-id="51da8-127">Orta katman nasıl sunu katmanı verilere erişen belirten bir arabirim tanımlar.</span><span class="sxs-lookup"><span data-stu-id="51da8-127">The middle tier defines an interface that specifies how the presentation tier accesses the data.</span></span> <span data-ttu-id="51da8-128">Örneğin `GetProductByID(int productID)`, veya `GetCustomers()`.</span><span class="sxs-lookup"><span data-stu-id="51da8-128">For example `GetProductByID(int productID)`, or `GetCustomers()`.</span></span> <span data-ttu-id="51da8-129">Orta katmanda yöntem gövdesi yeni bir örneğini oluşturur <xref:System.Data.Linq.DataContext>, bir veya daha fazla, tablodaki bir sorgu yürütür.</span><span class="sxs-lookup"><span data-stu-id="51da8-129">On the middle tier, the method body typically creates a new instance of the <xref:System.Data.Linq.DataContext>, executes a query against one or more of its table.</span></span> <span data-ttu-id="51da8-130">Orta katman sonra sonuç olarak döndüren bir <xref:System.Collections.Generic.IEnumerable%601>, burada `T` bir varlık sınıfı ya da serileştirme için kullanılan başka bir tür.</span><span class="sxs-lookup"><span data-stu-id="51da8-130">The middle tier then returns the result as an <xref:System.Collections.Generic.IEnumerable%601>, where `T` is either an entity class or another type that is used for serialization.</span></span> <span data-ttu-id="51da8-131">Sunu katmanı hiçbir zaman gönderir veya sorgu değişkenleri doğrudan veya orta katman alır.</span><span class="sxs-lookup"><span data-stu-id="51da8-131">The presentation tier never sends or receives query variables directly to or from the middle tier.</span></span> <span data-ttu-id="51da8-132">İki katmanı değerleri, nesneleri ve koleksiyonları somut veri değişimi.</span><span class="sxs-lookup"><span data-stu-id="51da8-132">The two tiers exchange values, objects, and collections of concrete data.</span></span> <span data-ttu-id="51da8-133">Bir koleksiyon aldıktan sonra sunu katmanı kullanabilirsiniz [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] gerekirse sorgu nesnelere.</span><span class="sxs-lookup"><span data-stu-id="51da8-133">After it has received a collection, the presentation tier can use [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] to Objects to query it if necessary.</span></span>  
  
 <span data-ttu-id="51da8-134">Veri eklerken, sunu katmanı yeni bir nesne oluşturmak ve orta katman iletebilirsiniz veya sağladığı değerlerine göre bir nesne oluşturmak orta katman sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="51da8-134">When inserting data, the presentation tier can construct a new object and send it to the middle tier, or it can have the middle tier construct the object based on values that it provides.</span></span> <span data-ttu-id="51da8-135">Genel olarak, alma ve n katmanlı uygulamalarda veri ekleme çok 2 katmanlı uygulamalarda işleminden farklı.</span><span class="sxs-lookup"><span data-stu-id="51da8-135">In general, retrieving and inserting data in n-tier applications does not differ much from the process in 2-tier applications.</span></span> <span data-ttu-id="51da8-136">Daha fazla bilgi için bkz: [veritabanını sorgulama](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md) ve [alma ve gönderme veri değişikliklerini](../../../../../../docs/framework/data/adonet/sql/linq/making-and-submitting-data-changes.md).</span><span class="sxs-lookup"><span data-stu-id="51da8-136">For more information, see [Querying the Database](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md) and [Making and Submitting Data Changes](../../../../../../docs/framework/data/adonet/sql/linq/making-and-submitting-data-changes.md).</span></span>  
  
## <a name="tracking-changes-for-updates-and-deletes"></a><span data-ttu-id="51da8-137">Güncelleştirmeleri ve silme için değişiklikleri izleme</span><span class="sxs-lookup"><span data-stu-id="51da8-137">Tracking Changes for Updates and Deletes</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="51da8-138"> zaman damgaları (RowVersions olarak da adlandırılır) ve özgün değerlerine dayalı iyimser eşzamanlılık destekler.</span><span class="sxs-lookup"><span data-stu-id="51da8-138"> supports optimistic concurrency based on timestamps (also named RowVersions) and on original values.</span></span> <span data-ttu-id="51da8-139">Ardından veritabanı tablolarını zaman damgaları varsa, güncelleştirmeleri ve silme işlemleri orta katman veya sunu katmanı üzerinde çok az ek iş gerektirir.</span><span class="sxs-lookup"><span data-stu-id="51da8-139">If the database tables have timestamps, then updates and deletions require little extra work on either the middle-tier or presentation tier.</span></span> <span data-ttu-id="51da8-140">İyimser eşzamanlılık denetimleri için özgün değerleri kullanmanız gerekiyorsa, ancak ardından sunu katmanı bu değerleri izleme ve geri güncelleştirmeleri yaptığında göndererek sorumludur.</span><span class="sxs-lookup"><span data-stu-id="51da8-140">However, if you must use original values for optimistic concurrency checks, then the presentation tier is responsible for tracking those values and sending them back when it makes updates.</span></span> <span data-ttu-id="51da8-141">Sunu katmanı üzerinde varlıklar için yapılan değişiklikler Orta katmanda izlenmez olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="51da8-141">This is because changes that were made to entities on the presentation tier are not tracked on the middle tier.</span></span> <span data-ttu-id="51da8-142">Aslında, bir varlık ve üzerinde yapılan son güncelleştirme özgün alınmasını genellikle gerçekleştirilir iki tamamen ayrı ayrı örnekleri tarafından <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="51da8-142">In fact, the original retrieval of an entity, and the eventual update made to it are typically performed by two completely separate instances of the <xref:System.Data.Linq.DataContext>.</span></span>  
  
 <span data-ttu-id="51da8-143">Sayısı arttıkça sunu katmanı yaptığı değişiklikler bu değişiklikler ve orta katman geri paket izlemek için hale karmaşık.</span><span class="sxs-lookup"><span data-stu-id="51da8-143">The greater the number of changes that the presentation tier makes, the more complex it becomes to track those changes and package them back to the middle tier.</span></span> <span data-ttu-id="51da8-144">İletişim kuran değişiklikleri için bir mekanizma tamamen kadar uygulama uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="51da8-144">The implementation of a mechanism for communicating changes is completely up to the application.</span></span> <span data-ttu-id="51da8-145">Tek gereksinim olan [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] iyimser eşzamanlılık denetimleri için gerekli olan özgün değerlere verilmelidir.</span><span class="sxs-lookup"><span data-stu-id="51da8-145">The only requirement is that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] must be given those original values that are required for optimistic concurrency checks.</span></span>  
  
 <span data-ttu-id="51da8-146">Daha fazla bilgi için bkz: [veri alımı ve N katmanlı uygulamalar (LINQ-SQL) CUD işlemlerinde](../../../../../../docs/framework/data/adonet/sql/linq/data-retrieval-and-cud-operations-in-n-tier-applications.md).</span><span class="sxs-lookup"><span data-stu-id="51da8-146">For more information, see [Data Retrieval and CUD Operations in N-Tier Applications (LINQ to SQL)](../../../../../../docs/framework/data/adonet/sql/linq/data-retrieval-and-cud-operations-in-n-tier-applications.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="51da8-147">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="51da8-147">See Also</span></span>  
 [<span data-ttu-id="51da8-148">LINQ to SQL ile N Katmanı ve Uzak Uygulamalar</span><span class="sxs-lookup"><span data-stu-id="51da8-148">N-Tier and Remote Applications with LINQ to SQL</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/n-tier-and-remote-applications-with-linq-to-sql.md)  
 [<span data-ttu-id="51da8-149">NIB: LinqDataSource Web sunucusu denetimine genel bakış</span><span class="sxs-lookup"><span data-stu-id="51da8-149">NIB: LinqDataSource Web Server Control Overview</span></span>](http://msdn.microsoft.com/library/104cfc3f-7385-47d3-8a51-830dfa791136)
