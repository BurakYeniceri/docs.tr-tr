---
title: Birlikte Çalışabilirlik İle İlgili Sorun Giderme (Visual Basic)
ms.custom: ''
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology:
- devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 1fae8215543c50484dc5ea7fc24f292ba84e2699
ms.sourcegitcommit: 2042de78fcdceebb6b8ac4b7a292b93e8782cbf5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/27/2018
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="1ca3d-102">Birlikte Çalışabilirlik İle İlgili Sorun Giderme (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ca3d-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="1ca3d-103">Ne zaman, çalışmanız COM ile yönetilen kod arasında [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], bir veya daha fazla aşağıdaki ortak sorunları karşılaşabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], you may encounter one or more of the following common issues.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor1"></a> <span data-ttu-id="1ca3d-104">Birlikte çalışma hazırlama</span><span class="sxs-lookup"><span data-stu-id="1ca3d-104">Interop Marshaling</span></span>  
 <span data-ttu-id="1ca3d-105">Bazen olmayan veri türlerini kullanmak zorunda kalabilirsiniz parçası [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ca3d-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="1ca3d-106">Birlikte çalışma derlemeleri COM nesneleri için iş çoğunu işleyecek ancak yönetilen nesneleri com'a kullanılan veri türünü kontrol gerekebilir</span><span class="sxs-lookup"><span data-stu-id="1ca3d-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="1ca3d-107">Örneğin, sınıf kitaplıkları yapılarda belirtmelisiniz `BStr` yönetilmeyen Visual Basic 6.0 ve önceki sürümleri tarafından oluşturulan COM nesnelerini gönderilen dizelerde türü.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="1ca3d-108">Böyle durumlarda, kullandığınız <xref:System.Runtime.InteropServices.MarshalAsAttribute> yönetilmeyen türleri olarak açığa çıkarılması yönetilen türler neden özniteliği.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor2"></a> <span data-ttu-id="1ca3d-109">Yönetilmeyen kod için dışarı aktarma sabit uzunluklu dizeler</span><span class="sxs-lookup"><span data-stu-id="1ca3d-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="1ca3d-110">Visual Basic 6.0 ve önceki sürümlerinde, bir null sonlandırma karakteri olmadan bayt dizisi olarak dizeleri COM nesnelerine dışarı aktarılır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="1ca3d-111">Diğer dilleri ile uyumluluk için Visual Basic .NET dizeleri dışarı aktarılırken bir sonlandırma karakter içerir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="1ca3d-112">Sonlandırma karakter dizileri eksikliği dizeleri dışarı aktarmak için bu uyumsuzluk adres etmenin en iyi yolu olan `Byte` veya `Char`.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor3"></a> <span data-ttu-id="1ca3d-113">Devralma hiyerarşileri dışarı aktarma</span><span class="sxs-lookup"><span data-stu-id="1ca3d-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="1ca3d-114">Yönetilen sınıf hiyerarşileri COM nesneleri olarak kullanıma sunulan zaman düzleştirmek çıkışı.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="1ca3d-115">Bir taban sınıf sahip bir üye tanımlayın ve taban sınıf içinde bir COM nesnesi olarak sunulan türetilmiş sınıf devralma, örneğin, türetilmiş sınıf COM nesnesinde kullanan istemciler devralınan üyeleri kullanmanız mümkün olmaz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="1ca3d-116">Taban sınıfı üyeleri erişilebilir COM nesneleri yalnızca bir temel sınıf örnekleri ve ardından yalnızca temel sınıfı bir COM nesnesi olarak da oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="1ca3d-117">Aşırı yüklenmiş yöntemler</span><span class="sxs-lookup"><span data-stu-id="1ca3d-117">Overloaded Methods</span></span>  
 <span data-ttu-id="1ca3d-118">Visual Basic ile aşırı yüklenmiş yöntemler oluşturabilseniz de COM tarafından desteklenmez</span><span class="sxs-lookup"><span data-stu-id="1ca3d-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="1ca3d-119">Aşırı yüklenmiş yöntemler içeren bir sınıf bir COM nesnesi olarak sunulduğunda, yeni yöntemi adları aşırı yüklenmiş yöntemler için oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="1ca3d-120">Örneğin, iki aşırı olan bir sınıfı göz önünde bulundurun `Synch` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="1ca3d-121">Sınıfı COM nesnesi olarak sunulduğunda, yeni oluşturulan yöntemi adları olabilir `Synch` ve `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="1ca3d-122">Yeniden adlandırma COM nesnesi Tüketiciler için iki sorunlara neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1.  <span data-ttu-id="1ca3d-123">İstemcileri oluşturulan yöntem adları beklememeniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-123">Clients might not expect the generated method names.</span></span>  
  
2.  <span data-ttu-id="1ca3d-124">Yeni aşırı sınıf veya onun temel sınıfı eklendiğinde COM nesnesi olarak sunulan sınıfında oluşturulan yöntemi adlarını değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="1ca3d-125">Bu sürüm oluşturma sorunlarına yol açabilir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="1ca3d-126">Her iki sorunları çözmek için her yöntemi aşırı COM nesneleri olarak gösterilen nesneleri geliştirirken kullanmak yerine benzersiz bir ad verin.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor4"></a> <span data-ttu-id="1ca3d-127">COM birlikte çalışma derlemeleri nesnelerde kullanımı</span><span class="sxs-lookup"><span data-stu-id="1ca3d-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="1ca3d-128">Yönetilen kod değişikliklerini temsil ettikleri COM nesneleri için neredeyse olmaları durumunda olarak birlikte çalışma derlemeleri kullanın.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="1ca3d-129">Ancak, sarmalayıcılar ve gerçek COM nesneleri olduklarından, birlikte çalışma derlemeleri ve standart derlemeleri kullanma arasındaki bazı farklar vardır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="1ca3d-130">Bu alanlar farkının Etkilenme sınıf ve veri türleri için parametreler ve dönüş değerleri şunlardır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor5"></a> <span data-ttu-id="1ca3d-131">Her iki arabirimde sunulan sınıfları ve sınıfları</span><span class="sxs-lookup"><span data-stu-id="1ca3d-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="1ca3d-132">Standart derlemelerde sınıfları, bir arabirim ve COM sınıfı temsil eden bir sınıf olarak birlikte çalışma derlemeleri COM sınıfları sunulur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="1ca3d-133">Arabirim adı, COM sınıfı için aynıdır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="1ca3d-134">Birlikte çalışma sınıfın adını, özgün COM sınıfı ile aynıdır, ancak "Sınıf" sözcüğüyle eklenir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="1ca3d-135">Örneğin, bir COM nesnesi için bir birlikte çalışma derlemesine başvuru içeren bir proje olduğunu varsayalım.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="1ca3d-136">COM sınıfı adlandırılmışsa `MyComClass`, IntelliSense ve Nesne Tarayıcısı adlı bir arabirim göster `MyComClass` ve adlı bir sınıf `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor6"></a> <span data-ttu-id="1ca3d-137">Bir .NET Framework sınıf örneklerini oluşturma</span><span class="sxs-lookup"><span data-stu-id="1ca3d-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="1ca3d-138">Genellikle, örneğini oluşturduğunuz bir [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] kullanarak sınıfı `New` bir sınıf adı deyimiyle.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="1ca3d-139">Birlikte çalışma derlemesi tarafından temsil edilen bir COM sınıfı sahip olduğu kullanım bir örneği `New` deyimi bir arabirime sahip.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="1ca3d-140">COM sınıfı kullanmadığınız sürece bir `Inherits` deyimi, bir sınıf olarak arabirimi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="1ca3d-141">Aşağıdaki kodu nasıl oluşturulduğunu gösteren bir `Command` Microsoft ActiveX veri nesneleri 2.8 kitaplığı COM nesneye bir başvurusu olan bir proje nesnesinde:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]  
  
 <span data-ttu-id="1ca3d-142">Ancak, türetilmiş bir sınıf için temel olarak COM sınıfı kullanıyorsanız, aşağıdaki kod olduğu gibi COM sınıfı temsil eden birlikte çalışma sınıf kullanmanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]  
  
> [!NOTE]
>  <span data-ttu-id="1ca3d-143">Birlikte çalışma derlemeleri COM sınıfları temsil eden arabirimler örtük olarak uygular.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="1ca3d-144">Kullanmayı denemek `Implements` bu arabirimleri veya bir hata uygulamak için deyimi neden olur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor7"></a> <span data-ttu-id="1ca3d-145">Veri türleri için parametreler ve dönüş değerleri</span><span class="sxs-lookup"><span data-stu-id="1ca3d-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="1ca3d-146">Standart derlemeleri üyeleri, özgün nesne bildiriminde kullanılanlardan farklı veri türleri birlikte çalışma derlemesi üyeleri olabilir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="1ca3d-147">Birlikte çalışma derlemeleri COM türlerini uyumlu ortak dil çalışma zamanı türü örtük olarak Dönüştür. ancak, her iki çalışma zamanı hataları önlemek için kullanılan veri türlerine dikkat etmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="1ca3d-148">Örneğin, Visual Basic 6.0 ve önceki sürümlerinde, türü değerleri oluşturulan COM nesnelerini içinde `Integer` varsayın [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] eşdeğer türü `Short`.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="1ca3d-149">Kullanmadan önce içeri aktarılan üyeleri özelliklerini incelemek için Nesne Tarayıcısı kullanmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor8"></a> <span data-ttu-id="1ca3d-150">Modül düzeyi COM yöntemleri</span><span class="sxs-lookup"><span data-stu-id="1ca3d-150">Module level COM methods</span></span>  
 <span data-ttu-id="1ca3d-151">Çoğu COM nesneleri, COM sınıfı kullanarak bir örneğini oluşturarak kullanılır `New` anahtar sözcüğünü ve ardından nesnesinin yöntemleri çağırma.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="1ca3d-152">Bu kural için bir özel içerir içeren COM nesneleri `AppObj` veya `GlobalMultiUse` COM sınıfları.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="1ca3d-153">Bu tür sınıflar modül düzeyi Visual Basic .NET sınıfları yöntemlerinde benzer.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="1ca3d-154">Örtük olarak Visual Basic 6.0 ve önceki sürümleri gibi nesnelerin örneklerini sizin için kendi yöntemlerini birini çağırın ilk kez oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="1ca3d-155">Örneğin, Visual Basic 6. 0 ' Microsoft DAO 3.6 Nesne Kitaplığı ve çağrı başvuru ekleyebileceğiniz `DBEngine` örneği ilk oluşturmadan yöntemi:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="1ca3d-156">Visual Basic .NET kendi yöntemlerini kullanabilmeniz için önce her zaman COM nesnelerinin örneklerini oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="1ca3d-157">Visual Basic'te bu yöntemleri kullanmak için istenen sınıfı bir değişken bildirme ve nesne nesne değişkenine atamak için yeni anahtar sözcük kullanma.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="1ca3d-158">`Shared` Anahtar sözcüğü kullanılabilir olduğundan emin olmak istediğinizde bu yalnızca bir sınıf örneği oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor9"></a> <span data-ttu-id="1ca3d-159">Olay işleyicileri işlenmemiş hataları</span><span class="sxs-lookup"><span data-stu-id="1ca3d-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="1ca3d-160">Bir ortak birlikte çalışma sorun COM nesneleri tarafından başlatılan olayları işlemek olay işleyicileri hataları içerir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="1ca3d-161">Bu tür hatalar özellikle kullanarak hatalara karşı denetleyin yoksayılır `On Error` veya `Try...Catch...Finally` deyimleri.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="1ca3d-162">Örneğin, aşağıdaki örnek, Microsoft ActiveX veri nesneleri 2.8 kitaplığı COM nesneye bir başvurusu olan bir Visual Basic .NET projesinden olur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]  
  
 <span data-ttu-id="1ca3d-163">Bu örnek, beklendiği gibi bir hata oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-163">This example raises an error as expected.</span></span> <span data-ttu-id="1ca3d-164">Ancak, aynı örneği olmadan çalışırsanız `Try...Catch...Finally` bloğu, hatayı göz ardı edilir gibi kullandıysanız `OnError Resume Next` deyimi.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="1ca3d-165">Hata işleme olmadan sessizce sıfıra bölme başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="1ca3d-166">İşlenmeyen özel durum hataları gibi hataları hiçbir zaman yükseltmek için özel durum olayları COM nesneleri işlemek olay işleyicileri işleme çeşit kullanmak önemlidir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="1ca3d-167">COM birlikte çalışma hataları anlama</span><span class="sxs-lookup"><span data-stu-id="1ca3d-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="1ca3d-168">Hata işleme olmadan birlikte çalışma çağrıları genellikle çok az bilgisi sağlayın hatalar oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="1ca3d-169">Mümkün olduğunda, yapılandırılmış hata ortaya çıkan sorunları hakkında daha fazla bilgi sağlamak için işleme kullanın.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="1ca3d-170">Uygulamaları ayıklarken bu özellikle yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="1ca3d-171">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]  
  
 <span data-ttu-id="1ca3d-172">Özel durum nesnesi içeriğini inceleyerek hata açıklaması, HRESULT ve COM hatalarının kaynağını gibi bilgiler bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor10"></a> <span data-ttu-id="1ca3d-173">ActiveX denetimi sorunları</span><span class="sxs-lookup"><span data-stu-id="1ca3d-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="1ca3d-174">Visual Basic 6.0 ile iş çoğu ActiveX denetimlerini sorun Visual Basic .NET ile birlikte çalışır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="1ca3d-175">Ana kapsayıcı denetimleri veya görsel olarak diğer denetimleri içeren denetimler durumlardır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="1ca3d-176">Visual Studio ile düzgün çalışmıyor eski denetimleri bazı örnekleri şunlardır:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-176">Some examples of older controls that do not work correctly with Visual Studio are as follows:</span></span>  
  
-   <span data-ttu-id="1ca3d-177">Microsoft Forms 2.0 çerçeve denetimi</span><span class="sxs-lookup"><span data-stu-id="1ca3d-177">Microsoft Forms 2.0 Frame control</span></span>  
  
-   <span data-ttu-id="1ca3d-178">Yukarı-Aşağı denetimi döndürme denetimi olarak da bilinir</span><span class="sxs-lookup"><span data-stu-id="1ca3d-178">Up-Down control, also known as the spin control</span></span>  
  
-   <span data-ttu-id="1ca3d-179">Sheridan sekme denetimi</span><span class="sxs-lookup"><span data-stu-id="1ca3d-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="1ca3d-180">Desteklenmeyen ActiveX denetimi sorunları için yalnızca birkaç geçici çözümler vardır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="1ca3d-181">Özgün kaynak kodunun sahipseniz Visual Studio için mevcut denetimleri geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-181">You can migrate existing controls to Visual Studio if you own the original source code.</span></span> <span data-ttu-id="1ca3d-182">Aksi durumda, güncelleştirilmiş yazılım satıcıları ile denetleyebilirsiniz. NET uyumlu sürümlerini değiştirmek için denetimleri ActiveX denetimlerini desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor11"></a> <span data-ttu-id="1ca3d-183">Denetimleri ByRef geçirme ReadOnly özellikleri</span><span class="sxs-lookup"><span data-stu-id="1ca3d-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="1ca3d-184">Visual Basic .NET, geçirdiğinizde COM hataları gibi "Hata 0x800A017F CTL_E_SETNOTSUPPORTED" bazen başlatır `ReadOnly` bazı eski ActiveX denetimleri olarak özelliklerini `ByRef` diğer yordamlar için parametreler.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="1ca3d-185">Visual Basic 6.0 benzer yordam çağrıları hata yükseltmeyin ve değerine göre geçirilen gibi parametreleri kabul edilir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="1ca3d-186">Bir özellik olmayan bir özellik değiştirmeye çalıştığınız Visual Basic .NET hata iletisi gösterir `Set` yordamı.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="1ca3d-187">Çağrılan yordamı erişiminiz varsa, kullanarak bu hatayı önleyebilirsiniz `ByVal` kabul parametreleri bildirmek için anahtar sözcüğü `ReadOnly` özellikleri.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="1ca3d-188">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]  
  
 <span data-ttu-id="1ca3d-189">Çağrılan yordamı için kaynak koduna erişim yoksa özelliğini parantezler GetTypeId yordamını içinde ek bir dizi ekleyerek değere göre geçirilecek şekilde zorlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="1ca3d-190">Örneğin, Microsoft ActiveX veri nesneleri 2.8 kitaplığı COM nesneye bir başvurusu olan bir proje ile kullanabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="1ca3d-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor12"></a> <span data-ttu-id="1ca3d-191">Birlikte çalışma kullanıma derlemeleri dağıtma</span><span class="sxs-lookup"><span data-stu-id="1ca3d-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="1ca3d-192">COM arabirimleri kullanıma derlemeleri dağıtma benzersiz zorluklara gösterir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="1ca3d-193">Örneğin, ayrı uygulamalar aynı COM bütünleştirilmiş koda başvurduğunuzda olası bir sorun oluşur.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="1ca3d-194">Bu durum, bir derlemeyi yeni bir sürümü yüklü olduğundan ve başka bir uygulama derleme eski sürümünü kullanmaya devam yaygındır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="1ca3d-195">DLL paylaşan derleme kaldırırsanız, kasıtsız olarak bunu kullanılamaz için diğer derlemelerden duruma getirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="1ca3d-196">Bu sorunu önlemek için paylaşılan derlemeleri genel derleme önbelleği (GAC) yükleyin ve bir MergeModule bileşeni için kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="1ca3d-197">GAC içinde uygulama yükleyemiyorsanız sürüme özgü alt dizinindeki Commonfılesfolder için yüklenmelidir.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="1ca3d-198">Paylaşılmayan derlemeler, çağıran uygulama ile dizinde yan yana bulunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1ca3d-199">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="1ca3d-199">See Also</span></span>  
 <xref:System.Runtime.InteropServices.MarshalAsAttribute>  
 [<span data-ttu-id="1ca3d-200">COM Birlikte Çalışma</span><span class="sxs-lookup"><span data-stu-id="1ca3d-200">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="1ca3d-201">Tlbimp.exe (Tür Kitaplığı İçeri Aktarıcı)</span><span class="sxs-lookup"><span data-stu-id="1ca3d-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)  
 [<span data-ttu-id="1ca3d-202">Tlbexp.exe (Tür Kitaplığı Dışarı Aktarıcı)</span><span class="sxs-lookup"><span data-stu-id="1ca3d-202">Tlbexp.exe (Type Library Exporter)</span></span>](http://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d)  
 [<span data-ttu-id="1ca3d-203">İzlenecek yol: COM Nesnelerinde Kalıtım Uygulama</span><span class="sxs-lookup"><span data-stu-id="1ca3d-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)  
 [<span data-ttu-id="1ca3d-204">Inherits Deyimi</span><span class="sxs-lookup"><span data-stu-id="1ca3d-204">Inherits Statement</span></span>](../../../visual-basic/language-reference/statements/inherits-statement.md)  
 [<span data-ttu-id="1ca3d-205">Genel Derleme Önbelleği</span><span class="sxs-lookup"><span data-stu-id="1ca3d-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
