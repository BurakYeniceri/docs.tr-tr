---
title: "Dinamik tür oluşturma için collectible derlemeler"
description: 
ms.date: 08/29/2017
ms.prod: .net
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- reflection, dynamic assembly
- assemblies, collectible
- collectible assemblies, retrieving
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 0756fe317469898dd165e55be7125922f5b692f7
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/22/2017
---
# <a name="collectible-assemblies-for-dynamic-type-generation"></a><span data-ttu-id="e55a6-102">Dinamik tür oluşturma için collectible derlemeler</span><span class="sxs-lookup"><span data-stu-id="e55a6-102">Collectible assemblies for dynamic type generation</span></span>

<span data-ttu-id="e55a6-103">*Collectible derlemeleri* , oluşturuldukları uygulama etki alanı kaldırılması olmadan kaldırılamıyor dinamik derlemeler.</span><span class="sxs-lookup"><span data-stu-id="e55a6-103">*Collectible assemblies* are dynamic assemblies that can be unloaded without unloading the application domain in which they were created.</span></span> <span data-ttu-id="e55a6-104">Collectible derleme ve içerdiği türleri tarafından kullanılan tüm yönetilen ve yönetilmeyen bellek istenemiyor.</span><span class="sxs-lookup"><span data-stu-id="e55a6-104">All managed and unmanaged memory used by a collectible assembly and the types it contains can be reclaimed.</span></span> <span data-ttu-id="e55a6-105">Derleme adı gibi bilgileri iç tablodan kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="e55a6-105">Information such as the assembly name is removed from internal tables.</span></span>

<span data-ttu-id="e55a6-106">Eklentiyi etkinleştirmek için <xref:System.Reflection.Emit.AssemblyBuilderAccess.RunAndCollect?displayProperty=nameWithType> bir dinamik derleme oluşturduğunuzda bayrak.</span><span class="sxs-lookup"><span data-stu-id="e55a6-106">To enable unloading, use the <xref:System.Reflection.Emit.AssemblyBuilderAccess.RunAndCollect?displayProperty=nameWithType> flag when you create a dynamic assembly.</span></span> <span data-ttu-id="e55a6-107">Geçici bir derlemedir (diğer bir deyişle, kaydedilemez) ve açıklanan sınırlamalara tabidir [Collectible derlemeler kısıtlamalar](#restrictions-on-collectible-assemblies) bölümü.</span><span class="sxs-lookup"><span data-stu-id="e55a6-107">The assembly is transient (that is, it cannot be saved) and is subject to limitations described in the [Restrictions on Collectible Assemblies](#restrictions-on-collectible-assemblies) section.</span></span> <span data-ttu-id="e55a6-108">Derleme ile ilişkili tüm nesneleri serbest bıraktığınızda ortak dil çalışma zamanı (CLR) collectible derleme otomatik olarak kaldırır.</span><span class="sxs-lookup"><span data-stu-id="e55a6-108">The common language runtime (CLR) unloads a collectible assembly automatically when you release all objects associated with the assembly.</span></span> <span data-ttu-id="e55a6-109">Tüm diğer yönden collectible derlemeler oluşturulur ve diğer dinamik derlemeleri aynı şekilde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="e55a6-109">In all other respects, collectible assemblies are created and used in the same way as other dynamic assemblies.</span></span>

## <a name="lifetime-of-collectible-assemblies"></a><span data-ttu-id="e55a6-110">Collectible derlemeler ömrü</span><span class="sxs-lookup"><span data-stu-id="e55a6-110">Lifetime of collectible assemblies</span></span>

<span data-ttu-id="e55a6-111">Collectible derleme ömrü içerdiği türleri ve bu türlerden oluşturulan nesneleri başvuruları varlığını tarafından denetlenir.</span><span class="sxs-lookup"><span data-stu-id="e55a6-111">The lifetime of a collectible assembly is controlled by the existence of references to the types it contains and the objects that are created from those types.</span></span> <span data-ttu-id="e55a6-112">Bir veya daha fazlasını mevcut olduğu sürece ortak dil çalışma zamanı bütünleştirilmiş kaldırmaz (`T` derlemede tanımlanan herhangi bir tür):</span><span class="sxs-lookup"><span data-stu-id="e55a6-112">The common language runtime does not unload an assembly as long as one or more of the following exist (`T` is any type that is defined in the assembly):</span></span> 

- <span data-ttu-id="e55a6-113">Örneği `T`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-113">An instance of `T`.</span></span>

- <span data-ttu-id="e55a6-114">Bir dizi örneği `T`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-114">An instance of an array of `T`.</span></span>
 
- <span data-ttu-id="e55a6-115">Sahip genel bir tür örneği `T` , tür bağımsız değişkenleri biri olarak.</span><span class="sxs-lookup"><span data-stu-id="e55a6-115">An instance of a generic type that has `T` as one of its type arguments.</span></span> <span data-ttu-id="e55a6-116">Bu genel koleksiyonları içerir `T`, o koleksiyonu boş olsa bile.</span><span class="sxs-lookup"><span data-stu-id="e55a6-116">This includes generic collections of `T`, even if that collection is empty.</span></span>

- <span data-ttu-id="e55a6-117">Örneği <xref:System.Type> veya <xref:System.Reflection.Emit.TypeBuilder> temsil eden `T`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-117">An instance of <xref:System.Type> or <xref:System.Reflection.Emit.TypeBuilder> that represents `T`.</span></span> 

   > [!IMPORTANT]
   > <span data-ttu-id="e55a6-118">Derleme bölümlerini temsil eden tüm nesneleri serbest bırakmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e55a6-118">You must release all objects that represent parts of the assembly.</span></span> <span data-ttu-id="e55a6-119"><xref:System.Reflection.Emit.ModuleBuilder> Tanımlayan `T` bir başvuru <xref:System.Reflection.Emit.TypeBuilder>ve <xref:System.Reflection.Emit.AssemblyBuilder> nesne başvuru tutar <xref:System.Reflection.Emit.ModuleBuilder>, bu nesnelerin referansları yayımlanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="e55a6-119">The <xref:System.Reflection.Emit.ModuleBuilder> that defines `T` keeps a reference to the <xref:System.Reflection.Emit.TypeBuilder>, and the <xref:System.Reflection.Emit.AssemblyBuilder> object keeps a reference to the <xref:System.Reflection.Emit.ModuleBuilder>, so references to these objects must be released.</span></span> <span data-ttu-id="e55a6-120">Hatta varlığını bir <xref:System.Reflection.Emit.LocalBuilder> veya bir <xref:System.Reflection.Emit.ILGenerator> yapımı içinde kullanılan `T` kaldırılmasını engeller.</span><span class="sxs-lookup"><span data-stu-id="e55a6-120">Even the existence of a <xref:System.Reflection.Emit.LocalBuilder> or an <xref:System.Reflection.Emit.ILGenerator> used in the construction of `T` prevents unloading.</span></span>

- <span data-ttu-id="e55a6-121">Statik başvuru `T` başka bir dinamik olarak tanımlanan türü tarafından `T1` olan hala erişilebilir kodu yürüterek.</span><span class="sxs-lookup"><span data-stu-id="e55a6-121">A static reference to `T` by another dynamically defined type `T1` that is still reachable by executing code.</span></span> <span data-ttu-id="e55a6-122">Örneğin, `T1` öğesinden türetilen `T`, veya `T` bir yöntem parametresinde tür olabilir `T1`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-122">For example, `T1` might derive from `T`, or `T` might be the type of a parameter in a method of `T1`.</span></span>
 
- <span data-ttu-id="e55a6-123">A **ByRef** ait statik bir alana `T`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-123">A **ByRef** to a static field that belongs to `T`.</span></span>

- <span data-ttu-id="e55a6-124">A <xref:System.RuntimeTypeHandle>, <xref:System.RuntimeFieldHandle>, veya <xref:System.RuntimeMethodHandle> , başvurduğu `T` veya bir bileşeninin `T`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-124">A <xref:System.RuntimeTypeHandle>, <xref:System.RuntimeFieldHandle>, or <xref:System.RuntimeMethodHandle> that refers to `T` or to a component of `T`.</span></span>

- <span data-ttu-id="e55a6-125">Bir örneği erişmek için doğrudan veya dolaylı olarak kullanılabilecek herhangi bir yansıma nesnenin <xref:System.Type> temsil eden nesnesi `T`.</span><span class="sxs-lookup"><span data-stu-id="e55a6-125">An instance of any reflection object that could be used indirectly or directly to access the <xref:System.Type> object that represents `T`.</span></span> <span data-ttu-id="e55a6-126">Örneğin, <xref:System.Type> için nesne `T` öğe türü olan bir dizi türünden alınan `T`, veya sahip genel bir tür `T` tür bağımsız değişkeni olarak.</span><span class="sxs-lookup"><span data-stu-id="e55a6-126">For example, the <xref:System.Type> object for `T` can be obtained from an array type whose element type is `T`, or from a generic type that has `T` as a type argument.</span></span> 

- <span data-ttu-id="e55a6-127">Bir yöntem `M` tüm iş parçacığının çağrı yığınında nerede `M` bir yöntemi `T` veya derlemede tanımlanan bir modül düzeyi yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e55a6-127">A method `M` on the call stack of any thread, where `M` is a method of `T` or a module-level method that is defined in the assembly.</span></span>

- <span data-ttu-id="e55a6-128">Derlemenin modülde tanımlanmış bir statik yöntem için temsilci.</span><span class="sxs-lookup"><span data-stu-id="e55a6-128">A delegate to a static method that is defined in a module of the assembly.</span></span>

<span data-ttu-id="e55a6-129">Yalnızca tek bir tür ya da derlemesindeki bir yöntemi için bu listeden bir öğe varsa, çalışma zamanı derlemesi kaldıramıyor.</span><span class="sxs-lookup"><span data-stu-id="e55a6-129">If only one item from this list exists for only one type or one method in the assembly, the runtime cannot unload the assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="e55a6-130">Listedeki tüm öğelerin sonlandırıcılar çalıştırılana kadar çalışma zamanı derlemesi gerçekte kaldırmaz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-130">The runtime does not actually unload the assembly until finalizers have run for all items in the list.</span></span>

<span data-ttu-id="e55a6-131">İzleme ömrü amaçları doğrultusunda, oluşturulan genel türü gibi `List<int>` (C# ' ta) veya `List(Of Integer)` (Visual Basic'te), oluşturulur ve kullanılan collectible derleme nesil silinmiş kabul derlemede tanımlanmış, Genel içeren tanımı yazın veya bir derleme, tür bağımsız değişkenleri birini tanımını içeren.</span><span class="sxs-lookup"><span data-stu-id="e55a6-131">For purposes of tracking lifetime, a constructed generic type such as `List<int>` (in C#) or `List(Of Integer)` (in Visual Basic) that is created and used in the generation of a collectible assembly is considered to have been defined either in the assembly that contains the generic type definition or in an assembly that contains the definition of one of its type arguments.</span></span> <span data-ttu-id="e55a6-132">Kullanılan tam bir uygulama ayrıntılarını ve değiştirmek için konu derlemesidir.</span><span class="sxs-lookup"><span data-stu-id="e55a6-132">The exact assembly that is used is an implementation detail and subject to change.</span></span>
 
## <a name="restrictions-on-collectible-assemblies"></a><span data-ttu-id="e55a6-133">Kısıtlamaları collectible derlemeler hakkında</span><span class="sxs-lookup"><span data-stu-id="e55a6-133">Restrictions on collectible assemblies</span></span>

<span data-ttu-id="e55a6-134">Collectible derlemeler için aşağıdaki kısıtlamalar geçerlidir:</span><span class="sxs-lookup"><span data-stu-id="e55a6-134">The following restrictions apply to collectible assemblies:</span></span> 

- <span data-ttu-id="e55a6-135">**Statik başvuruları** </span><span class="sxs-lookup"><span data-stu-id="e55a6-135">**Static references** </span></span>  
  <span data-ttu-id="e55a6-136">Sıradan dinamik derlemedeki türleri collectible bir derlemede tanımlanan türlerine statik başvuruları sahip olamaz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-136">Types in an ordinary dynamic assembly cannot have static references to types that are defined in a collectible assembly.</span></span> <span data-ttu-id="e55a6-137">Örneğin, bir collectible derlemesindeki türünden devralan bir sıradan türü tanımlarsanız bir <xref:System.NotSupportedException> özel durumu oluşur.</span><span class="sxs-lookup"><span data-stu-id="e55a6-137">For example, if you define an ordinary type that inherits from a type in a collectible assembly, a <xref:System.NotSupportedException> exception is thrown.</span></span> <span data-ttu-id="e55a6-138">Collectible derlemesindeki bir türü statik başvuru türü için başka bir collectible derlemede sahip olabilir, ancak bu başvurulan derlemeyi başvuran derlemenin ömrü için ömrü genişletir.</span><span class="sxs-lookup"><span data-stu-id="e55a6-138">A type in a collectible assembly can have static references to a type in another collectible assembly, but this extends the lifetime of the referenced assembly to the lifetime of the referencing assembly.</span></span>

- <span data-ttu-id="e55a6-139">**COM birlikte çalışma** </span><span class="sxs-lookup"><span data-stu-id="e55a6-139">**COM interop** </span></span>  
   <span data-ttu-id="e55a6-140">COM arabirimleri collectible bir derlemede tanımlanmış olması ve COM nesnelerini collectible derleme içinde tür hiçbir örneği dönüştürülebilir.</span><span class="sxs-lookup"><span data-stu-id="e55a6-140">No COM interfaces can be defined within a collectible assembly, and no instances of types within a collectible assembly can be converted into COM objects.</span></span> <span data-ttu-id="e55a6-141">Bir tür collectible derlemesindeki COM aranabilir sarmalayıcısı (saat) veya çalışma zamanı aranabilir sarmalayıcısı (RCW) olarak sunulamıyor.</span><span class="sxs-lookup"><span data-stu-id="e55a6-141">A type in a collectible assembly cannot serve as a COM callable wrapper (CCW) or runtime callable wrapper (RCW).</span></span> <span data-ttu-id="e55a6-142">Ancak, collectible derlemelerindeki COM arabirimleri uygulayan nesneler kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-142">However, types in collectible assemblies can use objects that implement COM interfaces.</span></span>

- <span data-ttu-id="e55a6-143">**Platform çağırma** </span><span class="sxs-lookup"><span data-stu-id="e55a6-143">**Platform invoke** </span></span>  
   <span data-ttu-id="e55a6-144">Sahip yöntemleri <xref:System.Runtime.InteropServices.DllImportAttribute> öznitelik collectible derlemesinde bildirirken derlenmez.</span><span class="sxs-lookup"><span data-stu-id="e55a6-144">Methods that have the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute will not compile when they are declared in a collectible assembly.</span></span> <span data-ttu-id="e55a6-145"><xref:System.Reflection.Emit.OpCodes.Calli?displayProperty=nameWithType> Yönerge collectible derlemesindeki bir türü uyarlamasını kullanılamaz ve bu tür türler yönetilmeyen koda sıralanamaz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-145">The <xref:System.Reflection.Emit.OpCodes.Calli?displayProperty=nameWithType> instruction cannot be used in the implementation of a type in a collectible assembly, and such types cannot be marshaled to unmanaged code.</span></span> <span data-ttu-id="e55a6-146">Ancak, collectible olmayan bir derlemede bildirilmiş bir giriş noktasını kullanarak yerel kod içine çağırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-146">However, you can call into native code by using an entry point that is declared in a non-collectible assembly.</span></span>
 
- <span data-ttu-id="e55a6-147">**Hazırlama** </span><span class="sxs-lookup"><span data-stu-id="e55a6-147">**Marshaling** </span></span>  
   <span data-ttu-id="e55a6-148">Collectible derlemede tanımlanan nesneler (özellikle, temsilcileri) sıralanamaz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-148">Objects (in particular, delegates) that are defined in collectible assemblies cannot be marshaled.</span></span> <span data-ttu-id="e55a6-149">Bu, tüm geçici verilmiş türler bir kısıtlamadır.</span><span class="sxs-lookup"><span data-stu-id="e55a6-149">This is a restriction on all transient emitted types.</span></span>

- <span data-ttu-id="e55a6-150">**Derleme yükleme** </span><span class="sxs-lookup"><span data-stu-id="e55a6-150">**Assembly loading** </span></span>  
   <span data-ttu-id="e55a6-151">Yansıma yayma collectible derlemeleri yükleme için desteklenen tek mekanizmadır.</span><span class="sxs-lookup"><span data-stu-id="e55a6-151">Reflection emit is the only mechanism that is supported for loading collectible assemblies.</span></span> <span data-ttu-id="e55a6-152">Herhangi bir biçimde yüklenmesi derlemenin kullanılarak yüklenen derlemeler kaldırılamıyor.</span><span class="sxs-lookup"><span data-stu-id="e55a6-152">Assemblies that are loaded by using any other form of assembly loading cannot be unloaded.</span></span>
 
- <span data-ttu-id="e55a6-153">**Bağlam bağımlı nesneler**  </span><span class="sxs-lookup"><span data-stu-id="e55a6-153">**Context-bound objects**  </span></span>  
   <span data-ttu-id="e55a6-154">Statik içerik değişkenleri desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="e55a6-154">Context-static variables are not supported.</span></span> <span data-ttu-id="e55a6-155">Olamaz collectible derlemesindeki türler genişletmek <xref:System.ContextBoundObject>.</span><span class="sxs-lookup"><span data-stu-id="e55a6-155">Types in a collectible assembly cannot extend <xref:System.ContextBoundObject>.</span></span> <span data-ttu-id="e55a6-156">Ancak, kod collectible derlemelerde tanımlanan bağlam bağımlı nesneleri başka bir yerde kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-156">However, code in collectible assemblies can use context-bound objects that are defined elsewhere.</span></span>

- <span data-ttu-id="e55a6-157">**İş parçacığı statik verileri**     </span><span class="sxs-lookup"><span data-stu-id="e55a6-157">**Thread-static data**     </span></span>  
   <span data-ttu-id="e55a6-158">İş parçacığı statik değişkenler desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="e55a6-158">Thread-static variables are not supported.</span></span>

## <a name="see-also"></a><span data-ttu-id="e55a6-159">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="e55a6-159">See also</span></span>

[<span data-ttu-id="e55a6-160">Dinamik Yöntemleri ve Derlemeleri Yayma</span><span class="sxs-lookup"><span data-stu-id="e55a6-160">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
