---
title: "DDD mikro hizmet eShopOnContainers içinde uygulanan CQRS ve CQS yaklaşımlar"
description: "Kapsayıcılı .NET uygulamaları için .NET mikro mimarisi | DDD mikro hizmet eShopOnContainers içinde uygulanan CQRS ve CQS yaklaşımlar"
keywords: "Docker, mikro, ASP.NET, kapsayıcı"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: a2c4429a75ca47d4fbcde868b95e76bc65ea2bef
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/18/2017
---
# <a name="applying-cqrs-and-cqs-approaches-in-a-ddd-microservice-in-eshoponcontainers"></a><span data-ttu-id="e0010-104">DDD mikro hizmet eShopOnContainers içinde uygulanan CQRS ve CQS yaklaşımlar</span><span class="sxs-lookup"><span data-stu-id="e0010-104">Applying CQRS and CQS approaches in a DDD microservice in eShopOnContainers</span></span>

<span data-ttu-id="e0010-105">Sıralama mikro hizmet eShopOnContainers başvuru uygulama tasarımını CQRS kurallara göre temel alır.</span><span class="sxs-lookup"><span data-stu-id="e0010-105">The design of the ordering microservice at the eShopOnContainers reference application is based on CQRS principles.</span></span> <span data-ttu-id="e0010-106">Ancak, yalnızca sorguları komutları ayırmak ve hem eylemleri için aynı veritabanını kullanarak basit bir yaklaşım kullanır.</span><span class="sxs-lookup"><span data-stu-id="e0010-106">However, it uses the simplest approach, which is just separating the queries from the commands and using the same database for both actions.</span></span>

<span data-ttu-id="e0010-107">Bu düzenlere ve burada önemli olan nokta sorguların ıdempotent olduğundan olduğu: bir sistem, sistem durumu sorgu kaç kez değişmez olsun işlem mantığı "yazma" farklı "Okuma" veri modelinden bile kullanabilirsiniz Sıralama mikro aynı veritabanını kullanıyor olsa da etki alanı model.</span><span class="sxs-lookup"><span data-stu-id="e0010-107">The essence of those patterns, and the important point here, is that queries are idempotent: no matter how many times you query a system, the state of that system will not change You could even use a different “reads” data model than the transactional logic “writes” domain model, although the ordering microservices is using the same database.</span></span> <span data-ttu-id="e0010-108">Bu nedenle bu bir Basitleştirilmiş CQRS yaklaşımdır.</span><span class="sxs-lookup"><span data-stu-id="e0010-108">Hence this is a simplified CQRS approach.</span></span>

<span data-ttu-id="e0010-109">Diğer taraftan, işlemleri ve veri güncelleştirmelerini tetiklemek, komutları sistem durumunu değiştirin.</span><span class="sxs-lookup"><span data-stu-id="e0010-109">On the other hand, commands, which trigger transactions and data updates, change state in the system.</span></span> <span data-ttu-id="e0010-110">Komutları ile ne zaman dikkatli olmanız gerekir. ilgilenme karmaşıklık ve sürekli değişen iş kuralları.</span><span class="sxs-lookup"><span data-stu-id="e0010-110">With commands, you need to be careful when dealing with complexity and ever-changing business rules.</span></span> <span data-ttu-id="e0010-111">Bu yerdir bir daha iyi Modellenen sistem olacak şekilde DDD teknikleri uygulamak istiyor.</span><span class="sxs-lookup"><span data-stu-id="e0010-111">This is the where you want to apply DDD techniques to have a better modeled system.</span></span>

<span data-ttu-id="e0010-112">Bu kılavuzda sunulan DDD desenleri Evrensel uygulanmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="e0010-112">The DDD patterns presented in this guide should not be applied universally.</span></span> <span data-ttu-id="e0010-113">Bunlar tasarımınızı kısıtlamalar tanıtır.</span><span class="sxs-lookup"><span data-stu-id="e0010-113">They introduce constraints on your design.</span></span> <span data-ttu-id="e0010-114">Bu kısıtlamalar özellikle komutlar ve sistem durumunu değiştiren başka bir kod, zaman içinde daha yüksek kaliteli gibi yararlar sağlar.</span><span class="sxs-lookup"><span data-stu-id="e0010-114">Those constraints provide benefits such as higher quality over time, especially in commands and other code that modifies system state.</span></span> <span data-ttu-id="e0010-115">Ancak, bu kısıtlamalar okuma ve veri sorgulama için daha az avantajları ile karmaşıklık ekleyin.</span><span class="sxs-lookup"><span data-stu-id="e0010-115">However, those constraints add complexity with fewer benefits for reading and querying data.</span></span>

<span data-ttu-id="e0010-116">Bu tür bir desen daha sonraki bölümlerde inceleyeceğiz toplama düzeni ' dir.</span><span class="sxs-lookup"><span data-stu-id="e0010-116">One such pattern is the Aggregate pattern, which we examine more in later sections.</span></span> <span data-ttu-id="e0010-117">Kısaca, toplama modelinde, çok sayıda etki alanı nesnelerini ilişkilerini etki alanındaki bir sonucu olarak tek bir birim olarak kabul eder.</span><span class="sxs-lookup"><span data-stu-id="e0010-117">Briefly, in the Aggregate pattern, you treat many domain objects as a single unit as a result of their relationship in the domain.</span></span> <span data-ttu-id="e0010-118">Her zaman bu deseni sorgularda gelen avantajları elde değil; Sorgu mantığı karmaşıklığını artırabilir.</span><span class="sxs-lookup"><span data-stu-id="e0010-118">You might not always gain advantages from this pattern in queries; it can increase the complexity of query logic.</span></span> <span data-ttu-id="e0010-119">Salt okunur sorgular için birden fazla nesne tek bir toplama değerlendirmesini avantajları elde.</span><span class="sxs-lookup"><span data-stu-id="e0010-119">For read-only queries, you do not get the advantages of treating multiple objects as a single Aggregate.</span></span> <span data-ttu-id="e0010-120">Yalnızca karmaşıklığını Al</span><span class="sxs-lookup"><span data-stu-id="e0010-120">You only get the complexity.</span></span>

<span data-ttu-id="e0010-121">Şekil 9-2'de gösterildiği gibi bu kılavuzda DDD desenleri (diğer bir deyişle, komutları tarafından tetiklenen gibi) yalnızca, mikro işlem/güncelleştirme alanını kullanarak önerir.</span><span class="sxs-lookup"><span data-stu-id="e0010-121">As shown in Figure 9-2, this guide suggests using DDD patterns only in the transactional/updates area of your microservice (that is, as triggered by commands).</span></span> <span data-ttu-id="e0010-122">Sorguları basit bir yaklaşım takip edebilir ve CQRS yaklaşımı izleyerek komutlarından ayrılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="e0010-122">Queries can follow a simpler approach and should be separated from commands, following a CQRS approach.</span></span>

<span data-ttu-id="e0010-123">"Sorguları yan" uygulamak için Gelişmiş ORM EF çekirdek, AutoMapper projeksiyonları, saklı yordamlar, görünümler, gerçekleştirilmiş görünümler veya mikro ORM gibi gelen birçok yaklaşım arasından seçim yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e0010-123">For implementing the “queries side”, you can choose between many approaches, from your full-blown ORM like EF Core, AutoMapper projections, stored procedures, views, materialized views or a micro ORM.</span></span>

<span data-ttu-id="e0010-124">Bu kılavuz ve seçtik bir mikro kullanarak düz sorguları uygulamak için eShopOnContainers (özellikle sıralama mikro) ORM ister [Dapper](https://github.com/StackExchange/dapper-dot-net).</span><span class="sxs-lookup"><span data-stu-id="e0010-124">In this guide and in eShopOnContainers (specifically the ordering microservice) we chose to implement straight queries using a micro ORM like [Dapper](https://github.com/StackExchange/dapper-dot-net).</span></span> <span data-ttu-id="e0010-125">Bu bir açık çerçeve çok az ek yük sayesinde en iyi performansı elde için SQL deyimleri göre herhangi bir sorgu uygulamanıza olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="e0010-125">This lets you implement any query based on SQL statements to get the best performance, thanks to a light framework with very little overhead.</span></span>

<span data-ttu-id="e0010-126">Bu yaklaşım kullandığınızda, varlıklar bir SQL veritabanına nasıl kalıcı etkileyen herhangi bir güncelleştirme modelinizi de Dapper veya sorgulamak için tüm diğer ayrı (EF olmayan) yaklaşımlar tarafından kullanılan SQL sorguları için ayrı güncelleştirmeler gerektiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="e0010-126">Note that when you use this approach, any updates to your model that impact how entities are persisted to a SQL database also need separate updates to SQL queries used by Dapper or any other separate (non-EF) approaches to querying.</span></span>

## <a name="cqrs-and-ddd-patterns-are-not-top-level-architectures"></a><span data-ttu-id="e0010-127">CQRS ve DDD desenleri en üst düzey mimari değildir</span><span class="sxs-lookup"><span data-stu-id="e0010-127">CQRS and DDD patterns are not top-level architectures</span></span>

<span data-ttu-id="e0010-128">Bu CQRS ve çoğu DDD desenleri (DDD Katmanlar veya toplamalar olan bir etki alanı modeli gibi) anlamak önemlidir, olmayan mimari stiller, ancak yalnızca mimarisi desenleri.</span><span class="sxs-lookup"><span data-stu-id="e0010-128">It important to understand that CQRS and most DDD patterns (like DDD layers or a domain model with aggregates) are not architectural styles, but only architecture patterns.</span></span> <span data-ttu-id="e0010-129">Mikro, SOA ve olay denetimli mimarisi (EDA) mimari stilleri gösterilebilir.</span><span class="sxs-lookup"><span data-stu-id="e0010-129">Microservices, SOA, and event-driven architecture (EDA) are examples of architectural styles.</span></span> <span data-ttu-id="e0010-130">Bunlar, birçok mikro hizmetler gibi birçok bileşen bir sistem açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="e0010-130">They describe a system of many components, such as many microservices.</span></span> <span data-ttu-id="e0010-131">CQRS ve DDD desenleri bir şey tek sistem veya bileşen içinde açıklar; Bu durumda, bir mikro hizmet içinde bir şey.</span><span class="sxs-lookup"><span data-stu-id="e0010-131">CQRS and DDD patterns describe something inside a single system or component; in this case, something inside a microservice.</span></span>

<span data-ttu-id="e0010-132">Farklı ilişkisindeki bağlamları (BCs) farklı desenleri kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="e0010-132">Different Bounded Contexts (BCs) will employ different patterns.</span></span> <span data-ttu-id="e0010-133">Farklı sorumlulukları vardır ve farklı çözümler, yol açar.</span><span class="sxs-lookup"><span data-stu-id="e0010-133">They have different responsibilities, and that leads to different solutions.</span></span> <span data-ttu-id="e0010-134">Bu, her yerde hatasına neden olur aynı düzeni zorlama vurgulayan değer olur.</span><span class="sxs-lookup"><span data-stu-id="e0010-134">It is worth emphasizing that forcing the same pattern everywhere leads to failure.</span></span> <span data-ttu-id="e0010-135">CQRS ve DDD desenleri her yerde kullanmayın.</span><span class="sxs-lookup"><span data-stu-id="e0010-135">Do not use CQRS and DDD patterns everywhere.</span></span> <span data-ttu-id="e0010-136">Çok sayıda alt sistemleri, BCs veya mikro daha basit ve basit CRUD Hizmetleri daha kolay veya başka bir yaklaşım kullanarak uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="e0010-136">Many subsystems, BCs, or microservices are simpler and can be implemented more easily using simple CRUD services or using another approach.</span></span>

<span data-ttu-id="e0010-137">Yalnızca bir uygulama mimarisi vardır: Sistem veya uçtan uca uygulama mimarisi (örneğin, mikro mimarisi) tasarlıyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="e0010-137">There is only one application architecture: the architecture of the system or end-to-end application you are designing (for example, the microservices architecture).</span></span> <span data-ttu-id="e0010-138">Ancak, her ilişkisindeki bağlamı veya mikro hizmet, uygulama içinde tasarımını kendi dengelerin ve mimari desenleri düzeyinde bir iç tasarım kararları yansıtır.</span><span class="sxs-lookup"><span data-stu-id="e0010-138">However, the design of each Bounded Context or microservice within that application reflects its own tradeoffs and internal design decisions at an architecture patterns level.</span></span> <span data-ttu-id="e0010-139">Aynı mimari desenleri CQRS veya bbb gibi her yerde uygulamak çalışmayın.</span><span class="sxs-lookup"><span data-stu-id="e0010-139">Do not try to apply the same architectural patterns like CQRS or DDD everywhere.</span></span>

####  <a name="additional-resources"></a><span data-ttu-id="e0010-140">Ek kaynaklar</span><span class="sxs-lookup"><span data-stu-id="e0010-140">Additional resources</span></span>

-   <span data-ttu-id="e0010-141">**Martin Fowler. CQRS**
    [*https://martinfowler.com/bliki/CQRS.html*](https://martinfowler.com/bliki/CQRS.html)</span><span class="sxs-lookup"><span data-stu-id="e0010-141">**Martin Fowler. CQRS**
[*https://martinfowler.com/bliki/CQRS.html*](https://martinfowler.com/bliki/CQRS.html)</span></span>

-   <span data-ttu-id="e0010-142">**Greg Young. CQS vs. CQRS**
    [*http://codebetter.com/gregyoung/2009/08/13/command-query-separation/*](http://codebetter.com/gregyoung/2009/08/13/command-query-separation/)</span><span class="sxs-lookup"><span data-stu-id="e0010-142">**Greg Young. CQS vs. CQRS**
[*http://codebetter.com/gregyoung/2009/08/13/command-query-separation/*](http://codebetter.com/gregyoung/2009/08/13/command-query-separation/)</span></span>

-   <span data-ttu-id="e0010-143">**Greg Young. CQRS belgeleri**
    [*https://cqrs.files.wordpress.com/2010/11/cqrs\_documents.pdf*](https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf)</span><span class="sxs-lookup"><span data-stu-id="e0010-143">**Greg Young. CQRS Documents**
[*https://cqrs.files.wordpress.com/2010/11/cqrs\_documents.pdf*](https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf)</span></span>

-   <span data-ttu-id="e0010-144">**Greg Young. CQRS, görev tabanlı Uı'lar ve olay kaynak Hizmeti'nden**
    [*http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/*](http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/)</span><span class="sxs-lookup"><span data-stu-id="e0010-144">**Greg Young. CQRS, Task Based UIs and Event Sourcing**
[*http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/*](http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/)</span></span>

-   <span data-ttu-id="e0010-145">**UDI Dahan. Açıklığa kavuşturuldu CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="e0010-145">**Udi Dahan. Clarified CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="e0010-146">**CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="e0010-146">**CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="e0010-147">**Olay kaynak (ES)**
    [*http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/*](http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/)</span><span class="sxs-lookup"><span data-stu-id="e0010-147">**Event-Sourcing (ES)**
[*http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/*](http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="e0010-148">[Önceki] (apply-simplified-microservice-cqrs-ddd-patterns.md) [sonraki] (cqrs mikro hizmet reads.md)</span><span class="sxs-lookup"><span data-stu-id="e0010-148">[Previous] (apply-simplified-microservice-cqrs-ddd-patterns.md) [Next] (cqrs-microservice-reads.md)</span></span>
