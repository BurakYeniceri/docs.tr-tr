---
title: "İzlenecek yol: Windows API'larını Çağırma (Visual Basic)"
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- DLLs, calling
- Windows API, walkthroughs
- platform invoke, walkthroughs
- API calls [Visual Basic], walkthroughs [Visual Basic]
- Windows API, calling
- walkthroughs [Visual Basic], API calls
- DllImport attribute, calling Windows API
- Declare statement [Visual Basic], declaring DLL functions
ms.assetid: 9280ca96-7a93-47a3-8d01-6d01be0657cb
caps.latest.revision: "20"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: d494ad0f8bd4eb0dac57de214064fd2d208011ff
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/21/2017
---
# <a name="walkthrough-calling-windows-apis-visual-basic"></a><span data-ttu-id="52a06-102">İzlenecek yol: Windows API'larını Çağırma (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="52a06-102">Walkthrough: Calling Windows APIs (Visual Basic)</span></span>
<span data-ttu-id="52a06-103">Windows, Windows işletim sisteminin parçası olan dinamik bağlantı kitaplıklarını (DLL'ler) apı'leridir.</span><span class="sxs-lookup"><span data-stu-id="52a06-103">Windows APIs are dynamic-link libraries (DLLs) that are part of the Windows operating system.</span></span> <span data-ttu-id="52a06-104">Bunları kendi eşdeğer yordamları yazmak zor olduğu durumlarda görevleri gerçekleştirmek için kullanın.</span><span class="sxs-lookup"><span data-stu-id="52a06-104">You use them to perform tasks when it is difficult to write equivalent procedures of your own.</span></span> <span data-ttu-id="52a06-105">Örneğin, Windows adlı bir işlev sağlar `FlashWindowEx` olanak tanıyan bir uygulama için başlık çubuğu açık ve koyu gri arasında alternatif olun.</span><span class="sxs-lookup"><span data-stu-id="52a06-105">For example, Windows provides a function named `FlashWindowEx` that lets you make the title bar for an application alternate between light and dark shades.</span></span>  
  
 <span data-ttu-id="52a06-106">Windows API'ları kodunuzda kullanmanın avantajı, zaten yazılır yararlı işlevleri onlarca ve kullanılacak bekleme içerdiğinden bunlar geliştirme zaman kazanabilirsiniz ' dir.</span><span class="sxs-lookup"><span data-stu-id="52a06-106">The advantage of using Windows APIs in your code is that they can save development time because they contain dozens of useful functions that are already written and waiting to be used.</span></span> <span data-ttu-id="52a06-107">Windows API ile ve unforgiving şeyler ters gittiğinde iş zor olabilir olumsuz olur.</span><span class="sxs-lookup"><span data-stu-id="52a06-107">The disadvantage is that Windows APIs can be difficult to work with and unforgiving when things go wrong.</span></span>  
  
 <span data-ttu-id="52a06-108">Windows API'ları birlikte çalışabilirlik özel kategorisini temsil eder.</span><span class="sxs-lookup"><span data-stu-id="52a06-108">Windows APIs represent a special category of interoperability.</span></span> <span data-ttu-id="52a06-109">Windows API'ları, yönetilen kod kullanmaz, tür kitaplıkları ve Visual Studio ile kullanılanlardan farklı veri türlerini kullanan yerleşik sahip değil.</span><span class="sxs-lookup"><span data-stu-id="52a06-109">Windows APIs do not use managed code, do not have built-in type libraries, and use data types that are different than those used with Visual Studio.</span></span> <span data-ttu-id="52a06-110">Bu farklılıklar nedeniyle ve Windows API'ları COM nesneleri, Windows API ile birlikte çalışabilirlik olmadığından ve [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] platformu kullanılarak gerçekleştirilen çağırma, veya PInvoke.</span><span class="sxs-lookup"><span data-stu-id="52a06-110">Because of these differences, and because Windows APIs are not COM objects, interoperability with Windows APIs and the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] is performed using platform invoke, or PInvoke.</span></span> <span data-ttu-id="52a06-111">Platform çağırma etkinleştirir DLL'lerde uygulanan yönetilmeyen işlevleri çağırmak için kodu yönetilen bir hizmettir.</span><span class="sxs-lookup"><span data-stu-id="52a06-111">Platform invoke is a service that enables managed code to call unmanaged functions implemented in DLLs.</span></span> <span data-ttu-id="52a06-112">Daha fazla bilgi için bkz: [yönetilmeyen DLL işlevlerini kullanma](../../../framework/interop/consuming-unmanaged-dll-functions.md).</span><span class="sxs-lookup"><span data-stu-id="52a06-112">For more information, see [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md).</span></span> <span data-ttu-id="52a06-113">İçinde PInvoke kullanabilirsiniz [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] kullanarak ya da `Declare` bildirimi veya uygulama `DllImport` özniteliği için boş bir yordamı.</span><span class="sxs-lookup"><span data-stu-id="52a06-113">You can use PInvoke in [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] by using either the `Declare` statement or applying the `DllImport` attribute to an empty procedure.</span></span>  
  
 <span data-ttu-id="52a06-114">Windows API çağrıları önemli bir parçası olan [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] geçmişte programlama, ancak nadiren Visual Basic .NET ile gereklidir.</span><span class="sxs-lookup"><span data-stu-id="52a06-114">Windows API calls were an important part of [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] programming in the past, but are seldom necessary with Visual Basic .NET.</span></span> <span data-ttu-id="52a06-115">Mümkün olduğunda, yönetilen koddan kullanması gereken [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Windows API çağrıları yerine görevleri gerçekleştirmek için.</span><span class="sxs-lookup"><span data-stu-id="52a06-115">Whenever possible, you should use managed code from the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] to perform tasks, instead of Windows API calls.</span></span> <span data-ttu-id="52a06-116">Bu kılavuzda hangi kullanarak bu durumlar için bilgiler sağlar Windows API'ları gereklidir.</span><span class="sxs-lookup"><span data-stu-id="52a06-116">This walkthrough provides information for those situations in which using Windows APIs is necessary.</span></span>  
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="api-calls-using-declare"></a><span data-ttu-id="52a06-117">API çağrıları kullanarak bildirme</span><span class="sxs-lookup"><span data-stu-id="52a06-117">API Calls Using Declare</span></span>  
 <span data-ttu-id="52a06-118">Windows API'leri çağırmak için en yaygın yolu kullanmaktır `Declare` deyimi.</span><span class="sxs-lookup"><span data-stu-id="52a06-118">The most common way to call Windows APIs is by using the `Declare` statement.</span></span>  
  
#### <a name="to-declare-a-dll-procedure"></a><span data-ttu-id="52a06-119">DLL yordamı bildirmek için</span><span class="sxs-lookup"><span data-stu-id="52a06-119">To declare a DLL procedure</span></span>  
  
1.  <span data-ttu-id="52a06-120">Aramak istediğiniz işlevi artı bağımsız değişkenler, bağımsız değişken türleri adını belirlemek ve değeri yanı sıra adını ve konumunu içerdiği DLL döndürür.</span><span class="sxs-lookup"><span data-stu-id="52a06-120">Determine the name of the function you want to call, plus its arguments, argument types, and return value, as well as the name and location of the DLL that contains it.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="52a06-121">Windows API'ları hakkında tam bilgi için Platform SDK Windows API içinde Win32 SDK belgelerine bakın.</span><span class="sxs-lookup"><span data-stu-id="52a06-121">For complete information about the Windows APIs, see the Win32 SDK documentation in the Platform SDK Windows API.</span></span> <span data-ttu-id="52a06-122">Windows API'leri kullanan sabitleri hakkında daha fazla bilgi için Platform SDK'sı ile dahil Windows.h gibi üstbilgi dosyalarını inceleyin.</span><span class="sxs-lookup"><span data-stu-id="52a06-122">For more information about the constants that Windows APIs use, examine the header files such as Windows.h included with the Platform SDK.</span></span>  
  
2.  <span data-ttu-id="52a06-123">Yeni bir Windows uygulama projesi tıklatarak **yeni** üzerinde **dosya** menüsüne ve ardından **proje**.</span><span class="sxs-lookup"><span data-stu-id="52a06-123">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="52a06-124">**Yeni proje** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-124">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="52a06-125">Seçin **Windows uygulaması** listesinden [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] proje şablonları.</span><span class="sxs-lookup"><span data-stu-id="52a06-125">Select **Windows Application** from the list of [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] project templates.</span></span> <span data-ttu-id="52a06-126">Yeni Proje görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-126">The new project is displayed.</span></span>  
  
4.  <span data-ttu-id="52a06-127">Aşağıdakileri ekleyin `Declare` sınıfı veya modül DLL kullanmak istediğiniz işlev:</span><span class="sxs-lookup"><span data-stu-id="52a06-127">Add the following `Declare` function either to the class or module in which you want to use the DLL:</span></span>  
  
     [!code-vb[VbVbalrInterop#9](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_1.vb)]  
  
### <a name="parts-of-the-declare-statement"></a><span data-ttu-id="52a06-128">Bölümlerini Declare deyimi</span><span class="sxs-lookup"><span data-stu-id="52a06-128">Parts of the Declare Statement</span></span>  
 <span data-ttu-id="52a06-129">`Declare` Deyimi aşağıdaki öğeleri içerir.</span><span class="sxs-lookup"><span data-stu-id="52a06-129">The `Declare` statement includes the following elements.</span></span>  
  
#### <a name="auto-modifier"></a><span data-ttu-id="52a06-130">Otomatik değiştiricisi</span><span class="sxs-lookup"><span data-stu-id="52a06-130">Auto modifier</span></span>  
 <span data-ttu-id="52a06-131">`Auto` Değiştiricisi ortak dil çalışma zamanı kurallarını (veya belirtilen diğer ad) göre yöntemi adına dayalı dizeyi dönüştürmek için çalışma zamanı bildirir.</span><span class="sxs-lookup"><span data-stu-id="52a06-131">The `Auto` modifier instructs the runtime to convert the string based on the method name according to common language runtime rules (or alias name if specified).</span></span>  
  
#### <a name="lib-and-alias-keywords"></a><span data-ttu-id="52a06-132">LIB ve diğer anahtar sözcükler</span><span class="sxs-lookup"><span data-stu-id="52a06-132">Lib and Alias keywords</span></span>  
 <span data-ttu-id="52a06-133">Ad aşağıdaki `Function` anahtar sözcüğü, programınızın kullandığı alınan işlevine erişmek için adıdır.</span><span class="sxs-lookup"><span data-stu-id="52a06-133">The name following the `Function` keyword is the name your program uses to access the imported function.</span></span> <span data-ttu-id="52a06-134">Çağırdığınız işlevinin gerçek adıyla aynı olabilir ya da herhangi bir geçerli yordam adı ve ardından employ kullanabileceğiniz `Alias` anahtar çağırdığınız işlevi gerçek adını belirtin.</span><span class="sxs-lookup"><span data-stu-id="52a06-134">It can be the same as the real name of the function you are calling, or you can use any valid procedure name and then employ the `Alias` keyword to specify the real name of the function you are calling.</span></span>  
  
 <span data-ttu-id="52a06-135">Belirtin `Lib` anahtar sözcüğünü, çağırdığınız işlevi içeren dll Dosyasının konumunu ve adını.</span><span class="sxs-lookup"><span data-stu-id="52a06-135">Specify the `Lib` keyword, followed by the name and location of the DLL that contains the function you are calling.</span></span> <span data-ttu-id="52a06-136">Windows Sistem dizinlerde bulunan dosyaların yolunu belirtmeniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="52a06-136">You do not need to specify the path for files located in the Windows system directories.</span></span>  
  
 <span data-ttu-id="52a06-137">Kullanım `Alias` yoksa çağırdığınız işlevin adı geçerli bir anahtar sözcüğü [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] yordam adı ya da diğer öğeler, uygulamanızın adı ile çakışıyor.</span><span class="sxs-lookup"><span data-stu-id="52a06-137">Use the `Alias` keyword if the name of the function you are calling is not a valid [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] procedure name, or conflicts with the name of other items in your application.</span></span> <span data-ttu-id="52a06-138">`Alias`Çağrılan işlev doğru adını gösterir.</span><span class="sxs-lookup"><span data-stu-id="52a06-138">`Alias` indicates the true name of the function being called.</span></span>  
  
#### <a name="argument-and-data-type-declarations"></a><span data-ttu-id="52a06-139">Bağımsız değişken ve veri türü bildirimleri</span><span class="sxs-lookup"><span data-stu-id="52a06-139">Argument and Data Type Declarations</span></span>  
 <span data-ttu-id="52a06-140">Bağımsız değişkenler ve kendi veri türleri bildirin.</span><span class="sxs-lookup"><span data-stu-id="52a06-140">Declare the arguments and their data types.</span></span> <span data-ttu-id="52a06-141">Windows kullanan veri türleri Visual Studio veri türlerine karşılık gelmediğinden bu bölümü zor olabilir.</span><span class="sxs-lookup"><span data-stu-id="52a06-141">This part can be challenging because the data types that Windows uses do not correspond to Visual Studio data types.</span></span> [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)]<span data-ttu-id="52a06-142">çok fazla iş uyumlu veri türleri, adlı bir işlem bağımsız değişkenleri dönüştürerek sizin için yapar *hazırlama*.</span><span class="sxs-lookup"><span data-stu-id="52a06-142"> does a lot of the work for you by converting arguments to compatible data types, a process called *marshaling*.</span></span> <span data-ttu-id="52a06-143">Bağımsız değişkenler kullanarak nasıl sıralanmış açıkça kontrol edebilirsiniz <xref:System.Runtime.InteropServices.MarshalAsAttribute> tanımlanan öznitelik <xref:System.Runtime.InteropServices> ad alanı.</span><span class="sxs-lookup"><span data-stu-id="52a06-143">You can explicitly control how arguments are marshaled by using the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute defined in the <xref:System.Runtime.InteropServices> namespace.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="52a06-144">Önceki sürümlerini [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] parametreleri bildirmek için izin verilen `As Any`, bu verileri tüm verilerin anlamı türü kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="52a06-144">Previous versions of [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] allowed you to declare parameters `As Any`, meaning that data of any data type could be used.</span></span> [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)]<span data-ttu-id="52a06-145">belirli bir veri türüne tüm kullanmanızı gerektirir `Declare` deyimleri.</span><span class="sxs-lookup"><span data-stu-id="52a06-145"> requires that you use a specific data type for all `Declare` statements.</span></span>  
  
#### <a name="windows-api-constants"></a><span data-ttu-id="52a06-146">Windows API sabitleri</span><span class="sxs-lookup"><span data-stu-id="52a06-146">Windows API Constants</span></span>  
 <span data-ttu-id="52a06-147">Bazı bağımsız değişkenler sabitleri birleşimleridir.</span><span class="sxs-lookup"><span data-stu-id="52a06-147">Some arguments are combinations of constants.</span></span> <span data-ttu-id="52a06-148">Örneğin, `MessageBox` bu kılavuzda gösterilen API adlı tamsayı bağımsız değişken kabul `Typ` ileti kutusu nasıl görüntüleneceğini denetler.</span><span class="sxs-lookup"><span data-stu-id="52a06-148">For example, the `MessageBox` API shown in this walkthrough accepts an integer argument called `Typ` that controls how the message box is displayed.</span></span> <span data-ttu-id="52a06-149">Bu sabitleri sayısal değerini inceleyerek belirleyebilirsiniz `#define` WinUser.h dosyasındaki ifadelerini.</span><span class="sxs-lookup"><span data-stu-id="52a06-149">You can determine the numeric value of these constants by examining the `#define` statements in the file WinUser.h.</span></span> <span data-ttu-id="52a06-150">Dolayısıyla ekleyip ondalık biçime dönüştürmek için bir hesap makinesi kullanmak isteyebilirsiniz sayısal değerleri genellikle onaltılık olarak gösterilir.</span><span class="sxs-lookup"><span data-stu-id="52a06-150">The numeric values are generally shown in hexadecimal, so you may want to use a calculator to add them and convert to decimal.</span></span> <span data-ttu-id="52a06-151">Örneğin, ünlem işareti stili için sabitleri birleştirmek istiyorsanız `MB_ICONEXCLAMATION` 0x00000030 ve Evet/stil yok `MB_YESNO` 0x00000004, sayıları ve bir sonuç 0x00000034 ya da 52 ondalık almak.</span><span class="sxs-lookup"><span data-stu-id="52a06-151">For example, if you want to combine the constants for the exclamation style `MB_ICONEXCLAMATION` 0x00000030 and the Yes/No style `MB_YESNO` 0x00000004, you can add the numbers and get a result of 0x00000034, or 52 decimal.</span></span> <span data-ttu-id="52a06-152">Ondalık sonuç doğrudan kullanabilmenize karşın, bu değerleri, uygulamanızda sabitleri olarak bildirin ve bunları birleştirmek daha iyi kullanarak `Or` işleci.</span><span class="sxs-lookup"><span data-stu-id="52a06-152">Although you can use the decimal result directly, it is better to declare these values as constants in your application and combine them using the `Or` operator.</span></span>  
  
###### <a name="to-declare-constants-for-windows-api-calls"></a><span data-ttu-id="52a06-153">Windows API çağrıları için sabitleri bildirmek için</span><span class="sxs-lookup"><span data-stu-id="52a06-153">To declare constants for Windows API calls</span></span>  
  
1.  <span data-ttu-id="52a06-154">Aradığınız Windows işlevi için belgelere bakın.</span><span class="sxs-lookup"><span data-stu-id="52a06-154">Consult the documentation for the Windows function you are calling.</span></span> <span data-ttu-id="52a06-155">Kullandığı sabitleri adını ve bu sabitleri için sayısal değerleri içeren .h dosyasının adını belirler.</span><span class="sxs-lookup"><span data-stu-id="52a06-155">Determine the name of the constants it uses and the name of the .h file that contains the numeric values for these constants.</span></span>  
  
2.  <span data-ttu-id="52a06-156">Üstbilgi (.h) dosyasının içeriğini görüntülemek için Not Defteri gibi bir metin düzenleyicisi kullanın ve kullandığınız sabitler ile ilişkili değerleri bulur.</span><span class="sxs-lookup"><span data-stu-id="52a06-156">Use a text editor, such as Notepad, to view the contents of the header (.h) file, and find the values associated with the constants you are using.</span></span> <span data-ttu-id="52a06-157">Örneğin, `MessageBox` API'sini kullanan sabiti `MB_ICONQUESTION` ileti kutusunda bir soru işareti göstermek için.</span><span class="sxs-lookup"><span data-stu-id="52a06-157">For example, the `MessageBox` API uses the constant `MB_ICONQUESTION` to show a question mark in the message box.</span></span> <span data-ttu-id="52a06-158">Tanımı `MB_ICONQUESTION` içinde WinUser.h ve aşağıdaki gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="52a06-158">The definition for `MB_ICONQUESTION` is in WinUser.h and appears as follows:</span></span>  
  
     `#define MB_ICONQUESTION             0x00000020L`  
  
3.  <span data-ttu-id="52a06-159">Eşdeğer bir gruba eklemek `Const` deyimleri sınıfına veya bu sabitleri uygulamanızı kullanılabilir hale getirmek için modülü.</span><span class="sxs-lookup"><span data-stu-id="52a06-159">Add equivalent `Const` statements to your class or module to make these constants available to your application.</span></span> <span data-ttu-id="52a06-160">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="52a06-160">For example:</span></span>  
  
     [!code-vb[VbVbalrInterop#11](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_2.vb)]  
  
###### <a name="to-call-the-dll-procedure"></a><span data-ttu-id="52a06-161">DLL yordam çağrısı için</span><span class="sxs-lookup"><span data-stu-id="52a06-161">To call the DLL procedure</span></span>  
  
1.  <span data-ttu-id="52a06-162">Adlı bir düğme ekleme `Button1` başlangıç için form projeniz için ve kendi kod görüntülemek için çift tıklayın.</span><span class="sxs-lookup"><span data-stu-id="52a06-162">Add a button named `Button1` to the startup form for your project, and then double-click it to view its code.</span></span> <span data-ttu-id="52a06-163">Düğme için olay işleyicisini görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-163">The event handler for the button is displayed.</span></span>  
  
2.  <span data-ttu-id="52a06-164">Kodu ekleyin `Click` eklediğiniz, yordam çağrısı ve uygun bağımsız değişkenlerini sağlamak için düğmesi olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="52a06-164">Add code to the `Click` event handler for the button you added, to call the procedure and provide the appropriate arguments:</span></span>  
  
     [!code-vb[VbVbalrInterop#12](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_3.vb)]  
  
3.  <span data-ttu-id="52a06-165">F5 tuşuna basarak projeyi çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="52a06-165">Run the project by pressing F5.</span></span> <span data-ttu-id="52a06-166">İleti kutusu ikisi ile görüntülenen **Evet** ve **Hayır** yanıt düğmeler.</span><span class="sxs-lookup"><span data-stu-id="52a06-166">The message box is displayed with both **Yes** and **No** response buttons.</span></span> <span data-ttu-id="52a06-167">Bunlardan birini tıklatın.</span><span class="sxs-lookup"><span data-stu-id="52a06-167">Click either one.</span></span>  
  
#### <a name="data-marshaling"></a><span data-ttu-id="52a06-168">Veri hazırlama</span><span class="sxs-lookup"><span data-stu-id="52a06-168">Data Marshaling</span></span>  
 [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)]<span data-ttu-id="52a06-169">otomatik olarak dönüştürür için parametreler ve dönüş değerleri Windows API çağrıları, ancak veri türlerini kullanabilirsiniz `MarshalAs` bir API bekliyor yönetilmeyen veri türleri açıkça belirtmek için özniteliği.</span><span class="sxs-lookup"><span data-stu-id="52a06-169"> automatically converts the data types of parameters and return values for Windows API calls, but you can use the `MarshalAs` attribute to explicitly specify unmanaged data types that an API expects.</span></span> <span data-ttu-id="52a06-170">Birlikte çalışma hazırlama hakkında daha fazla bilgi için bkz: [birlikte çalışma hazırlama](../../../framework/interop/interop-marshaling.md).</span><span class="sxs-lookup"><span data-stu-id="52a06-170">For more information about interop marshaling, see [Interop Marshaling](../../../framework/interop/interop-marshaling.md).</span></span>  
  
###### <a name="to-use-declare-and-marshalas-in-an-api-call"></a><span data-ttu-id="52a06-171">Declare ve MarshalAs bir API çağrısında kullanmak için</span><span class="sxs-lookup"><span data-stu-id="52a06-171">To use Declare and MarshalAs in an API call</span></span>  
  
1.  <span data-ttu-id="52a06-172">Veri türleri, bağımsız değişkenlerini aramak istediğiniz işlevin adını belirlemek ve dönüş değeri.</span><span class="sxs-lookup"><span data-stu-id="52a06-172">Determine the name of the function you want to call, plus its arguments, data types, and return value.</span></span>  
  
2.  <span data-ttu-id="52a06-173">Erişimi kolaylaştırmak için `MarshalAs` özniteliği, ekleme bir `Imports` sınıfı veya aşağıdaki örnekteki gibi modülü için kod üstüne deyimi:</span><span class="sxs-lookup"><span data-stu-id="52a06-173">To simplify access to the `MarshalAs` attribute, add an `Imports` statement to the top of the code for the class or module, as in the following example:</span></span>  
  
     [!code-vb[VbVbalrInterop#13](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]  
  
3.  <span data-ttu-id="52a06-174">Sınıf veya kullanıyorsanız ve uygulama modülü içeri aktarılan işlevi için bir işlev prototipi eklemek `MarshalAs` özniteliği parametreleri veya dönüş değeri.</span><span class="sxs-lookup"><span data-stu-id="52a06-174">Add a function prototype for the imported function to the class or module you are using, and apply the `MarshalAs` attribute to the parameters or return value.</span></span> <span data-ttu-id="52a06-175">Aşağıdaki örnekte, türü bir API çağrısı `void*` olarak sıralanmış `AsAny`:</span><span class="sxs-lookup"><span data-stu-id="52a06-175">In the following example, an API call that expects the type `void*` is marshaled as `AsAny`:</span></span>  
  
     [!code-vb[VbVbalrInterop#14](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_5.vb)]  
  
## <a name="api-calls-using-dllimport"></a><span data-ttu-id="52a06-176">DllImport kullanarak API çağrıları</span><span class="sxs-lookup"><span data-stu-id="52a06-176">API Calls Using DllImport</span></span>  
 <span data-ttu-id="52a06-177">`DllImport` Özniteliği tür kitaplıklarının DLL'lerde işlevleri çağırmak için ikinci bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="52a06-177">The `DllImport` attribute provides a second way to call functions in DLLs without type libraries.</span></span> <span data-ttu-id="52a06-178">`DllImport`kullanmaya kabaca eşdeğerdir bir `Declare` deyimi ancak işlevler nasıl çağrılır üzerinde daha fazla denetim sağlar.</span><span class="sxs-lookup"><span data-stu-id="52a06-178">`DllImport` is roughly equivalent to using a `Declare` statement but provides more control over how functions are called.</span></span>  
  
 <span data-ttu-id="52a06-179">Kullanabileceğiniz `DllImport` ile çoğu Windows API çağrıları çağrı paylaşılan bir başvuruyor sürece (bazen adlı *statik*) yöntemi.</span><span class="sxs-lookup"><span data-stu-id="52a06-179">You can use `DllImport` with most Windows API calls as long as the call refers to a shared (sometimes called *static*) method.</span></span> <span data-ttu-id="52a06-180">Sınıfının bir örneği gerekli yöntemlerini kullanamazsınız.</span><span class="sxs-lookup"><span data-stu-id="52a06-180">You cannot use methods that require an instance of a class.</span></span> <span data-ttu-id="52a06-181">Farklı `Declare` deyimleri `DllImport` çağrıları kullanamaz `MarshalAs` özniteliği.</span><span class="sxs-lookup"><span data-stu-id="52a06-181">Unlike `Declare` statements, `DllImport` calls cannot use the `MarshalAs` attribute.</span></span>  
  
#### <a name="to-call-a-windows-api-using-the-dllimport-attribute"></a><span data-ttu-id="52a06-182">DllImport özniteliği kullanılarak bir Windows API'si çağırmak için</span><span class="sxs-lookup"><span data-stu-id="52a06-182">To call a Windows API using the DllImport attribute</span></span>  
  
1.  <span data-ttu-id="52a06-183">Yeni bir Windows uygulama projesi tıklatarak **yeni** üzerinde **dosya** menüsüne ve ardından **proje**.</span><span class="sxs-lookup"><span data-stu-id="52a06-183">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="52a06-184">**Yeni proje** iletişim kutusu görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-184">The **New Project** dialog box appears.</span></span>  
  
2.  <span data-ttu-id="52a06-185">Seçin **Windows uygulaması** listesinden [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] proje şablonları.</span><span class="sxs-lookup"><span data-stu-id="52a06-185">Select **Windows Application** from the list of [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] project templates.</span></span> <span data-ttu-id="52a06-186">Yeni Proje görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-186">The new project is displayed.</span></span>  
  
3.  <span data-ttu-id="52a06-187">Adlı bir düğme ekleme `Button2` başlangıç formu.</span><span class="sxs-lookup"><span data-stu-id="52a06-187">Add a button named `Button2` to the startup form.</span></span>  
  
4.  <span data-ttu-id="52a06-188">Çift `Button2` form için kod görünümünü açın.</span><span class="sxs-lookup"><span data-stu-id="52a06-188">Double-click `Button2` to open the code view for the form.</span></span>  
  
5.  <span data-ttu-id="52a06-189">Erişimi kolaylaştırmak için `DllImport`, ekleme bir `Imports` başlangıç formu sınıfı için kod üstüne deyimi:</span><span class="sxs-lookup"><span data-stu-id="52a06-189">To simplify access to `DllImport`, add an `Imports` statement to the top of the code for the startup form class:</span></span>  
  
     [!code-vb[VbVbalrInterop#13](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]  
  
6.  <span data-ttu-id="52a06-190">Önceki bir boş işlevi bildirme `End Class` deyimi form ve adını işlevi için `MoveFile`.</span><span class="sxs-lookup"><span data-stu-id="52a06-190">Declare an empty function preceding the `End Class` statement for the form, and name the function `MoveFile`.</span></span>  
  
7.  <span data-ttu-id="52a06-191">Uygulama `Public` ve `Shared` değiştiricileri için parametreleri ayarlama ve işlev bildirimi için `MoveFile` Windows API işlevi kullanır bağımsız değişkenleri göre:</span><span class="sxs-lookup"><span data-stu-id="52a06-191">Apply the `Public` and `Shared` modifiers to the function declaration and set parameters for `MoveFile` based on the arguments the Windows API function uses:</span></span>  
  
     [!code-vb[VbVbalrInterop#16](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_6.vb)]  
  
     <span data-ttu-id="52a06-192">İşlevinizi herhangi bir geçerli yordam adı olabilir; `DllImport` özniteliği dll Dosyasının adını belirtir.</span><span class="sxs-lookup"><span data-stu-id="52a06-192">Your function can have any valid procedure name; the `DllImport` attribute specifies the name in the DLL.</span></span> <span data-ttu-id="52a06-193">Birlikte çalışabilirlik için parametreleri hazırlama aynı zamanda işleyen ve verileri benzer Visual Studio veri türleri seçebilmeniz dönüş değerleri türlerden API kullanır.</span><span class="sxs-lookup"><span data-stu-id="52a06-193">It also handles interoperability marshaling for the parameters and return values, so you can choose Visual Studio data types that are similar to the data types the API uses.</span></span>  
  
8.  <span data-ttu-id="52a06-194">Uygulama `DllImport` özniteliği boş işlevi.</span><span class="sxs-lookup"><span data-stu-id="52a06-194">Apply the `DllImport` attribute to the empty function.</span></span> <span data-ttu-id="52a06-195">İlk parametre, aradığınız işlevi içeren dll Dosyasının konumunu ve adını ' dir.</span><span class="sxs-lookup"><span data-stu-id="52a06-195">The first parameter is the name and location of the DLL containing the function you are calling.</span></span> <span data-ttu-id="52a06-196">Windows Sistem dizinlerde bulunan dosyaların yolunu belirtmeniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="52a06-196">You do not need to specify the path for files located in the Windows system directories.</span></span> <span data-ttu-id="52a06-197">İkinci parametre Windows API işlevin adını belirten bir adlandırılmış bağımsız değişkenidir.</span><span class="sxs-lookup"><span data-stu-id="52a06-197">The second parameter is a named argument that specifies the name of the function in the Windows API.</span></span> <span data-ttu-id="52a06-198">Bu örnekte, `DllImport` özniteliği zorlar çağrıları `MoveFile` iletilmesi için `MoveFileW` KERNEL32 içinde. DLL.</span><span class="sxs-lookup"><span data-stu-id="52a06-198">In this example, the `DllImport` attribute forces calls to `MoveFile` to be forwarded to `MoveFileW` in KERNEL32.DLL.</span></span> <span data-ttu-id="52a06-199">`MoveFileW` Yöntemi kopyalar bir dosya yolu `src` yoluna `dst`.</span><span class="sxs-lookup"><span data-stu-id="52a06-199">The `MoveFileW` method copies a file from the path `src` to the path `dst`.</span></span>  
  
     [!code-vb[VbVbalrInterop#17](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_7.vb)]  
  
9. <span data-ttu-id="52a06-200">Kodu ekleyin `Button2_Click` bir işlevi çağırmak için olay işleyicisi:</span><span class="sxs-lookup"><span data-stu-id="52a06-200">Add code to the `Button2_Click` event handler to call the function:</span></span>  
  
     [!code-vb[VbVbalrInterop#18](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_8.vb)]  
  
10. <span data-ttu-id="52a06-201">Sınama.txt adlı bir dosya oluşturun ve bunu sabit diskinizde C:\Tmp dizinine yerleştirir.</span><span class="sxs-lookup"><span data-stu-id="52a06-201">Create a file named Test.txt and place it in the C:\Tmp directory on your hard drive.</span></span> <span data-ttu-id="52a06-202">Gerekirse Tmp dizini oluşturun.</span><span class="sxs-lookup"><span data-stu-id="52a06-202">Create the Tmp directory if necessary.</span></span>  
  
11. <span data-ttu-id="52a06-203">Uygulamayı başlatmak için F5 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="52a06-203">Press F5 to start the application.</span></span> <span data-ttu-id="52a06-204">Ana form görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-204">The main form appears.</span></span>  
  
12. <span data-ttu-id="52a06-205">Tıklatın **Button2**.</span><span class="sxs-lookup"><span data-stu-id="52a06-205">Click **Button2**.</span></span> <span data-ttu-id="52a06-206">Dosyayı taşıdıysanız "dosyası başarıyla taşındı" iletisi görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="52a06-206">The message "The file was moved successfully" is displayed if the file can be moved.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="52a06-207">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="52a06-207">See Also</span></span>  
 <xref:System.Runtime.InteropServices.DllImportAttribute>  
 <xref:System.Runtime.InteropServices.MarshalAsAttribute>  
 [<span data-ttu-id="52a06-208">Declare deyimi</span><span class="sxs-lookup"><span data-stu-id="52a06-208">Declare Statement</span></span>](../../../visual-basic/language-reference/statements/declare-statement.md)  
 [<span data-ttu-id="52a06-209">Otomatik</span><span class="sxs-lookup"><span data-stu-id="52a06-209">Auto</span></span>](../../../visual-basic/language-reference/modifiers/auto.md)  
 [<span data-ttu-id="52a06-210">Diğer ad</span><span class="sxs-lookup"><span data-stu-id="52a06-210">Alias</span></span>](../../../visual-basic/language-reference/statements/alias-clause.md)  
 [<span data-ttu-id="52a06-211">COM birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="52a06-211">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="52a06-212">Yönetilen kodda prototipler oluşturma</span><span class="sxs-lookup"><span data-stu-id="52a06-212">Creating Prototypes in Managed Code</span></span>](../../../framework/interop/creating-prototypes-in-managed-code.md)  
 [<span data-ttu-id="52a06-213">Bir geri çağırma metodu olarak bir temsilci hazırlama</span><span class="sxs-lookup"><span data-stu-id="52a06-213">Marshaling a Delegate as a Callback Method</span></span>](../../../framework/interop/marshaling-a-delegate-as-a-callback-method.md)
