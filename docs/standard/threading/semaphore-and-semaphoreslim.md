---
title: Semafor ve SemaphoreSlim
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- counting semaphores
- semaphores
- threading [.NET Framework], cross-process synchronization
- Semaphore class, about Semaphore class
- SemaphoreSlim class, about SemaphoreSlim class
- threading [.NET Framework], Semaphore class
ms.assetid: 7722a333-b974-47a2-a7c0-f09097fb644e
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 1f9c6df23ae1a142d208672a03ffeb74709a0a05
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33591318"
---
# <a name="semaphore-and-semaphoreslim"></a><span data-ttu-id="37201-102">Semafor ve SemaphoreSlim</span><span class="sxs-lookup"><span data-stu-id="37201-102">Semaphore and SemaphoreSlim</span></span>
<span data-ttu-id="37201-103"><xref:System.Threading.Semaphore?displayProperty=nameWithType> Adlandırılmış (yükleyebilecek) veya yerel semafor sınıfı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="37201-103">The <xref:System.Threading.Semaphore?displayProperty=nameWithType> class represents a named (systemwide) or local semaphore.</span></span> <span data-ttu-id="37201-104">Win32 semafor nesne çevresinde ince bir sarmalayıcı değil.</span><span class="sxs-lookup"><span data-stu-id="37201-104">It is a thin wrapper around the Win32 semaphore object.</span></span> <span data-ttu-id="37201-105">Win32 semafor, kaynak havuzu erişimi denetlemek için kullanılan semaforları sayma.</span><span class="sxs-lookup"><span data-stu-id="37201-105">Win32 semaphores are counting semaphores, which can be used to control access to a pool of resources.</span></span>  
  
 <span data-ttu-id="37201-106"><xref:System.Threading.SemaphoreSlim> Sınıfı, bekleme süresini çok kısa olması beklenen zaman, tek bir işlem içinde bekleme için kullanılabilen bir basit, hızlı semafor temsil eder.</span><span class="sxs-lookup"><span data-stu-id="37201-106">The <xref:System.Threading.SemaphoreSlim> class represents a lightweight, fast semaphore that can be used for waiting within a single process when wait times are expected to be very short.</span></span> <span data-ttu-id="37201-107"><xref:System.Threading.SemaphoreSlim> Eşitleme temelleri ortak dil çalışma zamanı tarafından (CLR) sağlanan üzerinde mümkün olduğunca kullanır.</span><span class="sxs-lookup"><span data-stu-id="37201-107"><xref:System.Threading.SemaphoreSlim> relies as much as possible on synchronization primitives provided by the common language runtime (CLR).</span></span> <span data-ttu-id="37201-108">Ancak, ayrıca gevşek başlatılmış, çekirdek tabanlı bekleme tanıtıcıları üzerinde birden fazla semafor bekleyen desteklemek için gereken sağlar.</span><span class="sxs-lookup"><span data-stu-id="37201-108">However, it also provides lazily initialized, kernel-based wait handles as necessary to support waiting on multiple semaphores.</span></span> <span data-ttu-id="37201-109"><xref:System.Threading.SemaphoreSlim> Semafor veya eşitleme bekleme tanıtıcısı kullanılmak adlı iptal belirteçlerini, ancak kullanımını desteklemediği de destekler.</span><span class="sxs-lookup"><span data-stu-id="37201-109"><xref:System.Threading.SemaphoreSlim> also supports the use of cancellation tokens, but it does not support named semaphores or the use of a wait handle for synchronization.</span></span>  
  
## <a name="managing-a-limited-resource"></a><span data-ttu-id="37201-110">Sınırlı kaynak yönetme</span><span class="sxs-lookup"><span data-stu-id="37201-110">Managing a Limited Resource</span></span>  
 <span data-ttu-id="37201-111">İş parçacığı çağırarak semafor girin <xref:System.Threading.WaitHandle.WaitOne%2A> kaynağından devralındı yöntemi <xref:System.Threading.WaitHandle> sınıfında durumunda bir <xref:System.Threading.Semaphore?displayProperty=nameWithType> nesnesi veya <xref:System.Threading.SemaphoreSlim.Wait%2A?displayProperty=nameWithType> veya <xref:System.Threading.SemaphoreSlim.WaitAsync%2A?displayProperty=nameWithType> durumunda yöntemi bir <xref:System.Threading.SemaphoreSlim> nesnesi...</span><span class="sxs-lookup"><span data-stu-id="37201-111">Threads enter the semaphore by calling the <xref:System.Threading.WaitHandle.WaitOne%2A> method, which is inherited from the <xref:System.Threading.WaitHandle> class, in the case of a <xref:System.Threading.Semaphore?displayProperty=nameWithType> object, or the <xref:System.Threading.SemaphoreSlim.Wait%2A?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.WaitAsync%2A?displayProperty=nameWithType> method, in the case of a <xref:System.Threading.SemaphoreSlim> object..</span></span> <span data-ttu-id="37201-112">Semafor sayısına çağrısı döndürüldüğünde düşülür.</span><span class="sxs-lookup"><span data-stu-id="37201-112">When the call returns, the count on the semaphore is decremented.</span></span> <span data-ttu-id="37201-113">Bir iş parçacığı sayısı ve girişi isteğinde bulunduğunda, iş parçacığı blokları sıfırdır.</span><span class="sxs-lookup"><span data-stu-id="37201-113">When a thread requests entry and the count is zero, the thread blocks.</span></span> <span data-ttu-id="37201-114">İş parçacığı semafor çağırarak çıkardıkça <xref:System.Threading.Semaphore.Release%2A?displayProperty=nameWithType> veya <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> yöntemi, engellenmiş iş parçacığı girin izin verilir.</span><span class="sxs-lookup"><span data-stu-id="37201-114">As threads release the semaphore by calling the <xref:System.Threading.Semaphore.Release%2A?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> method, blocked threads are allowed to enter.</span></span> <span data-ttu-id="37201-115">Semafor girmek engellenmiş iş parçacığı için ilk çıkar (FIFO) veya son giren ilk çıkar (LIFO) gibi hiçbir garanti edilen sipariş yoktur.</span><span class="sxs-lookup"><span data-stu-id="37201-115">There is no guaranteed order, such as first-in, first-out (FIFO) or last-in, first-out (LIFO), for blocked threads to enter the semaphore.</span></span>  
  
 <span data-ttu-id="37201-116">Bir iş parçacığı semafor birden çok kez çağırarak girebilirsiniz <xref:System.Threading.Semaphore?displayProperty=nameWithType> nesnenin <xref:System.Threading.WaitHandle.WaitOne%2A> yöntemi veya <xref:System.Threading.SemaphoreSlim> nesnesinin <xref:System.Threading.SemaphoreSlim.Wait%2A> yöntemi art arda.</span><span class="sxs-lookup"><span data-stu-id="37201-116">A thread can enter the semaphore multiple times by calling the <xref:System.Threading.Semaphore?displayProperty=nameWithType> object's <xref:System.Threading.WaitHandle.WaitOne%2A> method or the  <xref:System.Threading.SemaphoreSlim> object's <xref:System.Threading.SemaphoreSlim.Wait%2A> method repeatedly.</span></span> <span data-ttu-id="37201-117">İş parçacığı semafor serbest bırakmak için her iki arama yapabilirsiniz <xref:System.Threading.Semaphore.Release?displayProperty=nameWithType> veya <xref:System.Threading.SemaphoreSlim.Release?displayProperty=nameWithType> yöntemi aşırı aynı sayısı veya arama <xref:System.Threading.Semaphore.Release%28System.Int32%29?displayProperty=nameWithType> veya <xref:System.Threading.SemaphoreSlim.Release%28System.Int32%29?displayProperty=nameWithType> yöntemi aşırı yükleme ve yayımlanacak girdilerinin sayısını belirtin.</span><span class="sxs-lookup"><span data-stu-id="37201-117">To release the semaphore, the thread can either call the <xref:System.Threading.Semaphore.Release?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.Release?displayProperty=nameWithType> method overload the same number of times, or call the <xref:System.Threading.Semaphore.Release%28System.Int32%29?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.Release%28System.Int32%29?displayProperty=nameWithType> method overload and specify the number of entries to be released.</span></span>  
  
### <a name="semaphores-and-thread-identity"></a><span data-ttu-id="37201-118">Semafor ve iş parçacığı kimliği</span><span class="sxs-lookup"><span data-stu-id="37201-118">Semaphores and Thread Identity</span></span>  
 <span data-ttu-id="37201-119">İki semafor türleri iş parçacığı kimliğine göre çağrıları zorlamaz <xref:System.Threading.WaitHandle.WaitOne%2A>, <xref:System.Threading.SemaphoreSlim.Wait%2A>, <xref:System.Threading.Semaphore.Release%2A>, ve <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="37201-119">The two semaphore types do not enforce thread identity on calls to the <xref:System.Threading.WaitHandle.WaitOne%2A>, <xref:System.Threading.SemaphoreSlim.Wait%2A>, <xref:System.Threading.Semaphore.Release%2A>, and <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> methods.</span></span> <span data-ttu-id="37201-120">Örneğin, genel bir kullanım senaryosu semafor içerir için bir üretici iş parçacığı ve tüketici bir iş parçacığı, her zaman semafor sayısı ve diğer her zaman azaltma artan bir iş parçacığı ile bu.</span><span class="sxs-lookup"><span data-stu-id="37201-120">For example, a common usage scenario for semaphores involves a producer thread and a consumer thread, with one thread always incrementing the semaphore count and the other always decrementing it.</span></span>  
  
 <span data-ttu-id="37201-121">Bir iş parçacığı çok fazla kez semafor bırakmaz sağlamak Programcı sorumluluğundadır.</span><span class="sxs-lookup"><span data-stu-id="37201-121">It is the programmer's responsibility to ensure that a thread does not release the semaphore too many times.</span></span> <span data-ttu-id="37201-122">Örneğin, en yüksek sayısı iki ve bu bir iş parçacığı ve iş parçacığı B semafor sahip olduğunu varsayın her ikisi de semafor girin.</span><span class="sxs-lookup"><span data-stu-id="37201-122">For example, suppose a semaphore has a maximum count of two, and that thread A and thread B both enter the semaphore.</span></span> <span data-ttu-id="37201-123">İş parçacığında B bir programlama hatası çağırmak neden olmadığını `Release` iki kez, her iki çağrılarının başarılı.</span><span class="sxs-lookup"><span data-stu-id="37201-123">If a programming error in thread B causes it to call  `Release` twice, both calls succeed.</span></span> <span data-ttu-id="37201-124">Semafor sayısına dolu olduğunda ve ne zaman bir iş parçacığı sonunda çağırır `Release`, <xref:System.Threading.SemaphoreFullException> atılır.</span><span class="sxs-lookup"><span data-stu-id="37201-124">The count on the semaphore is full, and when thread A eventually calls `Release`, a <xref:System.Threading.SemaphoreFullException> is thrown.</span></span>  
  
## <a name="named-semaphores"></a><span data-ttu-id="37201-125">Adlandırılmış semafor</span><span class="sxs-lookup"><span data-stu-id="37201-125">Named Semaphores</span></span>  
 <span data-ttu-id="37201-126">Windows işletim sisteminin adlara sahip semafor sağlar.</span><span class="sxs-lookup"><span data-stu-id="37201-126">The Windows operating system allows semaphores to have names.</span></span> <span data-ttu-id="37201-127">Adlandırılmış semafor geniş sistemidir.</span><span class="sxs-lookup"><span data-stu-id="37201-127">A named semaphore is system wide.</span></span> <span data-ttu-id="37201-128">Diğer bir deyişle, adlandırılmış semafor oluşturulduktan sonra tüm iş parçacıkları, tüm işlemler için görünür durumdadır.</span><span class="sxs-lookup"><span data-stu-id="37201-128">That is, once the named semaphore is created, it is visible to all threads in all processes.</span></span> <span data-ttu-id="37201-129">Bu nedenle, adlandırılmış semafor etkinlikleri, işlemleri ve bunun yanı sıra iş parçacıklarını eşitleme için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="37201-129">Thus, named semaphore can be used to synchronize the activities of processes as well as threads.</span></span>  
  
 <span data-ttu-id="37201-130">Oluşturabileceğiniz bir <xref:System.Threading.Semaphore> bir ad belirtir oluşturucular birini kullanarak bir adlandırılmış sistem semafor temsil eden nesne.</span><span class="sxs-lookup"><span data-stu-id="37201-130">You can create a <xref:System.Threading.Semaphore> object that represents a named system semaphore by using one of the constructors that specifies a name.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37201-131">Adlandırılmış semafor sistem genelinde olduğundan, birden çok olma olasılığı vardır <xref:System.Threading.Semaphore> aynı temsil eden nesneler adlı semafor.</span><span class="sxs-lookup"><span data-stu-id="37201-131">Because named semaphores are system wide, it is possible to have multiple <xref:System.Threading.Semaphore> objects that represent the same named semaphore.</span></span> <span data-ttu-id="37201-132">Her zaman bir oluşturucu çağrısı veya <xref:System.Threading.Semaphore.OpenExisting%2A?displayProperty=nameWithType> yöntemi, yeni bir <xref:System.Threading.Semaphore> nesnesi oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="37201-132">Each time you call a constructor or the <xref:System.Threading.Semaphore.OpenExisting%2A?displayProperty=nameWithType> method, a new <xref:System.Threading.Semaphore> object is created.</span></span> <span data-ttu-id="37201-133">Aynı adı art arda belirterek aynı adlandırılmış semafor temsil eden birden çok nesne oluşturur.</span><span class="sxs-lookup"><span data-stu-id="37201-133">Specifying the same name repeatedly creates multiple objects that represent the same named semaphore.</span></span>  
  
 <span data-ttu-id="37201-134">Adlandırılmış semafor kullanırken dikkatli olun.</span><span class="sxs-lookup"><span data-stu-id="37201-134">Be careful when you use named semaphores.</span></span> <span data-ttu-id="37201-135">Sistem genelinde oldukları için aynı adı kullanan başka bir işlem beklenmedik şekilde, semafor girebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37201-135">Because they are system wide, another process that uses the same name can enter your semaphore unexpectedly.</span></span> <span data-ttu-id="37201-136">Aynı bilgisayarda çalıştırılan kötü amaçlı kod bunu bir hizmet reddi saldırısı temel olarak kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37201-136">Malicious code executing on the same computer could use this as the basis of a denial-of-service attack.</span></span>  
  
 <span data-ttu-id="37201-137">Erişim denetimi güvenliği korumak için kullanmak bir <xref:System.Threading.Semaphore> belirten bir oluşturucu kullanılarak adlandırılmış semafor tercihen temsil eden nesnesi bir <xref:System.Security.AccessControl.SemaphoreSecurity?displayProperty=nameWithType> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="37201-137">Use access control security to protect a <xref:System.Threading.Semaphore> object that represents a named semaphore, preferably by using a constructor that specifies a <xref:System.Security.AccessControl.SemaphoreSecurity?displayProperty=nameWithType> object.</span></span> <span data-ttu-id="37201-138">Erişim denetimi güvenlik kullanarak uygulayabileceğiniz <xref:System.Threading.Semaphore.SetAccessControl%2A?displayProperty=nameWithType> yöntemi, ancak bu bir güvenlik açığı semafor oluşturulduğu zaman korunur zaman arasında pencerenin bırakır.</span><span class="sxs-lookup"><span data-stu-id="37201-138">You can also apply access control security using the <xref:System.Threading.Semaphore.SetAccessControl%2A?displayProperty=nameWithType> method, but this leaves a window of vulnerability between the time the semaphore is created and the time it is protected.</span></span> <span data-ttu-id="37201-139">Erişim denetimi güvenliği ile semafor koruma kötü amaçlı saldırıların önlenmesine yardımcı olur, ancak istenmeyen ad çakışması sorunu çözmez.</span><span class="sxs-lookup"><span data-stu-id="37201-139">Protecting semaphores with access control security helps prevent malicious attacks, but does not solve the problem of unintentional name collisions.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37201-140">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="37201-140">See Also</span></span>  
 <xref:System.Threading.Semaphore>  
 <xref:System.Threading.SemaphoreSlim>  
 [<span data-ttu-id="37201-141">İş Parçacığı Nesneleri ve Özellikleri</span><span class="sxs-lookup"><span data-stu-id="37201-141">Threading Objects and Features</span></span>](../../../docs/standard/threading/threading-objects-and-features.md)
