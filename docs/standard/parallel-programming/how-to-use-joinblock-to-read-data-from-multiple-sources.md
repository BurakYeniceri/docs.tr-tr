---
title: "Nasıl yapılır: Birden Fazla Kaynaktan Okumak için JoinBlock'u Kullanma"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Task Parallel Library, dataflows
- TPL dataflow library, joining blocks in
- dataflow blocks, joining in TPL
ms.assetid: e9c1ada4-ac57-4704-87cb-2f5117f8151d
caps.latest.revision: "7"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: fa5f531257c0593f615e4620b56b2ef581ac143c
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/23/2017
---
# <a name="how-to-use-joinblock-to-read-data-from-multiple-sources"></a><span data-ttu-id="be513-102">Nasıl yapılır: Birden Fazla Kaynaktan Okumak için JoinBlock'u Kullanma</span><span class="sxs-lookup"><span data-stu-id="be513-102">How to: Use JoinBlock to Read Data From Multiple Sources</span></span>
<span data-ttu-id="be513-103">Bu belge nasıl kullanılacağını açıklamaktadır <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> birden fazla kaynaktan veri bulunduğunda bir işlemi gerçekleştirmek için sınıf.</span><span class="sxs-lookup"><span data-stu-id="be513-103">This document explains how to use the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class to perform an operation when data is available from multiple sources.</span></span> <span data-ttu-id="be513-104">Ayrıca, doyumsuz olmayan mod bir veri kaynağını daha verimli bir şekilde paylaşmak birden fazla birleştirme blokları etkinleştirmek için nasıl kullanılacağını gösterir.</span><span class="sxs-lookup"><span data-stu-id="be513-104">It also demonstrates how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="be513-105">TPL veri akışı kitaplığı (<xref:System.Threading.Tasks.Dataflow?displayProperty=nameWithType> ad alanı) ile dağıtılmaz [!INCLUDE[net_v45](../../../includes/net-v45-md.md)].</span><span class="sxs-lookup"><span data-stu-id="be513-105">The TPL Dataflow Library (<xref:System.Threading.Tasks.Dataflow?displayProperty=nameWithType> namespace) is not distributed with the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)].</span></span> <span data-ttu-id="be513-106">Yüklemek için <xref:System.Threading.Tasks.Dataflow> ad alanı, projenizi açın [!INCLUDE[vs_dev11_long](../../../includes/vs-dev11-long-md.md)], seçin **NuGet paketlerini Yönet** proje menüsünden ve çevrimiçi arama `Microsoft.Tpl.Dataflow` paket.</span><span class="sxs-lookup"><span data-stu-id="be513-106">To install the <xref:System.Threading.Tasks.Dataflow> namespace, open your project in [!INCLUDE[vs_dev11_long](../../../includes/vs-dev11-long-md.md)], choose **Manage NuGet Packages** from the Project menu, and search online for the `Microsoft.Tpl.Dataflow` package.</span></span>  
  
## <a name="example"></a><span data-ttu-id="be513-107">Örnek</span><span class="sxs-lookup"><span data-stu-id="be513-107">Example</span></span>  
 <span data-ttu-id="be513-108">Aşağıdaki örnek, üç kaynak türleri, tanımlar `NetworkResource`, `FileResource`, ve `MemoryResource`ve kaynakları kullanılabilir duruma geldiğinde işlemleri gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="be513-108">The following example defines three resource types, `NetworkResource`, `FileResource`, and `MemoryResource`, and performs operations when resources become available.</span></span> <span data-ttu-id="be513-109">Bu örnek gerektiren bir `NetworkResource` ve `MemoryResource` ilk işlemi gerçekleştirmek için çifti ve `FileResource` ve `MemoryResource` ikinci bir işlem gerçekleştirmek için çifti.</span><span class="sxs-lookup"><span data-stu-id="be513-109">This example requires a `NetworkResource` and `MemoryResource` pair in order to perform the first operation and a `FileResource` and `MemoryResource` pair in order to perform the second operation.</span></span> <span data-ttu-id="be513-110">Tüm gerekli kaynaklar kullanılabilir olduğunda gerçekleşmesi bu işlemleri etkinleştirmek için bu örnek kullanır <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="be513-110">To enable these operations to occur when all required resources are available, this example uses the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class.</span></span> <span data-ttu-id="be513-111">Zaman bir <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesne tüm kaynaklardan gelen verileri alır, bu olduğundan, hedef verilerin yayar bir <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="be513-111">When a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> object receives data from all sources, it propagates that data to its target, which in this example is an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object.</span></span> <span data-ttu-id="be513-112">Her ikisi de <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesnelerini okuma alanının paylaşılan havuzundan `MemoryResource` nesneleri.</span><span class="sxs-lookup"><span data-stu-id="be513-112">Both <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects read from a shared pool of `MemoryResource` objects.</span></span>  
  
 [!code-csharp[TPLDataflow_NonGreedyJoin#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_nongreedyjoin/cs/nongreedyjoin.cs#1)]
 [!code-vb[TPLDataflow_NonGreedyJoin#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_nongreedyjoin/vb/nongreedyjoin.vb#1)]  
  
 <span data-ttu-id="be513-113">Paylaşılan havuzu verimli kullanımını etkinleştirmek için `MemoryResource` nesneleri, bu örnek belirtir bir <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions> olan nesneyi <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> özelliğini `False` oluşturmak için <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> doyumsuz olmayan modda hareket nesneleri.</span><span class="sxs-lookup"><span data-stu-id="be513-113">To enable efficient use of the shared pool of `MemoryResource` objects, this example specifies a <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions> object that has the <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> property set to `False` to create <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects that act in non-greedy mode.</span></span> <span data-ttu-id="be513-114">Bir her kaynaktan kullanılabilir hale gelene kadar doyumsuz olmayan birleştirme blok gelen tüm iletilerin erteler.</span><span class="sxs-lookup"><span data-stu-id="be513-114">A non-greedy join block postpones all incoming messages until one is available from each source.</span></span> <span data-ttu-id="be513-115">Ertelenen iletilerini başka bir bloğu tarafından kabul edildi, birleştirme blok işlemi yeniden başlatır.</span><span class="sxs-lookup"><span data-stu-id="be513-115">If any of the postponed messages were accepted by another block, the join block restarts the process.</span></span> <span data-ttu-id="be513-116">Doyumsuz olmayan modu verileri için diğer blokları bekleyin gibi ilerleme gerçekleştirmek için bir veya daha fazla kaynak blokları paylaşmak birleştirme blokları sağlar.</span><span class="sxs-lookup"><span data-stu-id="be513-116">Non-greedy mode enables join blocks that share one or more source blocks to make forward progress as the other blocks wait for data.</span></span> <span data-ttu-id="be513-117">Bu örnekte, bir `MemoryResource` nesne eklenmiş olup `memoryResources` havuz, ilk birleştirme ikinci veri kaynağı almak için blok ilerleme yapabilir.</span><span class="sxs-lookup"><span data-stu-id="be513-117">In this example, if a `MemoryResource` object is added to the `memoryResources` pool, the first join block to receive its second data source can make forward progress.</span></span> <span data-ttu-id="be513-118">Bu örnek doyumsuz modunu kullanacak şekilde olsaydı, varsayılan olarak, bir birleşim blok olduğu sürebilir `MemoryResource` nesne ve ikinci bir kaynak kullanılabilir olmasını bekleyin.</span><span class="sxs-lookup"><span data-stu-id="be513-118">If this example were to use greedy mode, which is the default, one join block might take the `MemoryResource` object and wait for the second resource to become available.</span></span> <span data-ttu-id="be513-119">Bir birleştirme blok kendi ikinci veri kaynağı varsa, ancak bunu ilerleme yapılamıyor, çünkü `MemoryResource` nesne bir birleşim bloğu tarafından alınmış.</span><span class="sxs-lookup"><span data-stu-id="be513-119">However, if the other join block has its second data source available, it cannot make forward progress because the `MemoryResource` object has been taken by the other join block.</span></span>  
  
## <a name="compiling-the-code"></a><span data-ttu-id="be513-120">Kod Derleniyor</span><span class="sxs-lookup"><span data-stu-id="be513-120">Compiling the Code</span></span>  
 <span data-ttu-id="be513-121">Örnek kodu kopyalayın ve bir Visual Studio projesi yapıştırın veya adlı bir dosyaya yapıştırın `DataflowNonGreedyJoin.cs` (`DataflowNonGreedyJoin.vb` için [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]), ve ardından Visual Studio komut istemi penceresinde aşağıdaki komutu çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="be513-121">Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named `DataflowNonGreedyJoin.cs` (`DataflowNonGreedyJoin.vb` for [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]), and then run the following command in a Visual Studio Command Prompt window.</span></span>  
  
 [!INCLUDE[csprcs](../../../includes/csprcs-md.md)]  
  
 <span data-ttu-id="be513-122">**csc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.cs**</span><span class="sxs-lookup"><span data-stu-id="be513-122">**csc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.cs**</span></span>  
  
 [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]  
  
 <span data-ttu-id="be513-123">**Vbc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.vb**</span><span class="sxs-lookup"><span data-stu-id="be513-123">**vbc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.vb**</span></span>  
  
## <a name="robust-programming"></a><span data-ttu-id="be513-124">Güçlü Programlama</span><span class="sxs-lookup"><span data-stu-id="be513-124">Robust Programming</span></span>  
 <span data-ttu-id="be513-125">Doyumsuz olmayan birleştirmeler kullanımını da kilitlenme uygulamanızda önlemenize yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="be513-125">The use of non-greedy joins can also help you prevent deadlock in your application.</span></span> <span data-ttu-id="be513-126">Bir yazılım uygulamasında *kilitlenme* iki veya daha çok işlemler her bir kaynak basılı tutun ve karşılıklı olarak başka bir kaynağın serbest bırakmak başka bir işlemin tamamlanmasını beklemek oluşur.</span><span class="sxs-lookup"><span data-stu-id="be513-126">In a software application, *deadlock* occurs when two or more processes each hold a resource and mutually wait for another process to release some other resource.</span></span> <span data-ttu-id="be513-127">İki tanımlayan bir uygulamayı göz önünde bulundurun <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesneleri.</span><span class="sxs-lookup"><span data-stu-id="be513-127">Consider an application that defines two <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects.</span></span> <span data-ttu-id="be513-128">Her iki nesneleri iki paylaşılan kaynak bloklarından verilerini okur.</span><span class="sxs-lookup"><span data-stu-id="be513-128">Both objects each read data from two shared source blocks.</span></span> <span data-ttu-id="be513-129">Her iki birleştirme blokları birbirini diğer kaynağı yayımlamayı bekleyin çünkü doyumsuz modunda bir birleşim blok ilk kaynağından okur ve ikinci birleştirme bloğu ikinci kaynağından okur uygulama kilitlenme.</span><span class="sxs-lookup"><span data-stu-id="be513-129">In greedy mode, if one join block reads from the first source and the second join block reads from the second source, the application might deadlock because both join blocks mutually wait for the other to release its resource.</span></span> <span data-ttu-id="be513-130">Doyumsuz olmayan modda her birleştirme bloğu okuma kaynaklarının yalnızca tüm veriler kullanılabilir olduğunda ve bu nedenle, kilitlenme riski ortadan.</span><span class="sxs-lookup"><span data-stu-id="be513-130">In non-greedy mode, each join block reads from its sources only when all data is available, and therefore, the risk of deadlock is eliminated.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="be513-131">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="be513-131">See Also</span></span>  
 [<span data-ttu-id="be513-132">Veri akışı</span><span class="sxs-lookup"><span data-stu-id="be513-132">Dataflow</span></span>](../../../docs/standard/parallel-programming/dataflow-task-parallel-library.md)
