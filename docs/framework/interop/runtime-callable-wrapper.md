---
title: "Çalışma Zamanı Aranabilir Sarmalayıcısı"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- COM interop, COM wrappers
- RCW
- COM wrappers
- runtime callable wrappers
- interoperation with unmanaged code, COM wrappers
ms.assetid: 7e542583-1e31-4e10-b523-8cf2f29cb4a4
caps.latest.revision: "9"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 722a317a01d79f56496810b8727ce041705c8f78
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/22/2017
---
# <a name="runtime-callable-wrapper"></a><span data-ttu-id="e194d-102">Çalışma Zamanı Aranabilir Sarmalayıcısı</span><span class="sxs-lookup"><span data-stu-id="e194d-102">Runtime Callable Wrapper</span></span>
<span data-ttu-id="e194d-103">Ortak dil çalışma zamanı çalışma zamanı aranabilir sarmalayıcısı (RCW) adlı bir proxy üzerinden COM nesneleri gösterir.</span><span class="sxs-lookup"><span data-stu-id="e194d-103">The common language runtime exposes COM objects through a proxy called the runtime callable wrapper (RCW).</span></span> <span data-ttu-id="e194d-104">RCW .NET istemcileri sıradan bir nesneye görünmesine karşın, bir .NET istemcisi ve COM nesnesi arasındaki aramaları sıralamakta kendi birincil işlevi olduğu.</span><span class="sxs-lookup"><span data-stu-id="e194d-104">Although the RCW appears to be an ordinary object to .NET clients, its primary function is to marshal calls between a .NET client and a COM object.</span></span>  
  
 <span data-ttu-id="e194d-105">Çalışma zamanı bu nesne üzerinde mevcut başvuruları sayısından bağımsız olarak her COM nesnesi için tam olarak bir RCW oluşturur.</span><span class="sxs-lookup"><span data-stu-id="e194d-105">The runtime creates exactly one RCW for each COM object, regardless of the number of references that exist on that object.</span></span> <span data-ttu-id="e194d-106">Çalışma zamanı her nesne için işlem başına tek bir RCW tutar.</span><span class="sxs-lookup"><span data-stu-id="e194d-106">The runtime maintains a single RCW per process for each object.</span></span>  <span data-ttu-id="e194d-107">Bir uygulama etki alanı veya grup bir RCW oluşturun ve daha sonra başka bir uygulama etki alanı ya da Grup başvuru geçirin, ilk nesne için bir proxy kullanılır.</span><span class="sxs-lookup"><span data-stu-id="e194d-107">If you create an RCW in one application domain or apartment, and then pass a reference to another application domain or apartment, a proxy to the first object will be used.</span></span>  <span data-ttu-id="e194d-108">Aşağıdaki çizimde gösterildiği gibi herhangi bir sayıda yönetilen istemciler INew ve INewer arabirimleri kullanıma COM nesnelerine başvuru basılı tutabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e194d-108">As the following illustration shows, any number of managed clients can hold a reference to the COM objects that expose INew and INewer interfaces.</span></span>  
  
 <span data-ttu-id="e194d-109">![RCW](../../../docs/framework/interop/media/rcw.gif "rcw")</span><span class="sxs-lookup"><span data-stu-id="e194d-109">![RCW](../../../docs/framework/interop/media/rcw.gif "rcw")</span></span>  
<span data-ttu-id="e194d-110">Çalışma zamanı aranabilir sarmalayıcısı COM nesnelerine erişme</span><span class="sxs-lookup"><span data-stu-id="e194d-110">Accessing COM objects through the runtime callable wrapper</span></span>  
  
 <span data-ttu-id="e194d-111">Türetilmiş bir tür kitaplığından meta verileri kullanarak, çalışma zamanı çağrılan COM nesnesi ve bu nesne için bir sarmalayıcı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="e194d-111">Using metadata derived from a type library, the runtime creates both the COM object being called and a wrapper for that object.</span></span> <span data-ttu-id="e194d-112">Her RCW sarmalar ve RCW artık gerekli olmadığında, başvuru COM nesnesi üzerinde serbest COM nesnesindeki arabirim işaretçileri, bir önbelleğini korur.</span><span class="sxs-lookup"><span data-stu-id="e194d-112">Each RCW maintains a cache of interface pointers on the COM object it wraps and releases its reference on the COM object when the RCW is no longer needed.</span></span> <span data-ttu-id="e194d-113">Çalışma Zamanı Modülü çöp toplama RCW üzerinde gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="e194d-113">The runtime performs garbage collection on the RCW.</span></span>  
  
 <span data-ttu-id="e194d-114">Diğer etkinlikler arasında veri Sarmalanan nesne adına yönetilen ve yönetilmeyen kodu arasında RCW sıralar.</span><span class="sxs-lookup"><span data-stu-id="e194d-114">Among other activities, the RCW marshals data between managed and unmanaged code, on behalf of the wrapped object.</span></span> <span data-ttu-id="e194d-115">Özellikle, istemci ve sunucu arasında aktarılan veriler farklı sunumu sahip olduklarında yöntem bağımsız değişkenleri ve yöntemi dönüş değerleri için hazırlama RCW sağlar.</span><span class="sxs-lookup"><span data-stu-id="e194d-115">Specifically, the RCW provides marshaling for method arguments and method return values whenever the client and server have different representations of the data passed between them.</span></span>  
  
 <span data-ttu-id="e194d-116">Standart sarmalayıcı yerleşik hazırlama kurallarının uygulanmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="e194d-116">The standard wrapper enforces built-in marshaling rules.</span></span> <span data-ttu-id="e194d-117">Örneğin, bir .NET istemci yönetilmeyen nesneye bağımsız değişken bir parçası olarak bir dize türü geçtiğinde, sarmalayıcı dize BSTR türüne dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="e194d-117">For example, when a .NET client passes a String type as part of an argument to an unmanaged object, the wrapper converts the string to a BSTR type.</span></span> <span data-ttu-id="e194d-118">COM nesnesi BSTR yönetilen çağırıcısına döndürmelidir, çağıran bir dize alır.</span><span class="sxs-lookup"><span data-stu-id="e194d-118">Should the COM object return a BSTR to its managed caller, the caller receives a String.</span></span> <span data-ttu-id="e194d-119">İstemci ve sunucu gönderebilir ve bunlara alışkın olduğu veri alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e194d-119">Both the client and the server send and receive data that is familiar to them.</span></span> <span data-ttu-id="e194d-120">Diğer türleri dönüştürme gerektirir.</span><span class="sxs-lookup"><span data-stu-id="e194d-120">Other types require no conversion.</span></span> <span data-ttu-id="e194d-121">Örneğin, standart bir sarmalayıcı tür dönüştürme olmadan yönetilen ve yönetilmeyen kodu arasında her zaman bir 4-bayt tamsayı geçer.</span><span class="sxs-lookup"><span data-stu-id="e194d-121">For instance, a standard wrapper will always pass a 4-byte integer between managed and unmanaged code without converting the type.</span></span>  
  
## <a name="marshaling-selected-interfaces"></a><span data-ttu-id="e194d-122">Seçili arabirimleri hazırlama</span><span class="sxs-lookup"><span data-stu-id="e194d-122">Marshaling selected interfaces</span></span>  
 <span data-ttu-id="e194d-123">Birincil amacı, [çalışma zamanı aranabilir sarmalayıcısı](../../../docs/framework/interop/runtime-callable-wrapper.md) (RCW) olan yönetilen ve yönetilmeyen programlama modelleri arasındaki farklar gizlemek için.</span><span class="sxs-lookup"><span data-stu-id="e194d-123">The primary goal of the [runtime callable wrapper](../../../docs/framework/interop/runtime-callable-wrapper.md) (RCW) is to hide the differences between the managed and unmanaged programming models.</span></span> <span data-ttu-id="e194d-124">Sorunsuz bir geçiş oluşturmak için RCW Seçili COM arabirimleri .NET istemciye sokmadan aşağıdaki çizimde gösterildiği gibi kullanır.</span><span class="sxs-lookup"><span data-stu-id="e194d-124">To create a seamless transition, the RCW consumes selected COM interfaces without exposing them to the .NET client, as shown in the following illustration.</span></span>  
  
 <span data-ttu-id="e194d-125">![RCW ile arabirimleri](../../../docs/framework/interop/media/rcwwithinterfaces.gif "rcwwithinterfaces")</span><span class="sxs-lookup"><span data-stu-id="e194d-125">![RCW With Interfaces](../../../docs/framework/interop/media/rcwwithinterfaces.gif "rcwwithinterfaces")</span></span>  
<span data-ttu-id="e194d-126">COM arabirimleri ve çalışma zamanı aranabilir sarmalayıcısı</span><span class="sxs-lookup"><span data-stu-id="e194d-126">COM interfaces and the runtime callable wrapper</span></span>  
  
 <span data-ttu-id="e194d-127">Erken bağlama nesnesi olarak oluşturduğunuzda, RCW belirli bir türüdür.</span><span class="sxs-lookup"><span data-stu-id="e194d-127">When created as an early-bound object, the RCW is a specific type.</span></span> <span data-ttu-id="e194d-128">COM nesnesi uygular ve yöntemleri, özellikleri ve olayları nesnenin arabirimlerinden gösterir arabirimlerini uygular.</span><span class="sxs-lookup"><span data-stu-id="e194d-128">It implements the interfaces that the COM object implements and exposes the methods, properties, and events from the object's interfaces.</span></span> <span data-ttu-id="e194d-129">Çizimde, RCW INew arabirimi gösterir ancak tüketir **IUnknown** ve **IDispatch** arabirimleri.</span><span class="sxs-lookup"><span data-stu-id="e194d-129">In the illustration, the RCW exposes the INew interface but consumes the **IUnknown** and **IDispatch** interfaces.</span></span> <span data-ttu-id="e194d-130">Ayrıca, RCW .NET istemci INew arabirimin tüm üyeleri ortaya koyar.</span><span class="sxs-lookup"><span data-stu-id="e194d-130">Further, the RCW exposes all members of the INew interface to the .NET client.</span></span>  
  
 <span data-ttu-id="e194d-131">RCW sarmaladığı nesnesi tarafından sunulan aşağıdaki tabloda listelenen arabirimler tüketir.</span><span class="sxs-lookup"><span data-stu-id="e194d-131">The RCW consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="e194d-132">Arabirim</span><span class="sxs-lookup"><span data-stu-id="e194d-132">Interface</span></span>|<span data-ttu-id="e194d-133">Açıklama</span><span class="sxs-lookup"><span data-stu-id="e194d-133">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="e194d-134">**IDispatch**</span><span class="sxs-lookup"><span data-stu-id="e194d-134">**IDispatch**</span></span>|<span data-ttu-id="e194d-135">COM nesnelerine yansıma aracılığıyla geç bağlama için.</span><span class="sxs-lookup"><span data-stu-id="e194d-135">For late binding to COM objects through reflection.</span></span>|  
|<span data-ttu-id="e194d-136">**IErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="e194d-136">**IErrorInfo**</span></span>|<span data-ttu-id="e194d-137">Hata, kaynağı, bir Yardım dosyası, Yardım içeriği ve hata tanımlı arabirimi GUID metinsel açıklaması sağlar (her zaman **GUID_NULL** .NET sınıfları için).</span><span class="sxs-lookup"><span data-stu-id="e194d-137">Provides a textual description of the error, its source, a Help file, Help context, and the GUID of the interface that defined the error (always **GUID_NULL** for .NET classes).</span></span>|  
|<span data-ttu-id="e194d-138">**IProvideClassInfo'yu**</span><span class="sxs-lookup"><span data-stu-id="e194d-138">**IProvideClassInfo**</span></span>|<span data-ttu-id="e194d-139">COM Nesne Implements sarılan varsa **IProvideClassInfo'yu**, RCW türü bilgileri daha iyi türü kimlik sağlamak için bu arabirimden ayıklar.</span><span class="sxs-lookup"><span data-stu-id="e194d-139">If the COM object being wrapped implements **IProvideClassInfo**, the RCW extracts the type information from this interface to provide better type identity.</span></span>|  
|<span data-ttu-id="e194d-140">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="e194d-140">**IUnknown**</span></span>|<span data-ttu-id="e194d-141">Nesne kimliği, türü zorlama ve ömür yönetimi için:</span><span class="sxs-lookup"><span data-stu-id="e194d-141">For object identity, type coercion, and lifetime management:</span></span><br /><br /> <span data-ttu-id="e194d-142">-Nesne Kimliği</span><span class="sxs-lookup"><span data-stu-id="e194d-142">-   Object identity</span></span><br />     <span data-ttu-id="e194d-143">Çalışma zamanı değeri karşılaştırarak COM nesneleri arasında ayırt **IUnknown** her nesne için arabirim.</span><span class="sxs-lookup"><span data-stu-id="e194d-143">The runtime distinguishes between COM objects by comparing the value of the **IUnknown** interface for each object.</span></span><br /><span data-ttu-id="e194d-144">-Type zorlama</span><span class="sxs-lookup"><span data-stu-id="e194d-144">-   Type coercion</span></span><br />     <span data-ttu-id="e194d-145">RCW tarafından gerçekleştirilen dinamik tür bulma tanıdığı **QueryInterface** yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e194d-145">The RCW recognizes the dynamic type discovery performed by the **QueryInterface** method.</span></span><br /><span data-ttu-id="e194d-146">-Ömür Yönetimi</span><span class="sxs-lookup"><span data-stu-id="e194d-146">-   Lifetime management</span></span><br />     <span data-ttu-id="e194d-147">Kullanarak **QueryInterface** yöntemi RCW alır ve Çalışma Zamanı Modülü çöp toplama yönetilmeyen nesne serbest sarmalayıcı üzerinde gerçekleştirir kadar yönetilmeyen bir nesneye başvuru tutar.</span><span class="sxs-lookup"><span data-stu-id="e194d-147">Using the **QueryInterface** method, the RCW gets and holds a reference to an unmanaged object until the runtime performs garbage collection on the wrapper, which releases the unmanaged object.</span></span>|  
  
 <span data-ttu-id="e194d-148">RCW isteğe bağlı olarak aşağıdaki tabloda listelenen arabirimler sarmaladığı nesnesi tarafından sunulan tüketir.</span><span class="sxs-lookup"><span data-stu-id="e194d-148">The RCW optionally consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="e194d-149">Arabirim</span><span class="sxs-lookup"><span data-stu-id="e194d-149">Interface</span></span>|<span data-ttu-id="e194d-150">Açıklama</span><span class="sxs-lookup"><span data-stu-id="e194d-150">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="e194d-151">**IConnectionPoint** ve **IConnectionPointContainer**</span><span class="sxs-lookup"><span data-stu-id="e194d-151">**IConnectionPoint** and **IConnectionPointContainer**</span></span>|<span data-ttu-id="e194d-152">Bağlantı noktası olayı stili olayları temsilci göre kullanıma RCW dönüştürür nesneleri.</span><span class="sxs-lookup"><span data-stu-id="e194d-152">The RCW converts objects that expose the connection-point event style to delegate-based events.</span></span>|  
|<span data-ttu-id="e194d-153">**Idispatchex**</span><span class="sxs-lookup"><span data-stu-id="e194d-153">**IDispatchEx**</span></span>|<span data-ttu-id="e194d-154">Sınıf uyguluyorsa **Idispatchex**, RCW uygulayan **IExpando**.</span><span class="sxs-lookup"><span data-stu-id="e194d-154">If the class implements **IDispatchEx**, the RCW implements **IExpando**.</span></span> <span data-ttu-id="e194d-155">**Idispatchex** arabirimi uzantısıdır **IDispatch** aksine, arabirim **IDispatch**, numaralandırma, ekleme, silme, sağlar ve büyük küçük harfe duyarlı üyeleri çağrılıyor.</span><span class="sxs-lookup"><span data-stu-id="e194d-155">The **IDispatchEx** interface is an extension of the **IDispatch** interface that, unlike **IDispatch**, enables enumeration, addition, deletion, and case-sensitive calling of members.</span></span>|  
|<span data-ttu-id="e194d-156">**IEnumVARIANT**</span><span class="sxs-lookup"><span data-stu-id="e194d-156">**IEnumVARIANT**</span></span>|<span data-ttu-id="e194d-157">Koleksiyon olarak kabul edilmesi için numaralandırmalar destekleyen COM türler sağlar.</span><span class="sxs-lookup"><span data-stu-id="e194d-157">Enables COM types that support enumerations to be treated as collections.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e194d-158">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="e194d-158">See Also</span></span>  
 [<span data-ttu-id="e194d-159">COM Sarmalayıcıları</span><span class="sxs-lookup"><span data-stu-id="e194d-159">COM Wrappers</span></span>](../../../docs/framework/interop/com-wrappers.md)  
 [<span data-ttu-id="e194d-160">Seçili arabirimleri hazırlama</span><span class="sxs-lookup"><span data-stu-id="e194d-160">Marshaling Selected Interfaces</span></span>](http://msdn.microsoft.com/en-us/fdb97fd0-f694-4832-bf15-a4e7cf413840)  
 [<span data-ttu-id="e194d-161">COM Çağrılabilir Sarmalayıcısı</span><span class="sxs-lookup"><span data-stu-id="e194d-161">COM Callable Wrapper</span></span>](../../../docs/framework/interop/com-callable-wrapper.md)  
 [<span data-ttu-id="e194d-162">Derleme dönüştürme özeti için tür kitaplığı</span><span class="sxs-lookup"><span data-stu-id="e194d-162">Type Library to Assembly Conversion Summary</span></span>](http://msdn.microsoft.com/en-us/bf3f90c5-4770-4ab8-895c-3ba1055cc958)  
 [<span data-ttu-id="e194d-163">Tür Kitaplığını Bütünleştirilmiş Kod Olarak İçeri Aktarma</span><span class="sxs-lookup"><span data-stu-id="e194d-163">Importing a Type Library as an Assembly</span></span>](../../../docs/framework/interop/importing-a-type-library-as-an-assembly.md)
