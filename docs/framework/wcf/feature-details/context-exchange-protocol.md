---
title: "Bağlam Değişimi Protokolü"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3dfd38e0-ae52-491c-94f4-7a862b9843d4
caps.latest.revision: "6"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 8f19b228eadcf8dabfaba2fc31f4f49f1b4d149b
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/22/2017
---
# <a name="context-exchange-protocol"></a><span data-ttu-id="a4efc-102">Bağlam Değişimi Protokolü</span><span class="sxs-lookup"><span data-stu-id="a4efc-102">Context Exchange Protocol</span></span>
<span data-ttu-id="a4efc-103">Bu bölümde sunulan bağlam değişimi protokolü açıklar [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] serbest bırakın.</span><span class="sxs-lookup"><span data-stu-id="a4efc-103">This section describes the context exchange protocol introduced in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)][!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] release.</span></span> <span data-ttu-id="a4efc-104">Bu protokol hizmeti tarafından sağlanan bir bağlam kabul etmek ve tüm istekler aynı istemci kanal örneği gönderilen bu hizmete uygulamak istemci kanal sağlar.</span><span class="sxs-lookup"><span data-stu-id="a4efc-104">This protocol allows the client channel to accept a context supplied by a service and apply it to all subsequent requests to that service sent over the same client channel instance.</span></span> <span data-ttu-id="a4efc-105">Bağlam değişimi Protokolü aşağıdaki iki mekanizmalardan biri sunucu ve istemci arasındaki bağlam yaymak için kullanabilirsiniz: HTTP tanımlama bilgilerini veya SOAP üstbilgisi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-105">The implementation of the context exchange protocol can use one of the following two mechanisms to propagate the context between the server and the client: HTTP cookies or a SOAP header.</span></span>  
  
 <span data-ttu-id="a4efc-106">Bağlam değişimi protokolü özel kanal katmanında uygulanır.</span><span class="sxs-lookup"><span data-stu-id="a4efc-106">The context exchange protocol is implemented in a custom channel layer.</span></span> <span data-ttu-id="a4efc-107">Kanal bağlamı uygulama katmanı kullanarak gelen ve giden iletişim kuran bir <xref:System.ServiceModel.Channels.ContextMessageProperty> özelliği.</span><span class="sxs-lookup"><span data-stu-id="a4efc-107">The channel communicates the context to and from the application layer using a <xref:System.ServiceModel.Channels.ContextMessageProperty> property.</span></span> <span data-ttu-id="a4efc-108">Uç noktalar arasında aktarım için context değeri SOAP üstbilgi kanal katmanında olarak serileştirilmiş, veya için veya bir HTTP istek ve yanıt temsil eden ileti özelliklerinin dönüştürülür.</span><span class="sxs-lookup"><span data-stu-id="a4efc-108">For transmission between endpoints, the value of the context is either serialized as a SOAP header at the channel layer, or converted to or from the message properties that represent a HTTP request and response.</span></span> <span data-ttu-id="a4efc-109">İkinci durumda, kanal katmanlarda birini HTTP istek ve yanıt ileti özelliklerini HTTP tanımlama bilgileri, gelen ve giden sırasıyla dönüştürdüğü beklenir.</span><span class="sxs-lookup"><span data-stu-id="a4efc-109">In the latter case, it is expected that one of the underlying channel layers converts the HTTP request and response message properties to and from HTTP cookies, respectively.</span></span> <span data-ttu-id="a4efc-110">Bağlam değişimi için kullanılan mekanizma seçimi yapılır kullanarak <xref:System.ServiceModel.Channels.ContextExchangeMechanism> özelliği <xref:System.ServiceModel.Channels.ContextBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-110">The choice of the mechanism used to exchange the context is done using the <xref:System.ServiceModel.Channels.ContextExchangeMechanism> property on the <xref:System.ServiceModel.Channels.ContextBindingElement>.</span></span> <span data-ttu-id="a4efc-111">Geçerli değerler `HttpCookie` veya `SoapHeader`.</span><span class="sxs-lookup"><span data-stu-id="a4efc-111">Valid values are `HttpCookie` or `SoapHeader`.</span></span>  
  
 <span data-ttu-id="a4efc-112">İstemci üzerinde bir kanal örneği kanal özellikte ayarlara göre iki modda çalışabilir <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-112">On the client, an instance of a channel can operate in two modes based on the settings on the channel property, <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A>.</span></span>  
  
## <a name="mode-1-channel-context-management"></a><span data-ttu-id="a4efc-113">Mod 1: Kanal içerik yönetimi</span><span class="sxs-lookup"><span data-stu-id="a4efc-113">Mode 1: Channel Context Management</span></span>  
 <span data-ttu-id="a4efc-114">Bu varsayılan moddur nerede <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> ayarlanır `true`.</span><span class="sxs-lookup"><span data-stu-id="a4efc-114">This is the default mode where <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> is set to `true`.</span></span> <span data-ttu-id="a4efc-115">Bu modda içerik kanalı bağlam yönetir ve bağlam yaşam süresi boyunca önbelleğe alır.</span><span class="sxs-lookup"><span data-stu-id="a4efc-115">In this mode the context channel manages the context and caches the context during its lifetime.</span></span> <span data-ttu-id="a4efc-116">İçerik kanalı özelliği aracılığıyla kanaldan alınabilir `IContextManager` çağırarak `GetContext` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-116">Context can be retrieved from the channel through channel property `IContextManager` by calling the `GetContext` method.</span></span> <span data-ttu-id="a4efc-117">Kanal ayrıca çağırarak açılmasını önce belirli bağlamla önceden başlatılmış olabilir `SetContext` kanal özellikte yöntemi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-117">The channel can also be pre-initialized with specific context before being opened by calling the `SetContext` method on the channel property.</span></span> <span data-ttu-id="a4efc-118">Kanal bağlamla başlatıldıktan sonra sıfırlanamaz.</span><span class="sxs-lookup"><span data-stu-id="a4efc-118">Once the channel is initialized with context it cannot be reset.</span></span>  
  
 <span data-ttu-id="a4efc-119">Bu modda invariants listesi aşağıdadır:</span><span class="sxs-lookup"><span data-stu-id="a4efc-119">The following is a list of invariants in this mode:</span></span>  
  
-   <span data-ttu-id="a4efc-120">Yapmaya bağlamını kullanarak sıfırlamak `SetContext` kanal açılan atar sağlandıktan sonra bir <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-120">Any attempt to reset the context using `SetContext` after the channel has been opened throws an <xref:System.InvalidOperationException>.</span></span>  
  
-   <span data-ttu-id="a4efc-121">Yapmaya bağlamı kullanarak göndermek <xref:System.ServiceModel.Channels.ContextMessageProperty> giden iletisinde oluşturur bir <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-121">Any attempt to send context by using the <xref:System.ServiceModel.Channels.ContextMessageProperty> in an outgoing message throws an <xref:System.InvalidOperationException>.</span></span>  
  
-   <span data-ttu-id="a4efc-122">Kanalı ile belirli bir bağlam zaten başlatılmış olan bir ileti ile belirli bir bağlam sunucusundan alınırsa, bu sonuçlanan bir <xref:System.ServiceModel.ProtocolException>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-122">If a message is received from server with a specific context, when the channel has already been initialized with a specific context, this results in a <xref:System.ServiceModel.ProtocolException>.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="a4efc-123">Yalnızca açık olarak ayarlanıp herhangi bir bağlam olmadan kanal açtıysanız ilk içerik sunucusundan almak uygundur.</span><span class="sxs-lookup"><span data-stu-id="a4efc-123">It is appropriate to receive an initial context from the server only if the channel is opened without any context set explicitly.</span></span>  
  
-   <span data-ttu-id="a4efc-124"><xref:System.ServiceModel.Channels.ContextMessageProperty> Gelen ileti üzerinde her zaman boştur.</span><span class="sxs-lookup"><span data-stu-id="a4efc-124">The <xref:System.ServiceModel.Channels.ContextMessageProperty> on incoming message is always null.</span></span>  
  
## <a name="mode-2-application-context-management"></a><span data-ttu-id="a4efc-125">Mod 2: Uygulama içerik yönetimi</span><span class="sxs-lookup"><span data-stu-id="a4efc-125">Mode 2: Application Context Management</span></span>  
 <span data-ttu-id="a4efc-126">Bu mod olduğu zaman <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> ayarlanır `false`.</span><span class="sxs-lookup"><span data-stu-id="a4efc-126">This is the mode when <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> is set to `false`.</span></span> <span data-ttu-id="a4efc-127">Bu modda, bağlam içerik kanalı yönetmez.</span><span class="sxs-lookup"><span data-stu-id="a4efc-127">In this mode the context channel does not manage context.</span></span> <span data-ttu-id="a4efc-128">Bu almak, yönetmek ve bağlamı kullanarak uygulamak için uygulamanın sorumluluğundadır <xref:System.ServiceModel.Channels.ContextMessageProperty>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-128">It is the application's responsibility to retrieve, manage and apply context by using the <xref:System.ServiceModel.Channels.ContextMessageProperty>.</span></span> <span data-ttu-id="a4efc-129">Herhangi bir çağrı dener `GetContext` veya `SetContext` sonuçlanan bir <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-129">Any attempt to call `GetContext` or `SetContext` results in an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="a4efc-130">Hangi modun olsun istemci kanal fabrikası destekleyen seçilir <xref:System.ServiceModel.Channels.IRequestChannel>, <xref:System.ServiceModel.Channels.IRequestSessionChannel>, ve <xref:System.ServiceModel.Channels.IDuplexSessionChannel> exchange desenleri iletisi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-130">No matter which mode is chosen the client channel factory supports <xref:System.ServiceModel.Channels.IRequestChannel>, <xref:System.ServiceModel.Channels.IRequestSessionChannel>, and <xref:System.ServiceModel.Channels.IDuplexSessionChannel> message exchange patterns.</span></span>  
  
 <span data-ttu-id="a4efc-131">Hizmette kanal örneği gelen iletiler için istemci tarafından sağlanan içerik dönüştürme için sorumlu olan <xref:System.ServiceModel.Channels.ContextMessageProperty>.</span><span class="sxs-lookup"><span data-stu-id="a4efc-131">On the service, an instance of the channel is responsible for converting the context supplied by the client on incoming messages to the <xref:System.ServiceModel.Channels.ContextMessageProperty>.</span></span> <span data-ttu-id="a4efc-132">İleti özelliği sonra uygulama katmanı tarafından erişilebilir veya diğer kanallar çağrı yığınında daha.</span><span class="sxs-lookup"><span data-stu-id="a4efc-132">The message property can then be accessed by the application layer or other channels further up in the call stack.</span></span> <span data-ttu-id="a4efc-133">Hizmet kanal ekleyerek istemciye yayılması için yeni bir bağlam değeri belirtmek uygulama katmanı da izin bir <xref:System.ServiceModel.Channels.ContextMessageProperty> yanıt iletisi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-133">The service channels also allow the application layer to specify a new context value to be propagated back to the client by attaching a <xref:System.ServiceModel.Channels.ContextMessageProperty> to the response message.</span></span> <span data-ttu-id="a4efc-134">Bu özellik, SOAP üstbilgi veya bağlama yapılandırmasına bağlıdır bağlamını içeren HTTP tanımlama bilgisi dönüştürülür.</span><span class="sxs-lookup"><span data-stu-id="a4efc-134">This property is converted to the SOAP header or HTTP cookie that contains the context, which depends on the configuration of the binding.</span></span> <span data-ttu-id="a4efc-135">Hizmet kanal dinleyicisi destekler <xref:System.ServiceModel.Channels.IReplyChannel>, <xref:System.ServiceModel.Channels.IReplySessionChannel>, ve <xref:System.ServiceModel.Channels.IReplySessionChannel> exchange desenleri iletisi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-135">The service channel listener supports <xref:System.ServiceModel.Channels.IReplyChannel>, <xref:System.ServiceModel.Channels.IReplySessionChannel>, and <xref:System.ServiceModel.Channels.IReplySessionChannel> message exchange patterns.</span></span>  
  
 <span data-ttu-id="a4efc-136">Bağlam değişimi Protokolü yeni tanıtır `wsc:Context` SOAP üstbilgi HTTP bağlamı yaymak için kullanılmaz, bağlam bilgilerini temsil eder.</span><span class="sxs-lookup"><span data-stu-id="a4efc-136">The context exchange protocol introduces a new `wsc:Context` SOAP header to represent the context information when HTTP cookies are not used to propagate the context.</span></span> <span data-ttu-id="a4efc-137">İçerik Üstbilgisi şemasının herhangi bir sayıda alt öğeleri, her bir dize anahtar ve dize içeriği sağlar.</span><span class="sxs-lookup"><span data-stu-id="a4efc-137">The context header schema allows for any number of child elements, each with a string key and string content.</span></span> <span data-ttu-id="a4efc-138">İçerik üstbilgisinin bir örnek verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="a4efc-138">The following is an example of a context header.</span></span>  
  
 `<Context xmlns="http://schemas.microsoft.com/ws/2006/05/context">`  
  
 `<property name="myContext">context-2</property>`  
  
 `</Context>`  
  
 <span data-ttu-id="a4efc-139">Zaman içinde `HttpCookie` modu, tanımlama bilgileri kullanılarak ayarlanır `SetCookie` üstbilgi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-139">When in `HttpCookie` mode, cookies are set using the `SetCookie` header.</span></span> <span data-ttu-id="a4efc-140">Tanımlama bilgisi adıdır `WscContext`.</span><span class="sxs-lookup"><span data-stu-id="a4efc-140">The cookie name is `WscContext`.</span></span> <span data-ttu-id="a4efc-141">Base64 tanımlama bilgisinin değeri kodlamasını `wsc:Context` üstbilgi.</span><span class="sxs-lookup"><span data-stu-id="a4efc-141">The value of the cookie is the Base64 encoding of the `wsc:Context` header.</span></span> <span data-ttu-id="a4efc-142">Bu değer tırnak işaretleri içine alınır.</span><span class="sxs-lookup"><span data-stu-id="a4efc-142">This value is enclosed in quotes.</span></span>  
  
 <span data-ttu-id="a4efc-143">Aynı nedenden dolayı aktarımda WS adresleme üstbilgileri korunan sırada context değeri değiştirilmeye karşı korumalı olması gereken – üstbilgi hizmette isteğin gönderileceği yeri belirlemek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="a4efc-143">The value of the context must be protected from modification while in transit for the same reason WS-Addressing headers are protected – the header is used to determine where to dispatch the request to on the service.</span></span> <span data-ttu-id="a4efc-144">`wsc:Context` Üstbilgisi bu nedenle dijital olarak imzalanmış veya imzalanmasını ve bağlama ileti koruma özelliği önerdiğinde SOAP veya aktarım düzeyinde şifrelenmiş için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="a4efc-144">The `wsc:Context` header is therefore required to be digitally signed or signed and encrypted at either the SOAP or transport level when the binding offers message protection capability.</span></span> <span data-ttu-id="a4efc-145">HTTP tanımlama bilgilerini bağlam yaymak için kullanıldığında, taşıma güveliği kullanarak korunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="a4efc-145">When HTTP cookies are used to propagate context, they should be protected using transport security.</span></span>  
  
 <span data-ttu-id="a4efc-146">Bağlam değişimi protokolü için desteği gerektiren hizmet uç noktaları yayımlanan ilkesinde açık yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a4efc-146">Service endpoints that require support for the context exchange protocol can make it explicit in the published policy.</span></span> <span data-ttu-id="a4efc-147">Bağlam değişimi Protokolü SOAP düzeyinde desteklemek veya HTTP tanımlama bilgisi desteğini etkinleştirmek için istemci gereksinimini göstermek için iki yeni ilke onaylamalarını tanıtılmıştır.</span><span class="sxs-lookup"><span data-stu-id="a4efc-147">Two new policy assertions have been introduced to represent the requirement for the client to support the context exchange protocol at the SOAP level or to enable HTTP cookie support.</span></span> <span data-ttu-id="a4efc-148">Bu onaylar hizmet ilkesindeki içine nesil değeri tarafından denetlenen <xref:System.ServiceModel.Channels.ContextBindingElement.ContextExchangeMechanism%2A> özelliğini aşağıdaki gibi:</span><span class="sxs-lookup"><span data-stu-id="a4efc-148">Generation of these assertions into the policy on the service is controlled by the value of the <xref:System.ServiceModel.Channels.ContextBindingElement.ContextExchangeMechanism%2A> property as follows:</span></span>  
  
-   <span data-ttu-id="a4efc-149">İçin <xref:System.ServiceModel.Channels.ContextExchangeMechanism.ContextSoapHeader>, aşağıdaki onay oluşturulur:</span><span class="sxs-lookup"><span data-stu-id="a4efc-149">For <xref:System.ServiceModel.Channels.ContextExchangeMechanism.ContextSoapHeader>, the following assertion is generated:</span></span>  
  
    ```xml  
    <IncludeContext   
    xmlns="http://schemas.microsoft.com/ws/2006/05/context"  
    protectionLevel="Sign" />  
    ```  
  
-   <span data-ttu-id="a4efc-150">İçin <xref:System.ServiceModel.Channels.ContextExchangeMechanism.HttpCookie>, aşağıdaki onay oluşturulur:</span><span class="sxs-lookup"><span data-stu-id="a4efc-150">For <xref:System.ServiceModel.Channels.ContextExchangeMechanism.HttpCookie>, the following assertion is generated:</span></span>  
  
    ```xml  
    <HttpUseCookie xmlns="http://schemas.xmlsoap.org/soap/http"/>  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="a4efc-151">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="a4efc-151">See Also</span></span>  
 [<span data-ttu-id="a4efc-152">Web Hizmetleri Protokolleri Birlikte Çalışabilirlik Kılavuzu</span><span class="sxs-lookup"><span data-stu-id="a4efc-152">Web Services Protocols Interoperability Guide</span></span>](../../../../docs/framework/wcf/feature-details/web-services-protocols-interoperability-guide.md)
