---
title: "Nesne Ömrü: Nesneleri Oluşturma ve Yok Etme (Visual Basic)"
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
f1_keywords:
- vb.Constructor
helpviewer_keywords:
- destructors, object lifetime
- Sub Finalize destructor
- objects [Visual Basic], destroying
- lifetime [Visual Basic], objects
- Sub New constructor, object lifetime
- Finalize method [Visual Basic], object lifetime
- objects [Visual Basic], creating
- Class_Terminate
- Dispose method [Visual Basic], object lifetime
- Class_Initialize
- object creation [Visual Basic], object lifetime
- parameterized constructors
- objects [Visual Basic], lifetime
- objects [Visual Basic], garbage collection
- constructors [Visual Basic], object lifetime
- Sub Dispose destructor
- garbage collection [Visual Basic], Visual Basic
ms.assetid: f1ee8458-b156-44e0-9a8a-5dd171648cd8
caps.latest.revision: 
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: f985d6bf7b26ec22d6e533eae1f1d7ea0682e56c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/21/2017
---
# <a name="object-lifetime-how-objects-are-created-and-destroyed-visual-basic"></a><span data-ttu-id="66036-102">Nesne Ömrü: Nesneleri Oluşturma ve Yok Etme (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="66036-102">Object Lifetime: How Objects Are Created and Destroyed (Visual Basic)</span></span>
<span data-ttu-id="66036-103">Bir nesne bir sınıfının bir örneği kullanılarak oluşturulan `New` anahtar sözcüğü.</span><span class="sxs-lookup"><span data-stu-id="66036-103">An instance of a class, an object, is created by using the `New` keyword.</span></span> <span data-ttu-id="66036-104">Bunlar kullanılmadan önce başlatma görevlerini genellikle yeni nesneler üzerinde gerçekleştirilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="66036-104">Initialization tasks often must be performed on new objects before they are used.</span></span> <span data-ttu-id="66036-105">Veritabanlarına bağlanma ve kayıt defteri anahtarlarının değerlerini okuma dosyaları açma ortak başlatma görevlerini içerir.</span><span class="sxs-lookup"><span data-stu-id="66036-105">Common initialization tasks include opening files, connecting to databases, and reading values of registry keys.</span></span> <span data-ttu-id="66036-106">Visual Basic denetimleri adlı yordamları kullanarak yeni nesnelerin başlatılması *oluşturucular* (başlatma denetime izin veren özel yöntemleri).</span><span class="sxs-lookup"><span data-stu-id="66036-106">Visual Basic controls the initialization of new objects using procedures called *constructors* (special methods that allow control over initialization).</span></span>  
  
 <span data-ttu-id="66036-107">Bir nesne kapsam dışına çıktığında sonra ortak dil çalışma zamanı tarafından (CLR) serbest bırakılır.</span><span class="sxs-lookup"><span data-stu-id="66036-107">After an object leaves scope, it is released by the common language runtime (CLR).</span></span> <span data-ttu-id="66036-108">Visual Basic denetimleri yayın adı verilen yordamları kullanarak sistem kaynaklarını *Yıkıcılar*.</span><span class="sxs-lookup"><span data-stu-id="66036-108">Visual Basic controls the release of system resources using procedures called *destructors*.</span></span> <span data-ttu-id="66036-109">Birlikte oluşturucular ve Yıkıcılar sağlam ve tahmin edilebilir sınıf kitaplıkları oluşturulmasını destekler.</span><span class="sxs-lookup"><span data-stu-id="66036-109">Together, constructors and destructors support the creation of robust and predictable class libraries.</span></span>  
  
## <a name="using-constructors-and-destructors"></a><span data-ttu-id="66036-110">Oluşturucular ve yıkıcıları kullanma</span><span class="sxs-lookup"><span data-stu-id="66036-110">Using Constructors and Destructors</span></span>  
 <span data-ttu-id="66036-111">Oluşturucular ve Yıkıcılar oluşturma ve yok etme nesnelerin denetler.</span><span class="sxs-lookup"><span data-stu-id="66036-111">Constructors and destructors control the creation and destruction of objects.</span></span> <span data-ttu-id="66036-112">`Sub New` Ve `Sub Finalize` Visual Basic'de yordamlar başlatmak ve nesneleri yok; bunlar Değiştir `Class_Initialize` ve `Class_Terminate` kullanılan yöntemleri [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] 6.0 ve önceki sürümleri.</span><span class="sxs-lookup"><span data-stu-id="66036-112">The `Sub New` and `Sub Finalize` procedures in Visual Basic initialize and destroy objects; they replace the `Class_Initialize` and `Class_Terminate` methods used in [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] 6.0 and earlier versions.</span></span>  
  
### <a name="sub-new"></a><span data-ttu-id="66036-113">Yeni alt</span><span class="sxs-lookup"><span data-stu-id="66036-113">Sub New</span></span>  
 <span data-ttu-id="66036-114">`Sub New` Oluşturucusu yalnızca bir sınıf oluşturulduğunda bir kez çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="66036-114">The `Sub New` constructor can run only once when a class is created.</span></span> <span data-ttu-id="66036-115">Dışında açıkça herhangi bir yere çağrılamaz başka bir oluşturucusu aynı sınıfın veya türetilmiş bir sınıf kodunu ilk satırda.</span><span class="sxs-lookup"><span data-stu-id="66036-115">It cannot be called explicitly anywhere other than in the first line of code of another constructor from either the same class or from a derived class.</span></span> <span data-ttu-id="66036-116">Ayrıca, kodda `Sub New` yöntemi bir sınıftaki başka bir kod önce her zaman çalışır.</span><span class="sxs-lookup"><span data-stu-id="66036-116">Furthermore, the code in the `Sub New` method always runs before any other code in a class.</span></span> [!INCLUDE[vbprvblong](~/includes/vbprvblong-md.md)]<span data-ttu-id="66036-117">ve sonraki sürümler örtük olarak oluşturma bir `Sub New` Oluşturucusu değil açıkça tanımlarsanız çalışma zamanında bir `Sub New` yordamı için bir sınıf.</span><span class="sxs-lookup"><span data-stu-id="66036-117"> and later versions implicitly create a `Sub New` constructor at run time if you do not explicitly define a `Sub New` procedure for a class.</span></span>  
  
 <span data-ttu-id="66036-118">Bir sınıf için bir oluşturucu oluşturmak için adlandırılmış bir yordam oluşturma `Sub New` sınıf tanımı başka bir yerindeki.</span><span class="sxs-lookup"><span data-stu-id="66036-118">To create a constructor for a class, create a procedure named `Sub New` anywhere in the class definition.</span></span> <span data-ttu-id="66036-119">Parametreli bir oluşturucu oluşturmak için bağımsız değişken adları ve veri türlerini belirtin `Sub New` gibi aşağıdaki kodu olduğu gibi diğer tüm yordam bağımsız değişkenleri belirtmeniz gerekir:</span><span class="sxs-lookup"><span data-stu-id="66036-119">To create a parameterized constructor, specify the names and data types of arguments to `Sub New` just as you would specify arguments for any other procedure, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrOOP#42](../../../../visual-basic/misc/codesnippet/VisualBasic/object-lifetime-how-objects-are-created-and-destroyed_1.vb)]  
  
 <span data-ttu-id="66036-120">Oluşturucular sık, olduğu gibi aşağıdaki kodu aşırı:</span><span class="sxs-lookup"><span data-stu-id="66036-120">Constructors are frequently overloaded, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrOOP#116](../../../../visual-basic/misc/codesnippet/VisualBasic/object-lifetime-how-objects-are-created-and-destroyed_2.vb)]  
  
 <span data-ttu-id="66036-121">Başka bir sınıfından türetilmiş bir sınıf tanımladığınızda, temel sınıf parametre almayan bir erişilebilir yapıcı olmadıkça bir oluşturucu ilk satırını temel sınıf için bir çağrı olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="66036-121">When you define a class derived from another class, the first line of a constructor must be a call to the constructor of the base class, unless the base class has an accessible constructor that takes no parameters.</span></span> <span data-ttu-id="66036-122">Örneğin, yukarıdaki Oluşturucusu içeren temel sınıf için bir çağrı olabilir `MyBase.New(s)`.</span><span class="sxs-lookup"><span data-stu-id="66036-122">A call to the base class that contains the above constructor, for example, would be `MyBase.New(s)`.</span></span> <span data-ttu-id="66036-123">Aksi takdirde, `MyBase.New` isteğe bağlıdır ve [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] çalışma zamanı çağırır, örtük olarak.</span><span class="sxs-lookup"><span data-stu-id="66036-123">Otherwise, `MyBase.New` is optional, and the [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] runtime calls it implicitly.</span></span>  
  
 <span data-ttu-id="66036-124">Üst nesnenin oluşturucuyu çağırmak için kodu yazdıktan sonra herhangi bir ek başlatma kod ekleyebilirsiniz `Sub New` yordamı.</span><span class="sxs-lookup"><span data-stu-id="66036-124">After you write the code to call the parent object's constructor, you can add any additional initialization code to the `Sub New` procedure.</span></span> <span data-ttu-id="66036-125">`Sub New`Parametreli Oluşturucusu çağrıldığında bağımsız değişkenleri kabul edebilir.</span><span class="sxs-lookup"><span data-stu-id="66036-125">`Sub New` can accept arguments when called as a parameterized constructor.</span></span> <span data-ttu-id="66036-126">Bu gibi bir durumda oluşturucuyu çağıran yordamdan geçilen Bu parametreler `Dim AnObject As New ThisClass(X)`.</span><span class="sxs-lookup"><span data-stu-id="66036-126">These parameters are passed from the procedure calling the constructor, for example, `Dim AnObject As New ThisClass(X)`.</span></span>  
  
### <a name="sub-finalize"></a><span data-ttu-id="66036-127">Sub Finalize</span><span class="sxs-lookup"><span data-stu-id="66036-127">Sub Finalize</span></span>  
 <span data-ttu-id="66036-128">Nesneleri serbest bırakmadan önce CLR otomatik olarak çağırır `Finalize` yöntemi tanımlayan nesneleri için bir `Sub Finalize` yordamı.</span><span class="sxs-lookup"><span data-stu-id="66036-128">Before releasing objects, the CLR automatically calls the `Finalize` method for objects that define a `Sub Finalize` procedure.</span></span> <span data-ttu-id="66036-129">`Finalize` Yöntemi yalnızca bir nesne, dosyaları kapatma ve durum bilgilerini kaydetmek için kod gibi kaldırıldığı önce yürütmek için gereken kodu içerebilir.</span><span class="sxs-lookup"><span data-stu-id="66036-129">The `Finalize` method can contain code that needs to execute just before an object is destroyed, such as code for closing files and saving state information.</span></span> <span data-ttu-id="66036-130">Bulunmaktadır yürütmek küçük bir performans `Sub Finalize`, tanımlamanız gerekir böylece bir `Sub Finalize` nesneleri açıkça serbest gerektiğinde yöntemi.</span><span class="sxs-lookup"><span data-stu-id="66036-130">There is a slight performance penalty for executing `Sub Finalize`, so you should define a `Sub Finalize` method only when you need to release objects explicitly.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="66036-131">Çöp toplayıcı CLR'de elden desteklemez ve olamaz *yönetilmeyen nesneleri*, işletim sistemini doğrudan CLR ortamı dışında yürütür nesneleri.</span><span class="sxs-lookup"><span data-stu-id="66036-131">The garbage collector in the CLR does not (and cannot) dispose of *unmanaged objects*, objects that the operating system executes directly, outside the CLR environment.</span></span> <span data-ttu-id="66036-132">Bu durum, farklı yönetilmeyen nesneleri, farklı şekillerde çıkarılması gerekir çünkü.</span><span class="sxs-lookup"><span data-stu-id="66036-132">This is because different unmanaged objects must be disposed of in different ways.</span></span> <span data-ttu-id="66036-133">Bu bilgileri yönetilmeyen nesne ile doğrudan ilişkili değildir; Nesne belgelerindeki bulunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="66036-133">That information is not directly associated with the unmanaged object; it must be found in the documentation for the object.</span></span> <span data-ttu-id="66036-134">Yönetilmeyen nesneleri kullanan bir sınıfı bunları elden gerekir, `Finalize` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="66036-134">A class that uses unmanaged objects must dispose of them in its `Finalize` method.</span></span>  
  
 <span data-ttu-id="66036-135">`Finalize` Yıkıcı yalnızca ait sınıfından veya türetilmiş sınıflarından çağrılabilen bir yöntemdir korumalı.</span><span class="sxs-lookup"><span data-stu-id="66036-135">The `Finalize` destructor is a protected method that can be called only from the class it belongs to, or from derived classes.</span></span> <span data-ttu-id="66036-136">Sistem çağrıları `Finalize` otomatik olarak ne zaman bir nesne yok, açıkça arama şekilde `Finalize` öğesinden türetilmiş sınıf dışında `Finalize` uygulaması.</span><span class="sxs-lookup"><span data-stu-id="66036-136">The system calls `Finalize` automatically when an object is destroyed, so you should not explicitly call `Finalize` from outside of a derived class's `Finalize` implementation.</span></span>  
  
 <span data-ttu-id="66036-137">Farklı `Class_Terminate`, bir nesne için hiçbir şey ayarlanmış hemen yürütür, genellikle bir nesne kapsam zaman kaybeder ve Visual Basic çağırdığında arasında bir gecikme olur `Finalize` yıkıcı.</span><span class="sxs-lookup"><span data-stu-id="66036-137">Unlike `Class_Terminate`, which executes as soon as an object is set to nothing, there is usually a delay between when an object loses scope and when Visual Basic calls the `Finalize` destructor.</span></span> [!INCLUDE[vbprvblong](~/includes/vbprvblong-md.md)]<span data-ttu-id="66036-138">ve sonraki sürümler yıkıcı, ikinci bir tür için izin <xref:System.IDisposable.Dispose%2A>, hangi açıkça çağrılabilir hemen kaynakları serbest bırakmak için herhangi bir zamanda.</span><span class="sxs-lookup"><span data-stu-id="66036-138"> and later versions allow for a second kind of destructor, <xref:System.IDisposable.Dispose%2A>, which can be explicitly called at any time to immediately release resources.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="66036-139">A `Finalize` yıkıcı değil throw özel durumlar, çünkü bunlar uygulama tarafından işlenemez ve sonlandırmak uygulamanın neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="66036-139">A `Finalize` destructor should not throw exceptions, because they cannot be handled by the application and can cause the application to terminate.</span></span>  
  
### <a name="how-new-and-finalize-methods-work-in-a-class-hierarchy"></a><span data-ttu-id="66036-140">Yeni ve sınıf hiyerarşisi yöntemleri iş Sonlandır</span><span class="sxs-lookup"><span data-stu-id="66036-140">How New and Finalize Methods Work in a Class Hierarchy</span></span>  
 <span data-ttu-id="66036-141">Her bir sınıfının örneği oluşturulduğunda, ortak dil çalışma zamanı (CLR) adlı bir yordam yürütmeyi denediğinde `New`, söz konusu nesne varsa.</span><span class="sxs-lookup"><span data-stu-id="66036-141">Whenever an instance of a class is created, the common language runtime (CLR) attempts to execute a procedure named `New`, if it exists in that object.</span></span> <span data-ttu-id="66036-142">`New`çağrılan yordam türünde bir `constructor` nesnede başka bir kod yürütülmeden önce yeni nesneler başlatmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="66036-142">`New` is a type of procedure called a `constructor` that is used to initialize new objects before any other code in an object executes.</span></span> <span data-ttu-id="66036-143">A `New` oluşturucusu, açık dosyalar, veritabanlarına bağlanmak, değişkenlerini başlatmak ve ilgilenebilmek nesnenin kullanılabilmesi için önce yerine getirilmesi gereken diğer görevler için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="66036-143">A `New` constructor can be used to open files, connect to databases, initialize variables, and take care of any other tasks that need to be done before an object can be used.</span></span>  
  
 <span data-ttu-id="66036-144">Türetilmiş bir sınıf örneği oluşturulduğunda, `Sub New` temel sınıfın Oluşturucusu yürütülmeden önce türetilmiş sınıflarda oluşturucular ve ardından.</span><span class="sxs-lookup"><span data-stu-id="66036-144">When an instance of a derived class is created, the `Sub New` constructor of the base class executes first, followed by constructors in derived classes.</span></span> <span data-ttu-id="66036-145">Çünkü böyle kod ilk satırı bir `Sub New` Oluşturucusu sözdizimini kullanan `MyBase.New()`sınıf hiyerarşisinde hemen kendisi üzerinde sınıf çağırmak için.</span><span class="sxs-lookup"><span data-stu-id="66036-145">This happens because the first line of code in a `Sub New` constructor uses the syntax `MyBase.New()`to call the constructor of the class immediately above itself in the class hierarchy.</span></span> <span data-ttu-id="66036-146">`Sub New` Oluşturucusu sonra çağrılır sınıf hiyerarşisindeki her sınıf için kadar oluşturucusu için temel sınıf ulaştı.</span><span class="sxs-lookup"><span data-stu-id="66036-146">The `Sub New` constructor is then called for each class in the class hierarchy until the constructor for the base class is reached.</span></span> <span data-ttu-id="66036-147">Bu noktada, temel sınıf yürütür için tüm türetilen sınıflar her oluşturucuda kodda Oluşturucusu kodda arkasından ve en çok türetilen sınıflar kodda son yürütülür.</span><span class="sxs-lookup"><span data-stu-id="66036-147">At that point, the code in the constructor for the base class executes, followed by the code in each constructor in all derived classes and the code in the most derived classes is executed last.</span></span>  
  
 <span data-ttu-id="66036-148">![Oluşturucular ve devralma](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance.gif "vaConstructorsInheritance")</span><span class="sxs-lookup"><span data-stu-id="66036-148">![Constructors and Inheritance](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance.gif "vaConstructorsInheritance")</span></span>  
  
 <span data-ttu-id="66036-149">Bir nesne artık gerekli olmadığında CLR çağırır <xref:System.Object.Finalize%2A> kendi bellek boşaltma önce bu nesne için yöntem.</span><span class="sxs-lookup"><span data-stu-id="66036-149">When an object is no longer needed, the CLR calls the <xref:System.Object.Finalize%2A> method for that object before freeing its memory.</span></span> <span data-ttu-id="66036-150"><xref:System.Object.Finalize%2A> Yöntemi çağrıldığında bir `destructor` durum bilgilerini kaydetme gibi temizleme görevleri gerçekleştirdiğinden dosyaları ve veritabanları ve nesneyi serbest bırakmadan önce gerçekleştirilmesi gereken diğer görevlere bağlantılar kapatma.</span><span class="sxs-lookup"><span data-stu-id="66036-150">The <xref:System.Object.Finalize%2A> method is called a `destructor` because it performs cleanup tasks, such as saving state information, closing files and connections to databases, and other tasks that must be done before releasing the object.</span></span>  
  
 <span data-ttu-id="66036-151">![Oluşturucular Inheritance2](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance_2.gif "vaConstructorsInheritance_2")</span><span class="sxs-lookup"><span data-stu-id="66036-151">![Constructors Inheritance2](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance_2.gif "vaConstructorsInheritance_2")</span></span>  
  
## <a name="idisposable-interface"></a><span data-ttu-id="66036-152">IDisposable arabirimi</span><span class="sxs-lookup"><span data-stu-id="66036-152">IDisposable Interface</span></span>  
 <span data-ttu-id="66036-153">Sınıf örnekleri genellikle Windows tanıtıcıları ve veritabanı bağlantıları gibi CLR tarafından yönetilmeyen kaynakları denetler.</span><span class="sxs-lookup"><span data-stu-id="66036-153">Class instances often control resources not managed by the CLR, such as Windows handles and database connections.</span></span> <span data-ttu-id="66036-154">Bu kaynaklar olarak da elden gerekir `Finalize` sınıfının yöntemi böylece nesne atık toplayıcısı tarafından bozulduğunda bunlar yayınlanacaktır.</span><span class="sxs-lookup"><span data-stu-id="66036-154">These resources must be disposed of in the `Finalize` method of the class, so that they will be released when the object is destroyed by the garbage collector.</span></span> <span data-ttu-id="66036-155">Ancak, yalnızca CLR daha fazla boş bellek gerektirdiğinde atık toplayıcı nesneleri yok eder.</span><span class="sxs-lookup"><span data-stu-id="66036-155">However, the garbage collector destroys objects only when the CLR requires more free memory.</span></span> <span data-ttu-id="66036-156">Bu nesne kapsam dışında devam ettiği sürece sonra kaynakları kadar yayımlanmayabilir olduğunu anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="66036-156">This means that the resources may not be released until long after the object goes out of scope.</span></span>  
  
 <span data-ttu-id="66036-157">Çöp toplama desteklemek üzere sınıflarınızı uyguladıkları sistem kaynaklarının etkin bir şekilde yönetmek için bir mekanizma sağlayabilir <xref:System.IDisposable> arabirimi.</span><span class="sxs-lookup"><span data-stu-id="66036-157">To supplement garbage collection, your classes can provide a mechanism to actively manage system resources if they implement the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="66036-158"><xref:System.IDisposable>bir yöntem, sahip <xref:System.IDisposable.Dispose%2A>, nesneyi kullanmayı bitirdiğinizde hangi istemcilerin çağrı.</span><span class="sxs-lookup"><span data-stu-id="66036-158"><xref:System.IDisposable> has one method, <xref:System.IDisposable.Dispose%2A>, which clients should call when they finish using an object.</span></span> <span data-ttu-id="66036-159">Kullanabileceğiniz <xref:System.IDisposable.Dispose%2A> hemen kaynakları serbest bırakmak ve dosyaları kapatma gibi görevleri gerçekleştirmek ve bağlantıları veritabanı yöntemi.</span><span class="sxs-lookup"><span data-stu-id="66036-159">You can use the <xref:System.IDisposable.Dispose%2A> method to immediately release resources and perform tasks such as closing files and database connections.</span></span> <span data-ttu-id="66036-160">Farklı `Finalize` yıkıcı <xref:System.IDisposable.Dispose%2A> yöntemi otomatik olarak çağrılmaz.</span><span class="sxs-lookup"><span data-stu-id="66036-160">Unlike the `Finalize` destructor, the <xref:System.IDisposable.Dispose%2A> method is not called automatically.</span></span> <span data-ttu-id="66036-161">İstemciler bir sınıfın açıkça çağırmalıdır <xref:System.IDisposable.Dispose%2A> hemen kaynakları serbest bırakmak istediğinizde.</span><span class="sxs-lookup"><span data-stu-id="66036-161">Clients of a class must explicitly call <xref:System.IDisposable.Dispose%2A> when you want to immediately release resources.</span></span>  
  
### <a name="implementing-idisposable"></a><span data-ttu-id="66036-162">IDisposable uygulayan</span><span class="sxs-lookup"><span data-stu-id="66036-162">Implementing IDisposable</span></span>  
 <span data-ttu-id="66036-163">Uygulayan bir sınıf <xref:System.IDisposable> arabirimi, bu kodun bölümlerini içermelidir:</span><span class="sxs-lookup"><span data-stu-id="66036-163">A class that implements the <xref:System.IDisposable> interface should include these sections of code:</span></span>  
  
-   <span data-ttu-id="66036-164">Nesne atıldı olup olmadığını izlemek için bir alan:</span><span class="sxs-lookup"><span data-stu-id="66036-164">A field for keeping track of whether the object has been disposed:</span></span>  
  
    ```  
    Protected disposed As Boolean = False  
    ```  
  
-   <span data-ttu-id="66036-165">Bir aşırı yüklemesini <xref:System.IDisposable.Dispose%2A> sınıfının kaynakları serbest bırakır.</span><span class="sxs-lookup"><span data-stu-id="66036-165">An overload of the <xref:System.IDisposable.Dispose%2A> that frees the class's resources.</span></span> <span data-ttu-id="66036-166">Bu yöntem çağrılmalıdır <xref:System.IDisposable.Dispose%2A> ve `Finalize` taban sınıf yöntemlerini:</span><span class="sxs-lookup"><span data-stu-id="66036-166">This method should be called by the <xref:System.IDisposable.Dispose%2A> and `Finalize` methods of the base class:</span></span>  
  
    ```  
    Protected Overridable Sub Dispose(ByVal disposing As Boolean)  
        If Not Me.disposed Then  
            If disposing Then  
                ' Insert code to free managed resources.  
            End If  
            ' Insert code to free unmanaged resources.  
        End If  
        Me.disposed = True  
    End Sub  
    ```  
  
-   <span data-ttu-id="66036-167">Uygulaması <xref:System.IDisposable.Dispose%2A> , yalnızca aşağıdaki kod içerir:</span><span class="sxs-lookup"><span data-stu-id="66036-167">An implementation of <xref:System.IDisposable.Dispose%2A> that contains only the following code:</span></span>  
  
    ```  
    Public Sub Dispose() Implements IDisposable.Dispose  
        Dispose(True)  
        GC.SuppressFinalize(Me)  
    End Sub  
    ```  
  
-   <span data-ttu-id="66036-168">Geçersiz kılma `Finalize` yalnızca aşağıdaki kodu içeren yöntemi:</span><span class="sxs-lookup"><span data-stu-id="66036-168">An override of the `Finalize` method that contains only the following code:</span></span>  
  
    ```  
    Protected Overrides Sub Finalize()  
        Dispose(False)  
        MyBase.Finalize()  
    End Sub  
    ```  
  
### <a name="deriving-from-a-class-that-implements-idisposable"></a><span data-ttu-id="66036-169">IDisposable uygulayan bir sınıftan türetme</span><span class="sxs-lookup"><span data-stu-id="66036-169">Deriving from a Class that Implements IDisposable</span></span>  
 <span data-ttu-id="66036-170">Arabirimini uygulayan bir taban sınıftan türeyen bir sınıf <xref:System.IDisposable> çıkarılması gereken ek kaynakları kullanmadıkça temel yöntemlerden herhangi birini geçersiz kılmak arabirimi gerekmez.</span><span class="sxs-lookup"><span data-stu-id="66036-170">A class that derives from a base class that implements the <xref:System.IDisposable> interface does not need to override any of the base methods unless it uses additional resources that need to be disposed.</span></span> <span data-ttu-id="66036-171">Bu durumda, temel sınıfın türetilmiş sınıf kılmalıdır `Dispose(disposing)` türetilen sınıfın kaynaklarını silmek için yöntem.</span><span class="sxs-lookup"><span data-stu-id="66036-171">In that situation, the derived class should override the base class's `Dispose(disposing)` method to dispose of the derived class's resources.</span></span> <span data-ttu-id="66036-172">Bu temel sınıfın çağırmalıdır `Dispose(disposing)` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="66036-172">This override must call the base class's `Dispose(disposing)` method.</span></span>  
  
```  
Protected Overrides Sub Dispose(ByVal disposing As Boolean)  
    If Not Me.disposed Then  
        If disposing Then  
            ' Insert code to free managed resources.  
        End If  
        ' Insert code to free unmanaged resources.  
    End If  
    MyBase.Dispose(disposing)  
End Sub  
```  
  
 <span data-ttu-id="66036-173">Türetilmiş bir sınıf, temel sınıfın kılmalıdır değil <xref:System.IDisposable.Dispose%2A> ve `Finalize` yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="66036-173">A derived class should not override the base class's <xref:System.IDisposable.Dispose%2A> and `Finalize` methods.</span></span> <span data-ttu-id="66036-174">Türetilmiş sınıf bir örnekten bu yöntem çağrıldığında bu yöntemlerden birini temel sınıfın uygulamayı çağırması türetilen sınıfın geçersiz kılma `Dispose(disposing)` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="66036-174">When those methods are called from an instance of the derived class, the base class's implementation of those methods call the derived class's override of the `Dispose(disposing)` method.</span></span>  
  
## <a name="garbage-collection-and-the-finalize-destructor"></a><span data-ttu-id="66036-175">Çöp toplama ve yıkıcı Sonlandır</span><span class="sxs-lookup"><span data-stu-id="66036-175">Garbage Collection and the Finalize Destructor</span></span>  
 <span data-ttu-id="66036-176">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Kullanan *başvuru izleme çöp toplama* düzenli aralıklarla kullanılmayan kaynakları serbest bırakmak için sistem.</span><span class="sxs-lookup"><span data-stu-id="66036-176">The [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] uses the *reference-tracing garbage collection* system to periodically release unused resources.</span></span> <span data-ttu-id="66036-177">Visual Basic 6.0 ve önceki sürümlerinde kullanılan olarak adlandırılan farklı bir sistem *başvuru sayımı* kaynakları yönetmek için.</span><span class="sxs-lookup"><span data-stu-id="66036-177">Visual Basic 6.0 and earlier versions used a different system called *reference counting* to manage resources.</span></span> <span data-ttu-id="66036-178">Her iki sistemle otomatik olarak aynı işlevi gerçekleştirir olmasa da, bazı önemli farklar vardır.</span><span class="sxs-lookup"><span data-stu-id="66036-178">Although both systems perform the same function automatically, there are a few important differences.</span></span>  
  
 <span data-ttu-id="66036-179">Sistem bu tür nesneler artık gerekli olduğunu belirlediğinde CLR düzenli aralıklarla nesneleri yok eder.</span><span class="sxs-lookup"><span data-stu-id="66036-179">The CLR periodically destroys objects when the system determines that such objects are no longer needed.</span></span> <span data-ttu-id="66036-180">Sistem kaynakları kısa tedarik ve daha az sıklıkta Aksi durumda olduğunda nesneleri daha hızlı bir şekilde yayınlanır.</span><span class="sxs-lookup"><span data-stu-id="66036-180">Objects are released more quickly when system resources are in short supply, and less frequently otherwise.</span></span> <span data-ttu-id="66036-181">Ne zaman bir nesne kapsam kaybeder ve ne zaman CLR bırakması arasındaki gecikme aksine, Visual Basic 6.0 ve önceki sürümlerinde, nesnelerle, tam olarak ne zaman nesne yok edilir belirleyemiyor, anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="66036-181">The delay between when an object loses scope and when the CLR releases it means that, unlike with objects in Visual Basic 6.0 and earlier versions, you cannot determine exactly when the object will be destroyed.</span></span> <span data-ttu-id="66036-182">Böyle bir durumda nesneleri sahip söylenir *belirleyici ömrü*.</span><span class="sxs-lookup"><span data-stu-id="66036-182">In such a situation, objects are said to have *non-deterministic lifetime*.</span></span> <span data-ttu-id="66036-183">Unutmamanız sürece çoğu durumda, belirleyici olmayan ömrü uygulamaları yazma biçimini değişmeyen `Finalize` yıkıcı değil hemen çalıştırılacak bir nesne kapsam kaybettiğinde.</span><span class="sxs-lookup"><span data-stu-id="66036-183">In most cases, non-deterministic lifetime does not change how you write applications, as long as you remember that the `Finalize` destructor may not immediately execute when an object loses scope.</span></span>  
  
 <span data-ttu-id="66036-184">Çöp toplama sistemleri arasında başka bir fark kullanmayı içerir `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="66036-184">Another difference between the garbage-collection systems involves the use of `Nothing`.</span></span> <span data-ttu-id="66036-185">Atanan bazen Programcı Başvuru Visual Basic 6.0 ve önceki sürümlerinde sayım yararlanmak için `Nothing` değişkenlere başvurularını serbest bırakmak için değişkenleri nesnesine tutulan.</span><span class="sxs-lookup"><span data-stu-id="66036-185">To take advantage of reference counting in Visual Basic 6.0 and earlier versions, programmers sometimes assigned `Nothing` to object variables to release the references those variables held.</span></span> <span data-ttu-id="66036-186">Değişkeni son nesnesine başvuru sahipse, nesnenin kaynakları hemen serbest bırakıldı.</span><span class="sxs-lookup"><span data-stu-id="66036-186">If the variable held the last reference to the object, the object's resources were released immediately.</span></span> <span data-ttu-id="66036-187">Bu yordamı hala değerli olduğu durumlar olsa Visual Basic sonraki sürümlerde, gerçekleştirmek hiçbir zaman hemen kaynaklarını serbest bırakmak referans verilen nesnenin neden olur.</span><span class="sxs-lookup"><span data-stu-id="66036-187">In later versions of Visual Basic, while there may be cases in which this procedure is still valuable, performing it never causes the referenced object to release its resources immediately.</span></span> <span data-ttu-id="66036-188">Hemen kaynakları serbest bırakmak için nesnenin kullanın <xref:System.IDisposable.Dispose%2A> yöntemi, varsa.</span><span class="sxs-lookup"><span data-stu-id="66036-188">To release resources immediately, use the object's <xref:System.IDisposable.Dispose%2A> method, if available.</span></span> <span data-ttu-id="66036-189">Yalnızca bir kez bir değişken ayarlamalıdır `Nothing` yaşam atık toplayıcı yalnız bırakılmış nesneleri algılamak için süresini için uzun göreli olur.</span><span class="sxs-lookup"><span data-stu-id="66036-189">The only time you should set a variable to `Nothing` is when its lifetime is long relative to the time the garbage collector takes to detect orphaned objects.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="66036-190">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="66036-190">See Also</span></span>  
 <xref:System.IDisposable.Dispose%2A>  
 [<span data-ttu-id="66036-191">Başlatma ve sonlandırma bileşenleri</span><span class="sxs-lookup"><span data-stu-id="66036-191">Initialization and Termination of Components</span></span>](http://msdn.microsoft.com/library/58444076-a9d2-4c91-b3f6-0e180dc0695d)  
 [<span data-ttu-id="66036-192">New işleci</span><span class="sxs-lookup"><span data-stu-id="66036-192">New Operator</span></span>](../../../../visual-basic/language-reference/operators/new-operator.md)  
 [<span data-ttu-id="66036-193">Yönetilmeyen kaynakları temizleme</span><span class="sxs-lookup"><span data-stu-id="66036-193">Cleaning Up Unmanaged Resources</span></span>](../../../../standard/garbage-collection/unmanaged.md)  
 [<span data-ttu-id="66036-194">Hiçbir şey</span><span class="sxs-lookup"><span data-stu-id="66036-194">Nothing</span></span>](../../../../visual-basic/language-reference/nothing.md)
