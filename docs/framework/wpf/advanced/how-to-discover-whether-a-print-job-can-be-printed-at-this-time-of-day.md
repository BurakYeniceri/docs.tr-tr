---
title: 'Nasıl yapılır: Günün Bu Saatinde Yazdırmanın Yapılıp Yapılmayacağını Keşfetme'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
ms.openlocfilehash: e5ea5ad3bcb10bfbc091f0b5852ee181a2c3fa8a
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33548041"
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="4393e-102">Nasıl yapılır: Günün Bu Saatinde Yazdırmanın Yapılıp Yapılmayacağını Keşfetme</span><span class="sxs-lookup"><span data-stu-id="4393e-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="4393e-103">Yazdırma sıralarını her zaman günde 24 saat için kullanılabilir değil.</span><span class="sxs-lookup"><span data-stu-id="4393e-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="4393e-104">Günün belirli zamanlarında kullanılamaz duruma getirmek için ayarlanabilir başlangıç ve bitiş zamanı özellikleri sahiptirler.</span><span class="sxs-lookup"><span data-stu-id="4393e-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="4393e-105">Bu özellik, örneğin, belirli bir bölüm 17: 00 sonra özel kullanım için bir yazıcı ayırmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="4393e-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="4393e-106">Bu bölüm Kullan yazıcı diğer departmanlardan daha bakım farklı bir sıra gerekir.</span><span class="sxs-lookup"><span data-stu-id="4393e-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="4393e-107">Diğer bölümler için sıra 17: 00 sonra kullanılamaz hale gelmesine ayarlanması, ayrıcalıklı bölümün sırası olacak şekilde ayarlanması kullanılabilir hiç uğruyor.</span><span class="sxs-lookup"><span data-stu-id="4393e-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="4393e-108">Ayrıca, yazdırma işleri kendilerini yalnızca bir belirtilen zaman dilimi içinde yazdırılabilir olarak ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="4393e-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="4393e-109"><xref:System.Printing.PrintQueue> Ve <xref:System.Printing.PrintSystemJobInfo> sınıfları ortaya çıkarılan [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] uzaktan belirli bir yazdırma işi şu anda üzerinde belirli bir sıradaki yazdırabilir olup olmadığını denetlemek için Microsoft .NET Framework'ü bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="4393e-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of Microsoft .NET Framework provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="4393e-110">Örnek</span><span class="sxs-lookup"><span data-stu-id="4393e-110">Example</span></span>  
 <span data-ttu-id="4393e-111">Aşağıdaki örnek, bir yazdırma işi sorunları tanılayabilirsiniz bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="4393e-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="4393e-112">Aşağıdaki gibi bu tür bir işlev için iki ana adım vardır.</span><span class="sxs-lookup"><span data-stu-id="4393e-112">There are two major steps for this kind of function as follows.</span></span>  
  
1.  <span data-ttu-id="4393e-113">Okuma <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> ve <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> özelliklerini <xref:System.Printing.PrintQueue> geçerli zamanın aralarında olup olmadığını belirlemek için.</span><span class="sxs-lookup"><span data-stu-id="4393e-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2.  <span data-ttu-id="4393e-114">Okuma <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> ve <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> özelliklerini <xref:System.Printing.PrintSystemJobInfo> geçerli zamanın aralarında olup olmadığını belirlemek için.</span><span class="sxs-lookup"><span data-stu-id="4393e-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="4393e-115">Ancak zorluklar bu özellikleri olmayan zorluk ortaya çıkan <xref:System.DateTime> nesneleri.</span><span class="sxs-lookup"><span data-stu-id="4393e-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="4393e-116">Bunun yerine oldukları <xref:System.Int32> günün saatini gece yarısından itibaren dakika sayısı olarak ifade nesneleri.</span><span class="sxs-lookup"><span data-stu-id="4393e-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="4393e-117">Ayrıca, bu gece geçerli saat dilimi, ancak gece yarısı UTC (Eşgüdümlü Evrensel Saat) içinde değil.</span><span class="sxs-lookup"><span data-stu-id="4393e-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="4393e-118">İlk örnek kod statik yöntemini sunar **ReportQueueAndJobAvailability**, hangi geçirilen bir <xref:System.Printing.PrintSystemJobInfo> ve iş şu anda yazdırabilir olup olmadığını belirlemek için yardımcı yöntemler çağırır ve değil, ne zaman yazdırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4393e-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="4393e-119">Dikkat bir <xref:System.Printing.PrintQueue> yönteme geçirilen değil.</span><span class="sxs-lookup"><span data-stu-id="4393e-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="4393e-120">Bunun nedeni, <xref:System.Printing.PrintSystemJobInfo> sırada için referans içeriyor, <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> özelliği.</span><span class="sxs-lookup"><span data-stu-id="4393e-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="4393e-121">Bağımlı yöntemlerini aşırı yüklenmiş dahil **ReportAvailabilityAtThisTime** alabilen yöntemi bir <xref:System.Printing.PrintQueue> veya <xref:System.Printing.PrintSystemJobInfo> bir parametre olarak.</span><span class="sxs-lookup"><span data-stu-id="4393e-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="4393e-122">Ayrıca bir **TimeConverter.ConvertToLocalHumanReadableTime**.</span><span class="sxs-lookup"><span data-stu-id="4393e-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="4393e-123">Tüm bu yöntemleri aşağıda ele alınmıştır.</span><span class="sxs-lookup"><span data-stu-id="4393e-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="4393e-124">**ReportQueueAndJobAvailability** yöntemi başlar sıranın veya yazdırma işi şu anda kullanılamaz durumda olup olmadığını kontrol ederek.</span><span class="sxs-lookup"><span data-stu-id="4393e-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="4393e-125">İkisinden biri kullanılamıyorsa, ardından bakar sıranın kullanılamaz.</span><span class="sxs-lookup"><span data-stu-id="4393e-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="4393e-126">Kullanılabilir durumda değilse, yöntem bu olgu ve ne zaman sıranın yeniden kullanılabilir olacağı zamanı raporlar.</span><span class="sxs-lookup"><span data-stu-id="4393e-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="4393e-127">Sonra işi denetler ve kullanılabilir durumda değilse, sonraki raporlar yazdırabileceği yazdırabilirsiniz sırasında.</span><span class="sxs-lookup"><span data-stu-id="4393e-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="4393e-128">Son olarak, yöntem işin ne zaman yazdırabilir erken zamanı raporlar.</span><span class="sxs-lookup"><span data-stu-id="4393e-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="4393e-129">Bu sonraki iki kez olur.</span><span class="sxs-lookup"><span data-stu-id="4393e-129">This is the later of following two times.</span></span>  
  
-   <span data-ttu-id="4393e-130">Yazdırma sırasını sonraki kullanılabilir olduğunda süre.</span><span class="sxs-lookup"><span data-stu-id="4393e-130">The time when the print queue is next available.</span></span>  
  
-   <span data-ttu-id="4393e-131">Yazdırma işi sonraki kullanılabilir olduğunda süre.</span><span class="sxs-lookup"><span data-stu-id="4393e-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="4393e-132">Saatlerinde bildirilirken <xref:System.DateTime.ToShortTimeString%2A> yöntemi olarak da adlandırılır çünkü bu yöntem yıl, ay ve gün çıktısından bastırır.</span><span class="sxs-lookup"><span data-stu-id="4393e-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="4393e-133">Bir yazdırma sırası veya yazdırma işi kullanılabilirliğini belirli yıl, ay ve gün için kısıtlayamazsınız.</span><span class="sxs-lookup"><span data-stu-id="4393e-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="4393e-134">İki overloads **ReportAvailabilityAtThisTime** yöntemi yalnızca onlara, geçirilen türü dışında aynı <xref:System.Printing.PrintQueue> sürümü aşağıda sunulur.</span><span class="sxs-lookup"><span data-stu-id="4393e-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4393e-135">Örnek bir genel yöntem oluşturmaz neden yöntemleri dışında birbirinin olgu sorunuz başlatır **ReportAvailabilityAtThisTime\<T >**.</span><span class="sxs-lookup"><span data-stu-id="4393e-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="4393e-136">Bu tür bir yöntem olan bir sınıfı kısıtlı olması gerektiğini nedeni **StartTimeOfDay** ve **UntilTimeOfDay** yöntemini çağırır özellikler, ancak genel yöntem yalnızca olabilir sınırlı bir tek ve ortak yalnızca sınıf <xref:System.Printing.PrintQueue> ve <xref:System.Printing.PrintSystemJobInfo> devralma ağacıdır <xref:System.Printing.PrintSystemObject> gibi özellikleri vardır.</span><span class="sxs-lookup"><span data-stu-id="4393e-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="4393e-137">**ReportAvailabilityAtThisTime** yöntemi (aşağıdaki kod örneğinde sunulan) başlar başlatarak bir <xref:System.Boolean> sentinel değişkenini `true`.</span><span class="sxs-lookup"><span data-stu-id="4393e-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="4393e-138">İçin sıfırlanır `false`, sıranın kullanılabilir değilse.</span><span class="sxs-lookup"><span data-stu-id="4393e-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="4393e-139">Ardından, yöntem bakar Başlat ve "kadar" kez aynıdır.</span><span class="sxs-lookup"><span data-stu-id="4393e-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="4393e-140">Olmaları durumunda yöntemi döndürecek şekilde sıranın her zaman kullanılabilir `true`.</span><span class="sxs-lookup"><span data-stu-id="4393e-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="4393e-141">Sıranın her zaman kullanılabilir durumda değilse, statik kullanmaktadır <xref:System.DateTime.UtcNow%2A> geçerli saati olarak alma özelliği bir <xref:System.DateTime> nesnesi.</span><span class="sxs-lookup"><span data-stu-id="4393e-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="4393e-142">(Yerel saat çünkü ihtiyacımız değil <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> ve <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> özelliklerdir kendilerini UTC saati.)</span><span class="sxs-lookup"><span data-stu-id="4393e-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="4393e-143">Ancak, bu iki özellik olmayan <xref:System.DateTime> nesneleri.</span><span class="sxs-lookup"><span data-stu-id="4393e-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="4393e-144">Bunlar <xref:System.Int32>zamanı dakika sonra UTC gece sayısı olarak ifade s.</span><span class="sxs-lookup"><span data-stu-id="4393e-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="4393e-145">Biz dönüştürmeniz gerekir böylece bizim <xref:System.DateTime> dakika sonra gece yarısına nesnesi.</span><span class="sxs-lookup"><span data-stu-id="4393e-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="4393e-146">Yapıldığında, yöntemi yalnızca "şimdi olup olmadığını" görmek için "kadar" false "şimdi ise" sentinel arasında iki kez değil ve sentinel döndürür kümeleri zamanlarının sıranın başlangıcı arasında olduğunu denetler.</span><span class="sxs-lookup"><span data-stu-id="4393e-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="4393e-147">**TimeConverter.ConvertToLocalHumanReadableTime** yöntemi (aşağıdaki kod örneğinde sunulan) tartışma kısa olacak şekilde Microsoft .NET Framework ile sunulan tüm yöntemleri kullanmaz.</span><span class="sxs-lookup"><span data-stu-id="4393e-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with Microsoft .NET Framework, so the discussion is brief.</span></span> <span data-ttu-id="4393e-148">Çift dönüştürme görevi yöntemi vardır: dakika sonra gece yarısı ifade eden bir tamsayı olması gerekir ve okunabilir bir zamana dönüştürmek ve bunu bunu yerel saat dönüştürmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4393e-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="4393e-149">Bu ilk oluşturarak tamamlanır bir <xref:System.DateTime> ve sonra kullanan gece yarısına ayarlanmış nesne <xref:System.DateTime.AddMinutes%2A> yöntemine iletilmiş dakika ekleme yöntemi.</span><span class="sxs-lookup"><span data-stu-id="4393e-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="4393e-150">Bu yeni bir döndürür <xref:System.DateTime> yönteme geçirilen özgün zamanı ifade.</span><span class="sxs-lookup"><span data-stu-id="4393e-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="4393e-151"><xref:System.DateTime.ToLocalTime%2A> Yöntemi sonra yerel saate bu dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="4393e-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="4393e-152">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="4393e-152">See Also</span></span>  
 <xref:System.DateTime>  
 <xref:System.Printing.PrintSystemJobInfo>  
 <xref:System.Printing.PrintQueue>  
 [<span data-ttu-id="4393e-153">WPF'deki Belgeler</span><span class="sxs-lookup"><span data-stu-id="4393e-153">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="4393e-154">Yazdırmaya Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="4393e-154">Printing Overview</span></span>](../../../../docs/framework/wpf/advanced/printing-overview.md)
