---
title: "Nasıl yapılır: Özel Güvenlik Belirteci Kimlik Doğrulayıcı Oluşturma"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords: WCF, authentication
ms.assetid: 10e245f7-d31e-42e7-82a2-d5780325d372
caps.latest.revision: "12"
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.workload: dotnet
ms.openlocfilehash: eedb351e5651ffc2637c413450db40ff5a59d516
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/22/2017
---
# <a name="how-to-create-a-custom-security-token-authenticator"></a><span data-ttu-id="5322b-102">Nasıl yapılır: Özel Güvenlik Belirteci Kimlik Doğrulayıcı Oluşturma</span><span class="sxs-lookup"><span data-stu-id="5322b-102">How to: Create a Custom Security Token Authenticator</span></span>
<span data-ttu-id="5322b-103">Bu konuda bir özel güvenlik belirteci kimlik doğrulayıcı oluşturma ve bir özel güvenlik belirteci manager ile tümleştirerek gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="5322b-103">This topic shows how to create a custom security token authenticator and how to integrate it with a custom security token manager.</span></span> <span data-ttu-id="5322b-104">Bir güvenlik belirteci kimlik doğrulayıcı gelen ileti ile sağlanan bir güvenlik belirteci içeriğini doğrular.</span><span class="sxs-lookup"><span data-stu-id="5322b-104">A security token authenticator validates the content of a security token provided with an incoming message.</span></span> <span data-ttu-id="5322b-105">Doğrulama başarılı olursa, Doğrulayıcı koleksiyonunu döndürür <xref:System.IdentityModel.Policy.IAuthorizationPolicy> , değerlendirildiğinde, örnekler talep kümesini döndürür.</span><span class="sxs-lookup"><span data-stu-id="5322b-105">If the validation succeeds, the authenticator returns a collection of <xref:System.IdentityModel.Policy.IAuthorizationPolicy> instances that, when evaluated, returns a set of claims.</span></span>  
  
 <span data-ttu-id="5322b-106">İçinde bir özel güvenlik belirteci kimlik doğrulayıcı kullanmak için [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], önce özel kimlik bilgileri ve güvenlik belirteci Yöneticisi uygulamaları oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="5322b-106">To use a custom security token authenticator in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], you must first create custom credentials and security token manager implementations.</span></span> <span data-ttu-id="5322b-107">Özel kimlik bilgileri ve bir güvenlik belirteci yöneticisi oluşturma hakkında daha fazla bilgi için bkz: [izlenecek yol: özel istemci oluşturma ve hizmet kimlik bilgilerini](../../../../docs/framework/wcf/extending/walkthrough-creating-custom-client-and-service-credentials.md).</span><span class="sxs-lookup"><span data-stu-id="5322b-107">For more information about creating custom credentials and a security token manager, see [Walkthrough: Creating Custom Client and Service Credentials](../../../../docs/framework/wcf/extending/walkthrough-creating-custom-client-and-service-credentials.md).</span></span> <span data-ttu-id="5322b-108">Kimlik bilgileri, güvenlik belirteci yöneticisi ve sağlayıcı ve Doğrulayıcı sınıfları hakkında daha fazla bilgi için bkz: [güvenlik mimarisi](http://msdn.microsoft.com/en-us/16593476-d36a-408d-808c-ae6fd483e28f).</span><span class="sxs-lookup"><span data-stu-id="5322b-108">For more information about credentials, security token manager, and provider and authenticator classes, see [Security Architecture](http://msdn.microsoft.com/en-us/16593476-d36a-408d-808c-ae6fd483e28f).</span></span>  
  
## <a name="procedures"></a><span data-ttu-id="5322b-109">Yordamlar</span><span class="sxs-lookup"><span data-stu-id="5322b-109">Procedures</span></span>  
  
#### <a name="to-create-a-custom-security-token-authenticator"></a><span data-ttu-id="5322b-110">Özel güvenlik belirteci kimlik doğrulayıcısı oluşturmak için</span><span class="sxs-lookup"><span data-stu-id="5322b-110">To create a custom security token authenticator</span></span>  
  
1.  <span data-ttu-id="5322b-111">Türetilen yeni bir sınıf tanımlama <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="5322b-111">Define a new class derived from the <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator> class.</span></span>  
  
2.  <span data-ttu-id="5322b-112">Geçersiz kılma <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator.CanValidateTokenCore%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5322b-112">Override the <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator.CanValidateTokenCore%2A> method.</span></span> <span data-ttu-id="5322b-113">Yöntem `true` veya `false` bağlı olup olmadığını özel Doğrulayıcı gelen belirteç türü veya doğrulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5322b-113">The method returns `true` or `false` depending on whether the custom authenticator can validate the incoming token type or not.</span></span>  
  
3.  <span data-ttu-id="5322b-114">Geçersiz kılma <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator.ValidateTokenCore%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5322b-114">Override the <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator.ValidateTokenCore%2A> method.</span></span> <span data-ttu-id="5322b-115">Belirteç içerikleri uygun şekilde doğrulamak bu yöntem gerekir.</span><span class="sxs-lookup"><span data-stu-id="5322b-115">This method needs to validate the token contents appropriately.</span></span> <span data-ttu-id="5322b-116">Belirteç doğrulama adımını geçerse, bir koleksiyonunu döndürür <xref:System.IdentityModel.Policy.IAuthorizationPolicy> örnekleri.</span><span class="sxs-lookup"><span data-stu-id="5322b-116">If the token passes the validation step, it returns a collection of <xref:System.IdentityModel.Policy.IAuthorizationPolicy> instances.</span></span> <span data-ttu-id="5322b-117">Aşağıdaki örnek bir sonraki yordamda oluşturduğunuz özel yetkilendirme ilkesi uygulaması kullanır.</span><span class="sxs-lookup"><span data-stu-id="5322b-117">The following example uses a custom authorization policy implementation that will be created in the next procedure.</span></span>  
  
     [!code-csharp[C_CustomTokenAuthenticator#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customtokenauthenticator/cs/source.cs#1)]
     [!code-vb[C_CustomTokenAuthenticator#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customtokenauthenticator/vb/source.vb#1)]  
  
 <span data-ttu-id="5322b-118">Önceki kod Yetkilendirme İlkeleri koleksiyonunu döndürür <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator.CanValidateToken%28System.IdentityModel.Tokens.SecurityToken%29> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5322b-118">The previous code returns a collection of authorization policies in the <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator.CanValidateToken%28System.IdentityModel.Tokens.SecurityToken%29> method.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5322b-119">Bu arabirimin ortak bir uygulama sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="5322b-119"> does not provide a public implementation of this interface.</span></span> <span data-ttu-id="5322b-120">Aşağıdaki yordamda, kendi gereksinimlerinizi için bunu gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="5322b-120">The following procedure shows how to do so for your own requirements.</span></span>  
  
#### <a name="to-create-a-custom-authorization-policy"></a><span data-ttu-id="5322b-121">Bir özel yetkilendirme ilkesi oluşturmak için</span><span class="sxs-lookup"><span data-stu-id="5322b-121">To create a custom authorization policy</span></span>  
  
1.  <span data-ttu-id="5322b-122">Yeni bir sınıf uygulama tanımlamak <xref:System.IdentityModel.Policy.IAuthorizationPolicy> arabirimi.</span><span class="sxs-lookup"><span data-stu-id="5322b-122">Define a new class implementing the <xref:System.IdentityModel.Policy.IAuthorizationPolicy> interface.</span></span>  
  
2.  <span data-ttu-id="5322b-123">Uygulama <xref:System.IdentityModel.Policy.IAuthorizationComponent.Id%2A> özelliği salt okunur.</span><span class="sxs-lookup"><span data-stu-id="5322b-123">Implement the <xref:System.IdentityModel.Policy.IAuthorizationComponent.Id%2A> read-only property.</span></span> <span data-ttu-id="5322b-124">Bu özelliği uygulamak için bir sınıf oluşturucuda bir genel benzersiz tanımlayıcı (GUID) oluşturmak ve bu özellik için değer her istendiğinde dönmek için yoludur.</span><span class="sxs-lookup"><span data-stu-id="5322b-124">One way to implement this property is to generate a globally unique identifier (GUID) in the class constructor and return it every time the value for this property is requested.</span></span>  
  
3.  <span data-ttu-id="5322b-125">Uygulama <xref:System.IdentityModel.Policy.IAuthorizationPolicy.Issuer%2A> özelliği salt okunur.</span><span class="sxs-lookup"><span data-stu-id="5322b-125">Implement the <xref:System.IdentityModel.Policy.IAuthorizationPolicy.Issuer%2A> read-only property.</span></span> <span data-ttu-id="5322b-126">Bu özellik, bir veren belirtecinden elde edilen talep kümelerinin döndürmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="5322b-126">This property needs to return an issuer of the claim sets that are obtained from the token.</span></span> <span data-ttu-id="5322b-127">Bu veren belirteç veya belirteç içerikleri doğrulamak için sorumlu olduğu bir yetki veren karşılık gelmelidir.</span><span class="sxs-lookup"><span data-stu-id="5322b-127">This issuer should correspond to the issuer of the token or an authority that is responsible for validating the token contents.</span></span> <span data-ttu-id="5322b-128">Aşağıdaki örnek, önceki yordamda oluşturduğunuz özel güvenlik belirteci kimlik doğrulayıcı öğesinden bu sınıfa geçirilen verenin talep kullanır.</span><span class="sxs-lookup"><span data-stu-id="5322b-128">The following example uses the issuer claim that passed to this class from the custom security token authenticator created in the previous procedure.</span></span> <span data-ttu-id="5322b-129">Özel güvenlik belirteci kimlik doğrulayıcı sistem tarafından sağlanan talep kümesi kullanır (tarafından döndürülen <xref:System.IdentityModel.Claims.ClaimSet.System%2A> özelliği) kullanıcıadı Belirteç Verenin temsil etmek için.</span><span class="sxs-lookup"><span data-stu-id="5322b-129">The custom security token authenticator uses the system-provided claim set (returned by the <xref:System.IdentityModel.Claims.ClaimSet.System%2A> property) to represent the issuer of the username token.</span></span>  
  
4.  <span data-ttu-id="5322b-130">Uygulama <xref:System.IdentityModel.Policy.IAuthorizationPolicy.Evaluate%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5322b-130">Implement the <xref:System.IdentityModel.Policy.IAuthorizationPolicy.Evaluate%2A> method.</span></span> <span data-ttu-id="5322b-131">Bu yöntem örneği doldurur <xref:System.IdentityModel.Policy.EvaluationContext> gelen güvenlik belirteci içeriğine göre taleplerle sınıfı (bağımsız değişken olarak geçirilen).</span><span class="sxs-lookup"><span data-stu-id="5322b-131">This method populates an instance of the <xref:System.IdentityModel.Policy.EvaluationContext> class (passed in as an argument) with claims that are based on the incoming security token content.</span></span> <span data-ttu-id="5322b-132">Yöntem `true` zaman onu yapılır ile değerlendirme.</span><span class="sxs-lookup"><span data-stu-id="5322b-132">The method returns `true` when it is done with the evaluation.</span></span> <span data-ttu-id="5322b-133">Bu yöntemi uygulaması değerlendirme bağlam için ek bilgiler sağlayan diğer yetkilendirme ilkeleri varlığına bağımlıdır zaman durumlarda geri dönebilirsiniz `false` gerekli bilgiler yoksa, değerlendirme bağlamında henüz.</span><span class="sxs-lookup"><span data-stu-id="5322b-133">In cases when the implementation relies on the presence of other authorization policies that provide additional information to the evaluation context, this method can return `false` if the required information is not present yet in the evaluation context.</span></span> <span data-ttu-id="5322b-134">Bu durumda, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] bu Yetkilendirme İlkeleri en az biri değerlendirme bağlamı değiştirilirse gelen ileti için oluşturulan tüm diğer yetkilendirme ilkeleri değerlendirdikten sonra yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="5322b-134">In that case, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] will call the method again after evaluating all other authorization policies generated for the incoming message if at least one of those authorization policies modified the evaluation context.</span></span>  
  
     [!code-csharp[c_CustomTokenAuthenticator#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customtokenauthenticator/cs/source.cs#2)]
     [!code-vb[c_CustomTokenAuthenticator#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customtokenauthenticator/vb/source.vb#2)]  
  
 <span data-ttu-id="5322b-135">[İzlenecek yol: Özel istemci ve hizmet kimlik bilgilerini oluşturma](../../../../docs/framework/wcf/extending/walkthrough-creating-custom-client-and-service-credentials.md) özel kimlik bilgileri ve özel bir güvenlik belirteci yöneticisi nasıl oluşturulacağını açıklar.</span><span class="sxs-lookup"><span data-stu-id="5322b-135">[Walkthrough: Creating Custom Client and Service Credentials](../../../../docs/framework/wcf/extending/walkthrough-creating-custom-client-and-service-credentials.md) describes how to create custom credentials and a custom security token manager.</span></span> <span data-ttu-id="5322b-136">Oluşturulan özel güvenlik belirteci kimlik doğrulayıcı kullanmak için burada, güvenlik belirteci Yöneticisi uygulaması özel doğrulayıcıdan döndürecek şekilde değiştirilir <xref:System.IdentityModel.Selectors.SecurityTokenManager.CreateSecurityTokenAuthenticator%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5322b-136">To use the custom security token authenticator created here, an implementation of the security token manager is modified to return the custom authenticator from the <xref:System.IdentityModel.Selectors.SecurityTokenManager.CreateSecurityTokenAuthenticator%2A> method.</span></span> <span data-ttu-id="5322b-137">Yöntem uygun güvenlik belirteci gereksinimi geçirilen bir kimlik doğrulayıcı döndürür.</span><span class="sxs-lookup"><span data-stu-id="5322b-137">The method returns an authenticator when an appropriate security token requirement is passed in.</span></span>  
  
#### <a name="to-integrate-a-custom-security-token-authenticator-with-a-custom-security-token-manager"></a><span data-ttu-id="5322b-138">Özel güvenlik belirteci kimlik doğrulayıcı özel güvenlik belirteci yöneticisi ile tümleştirmek için</span><span class="sxs-lookup"><span data-stu-id="5322b-138">To integrate a custom security token authenticator with a custom security token manager</span></span>  
  
1.  <span data-ttu-id="5322b-139">Geçersiz kılma <xref:System.IdentityModel.Selectors.SecurityTokenManager.CreateSecurityTokenAuthenticator%2A> özel güvenlik belirteci yöneticisi uygulamanızda yöntemi.</span><span class="sxs-lookup"><span data-stu-id="5322b-139">Override the <xref:System.IdentityModel.Selectors.SecurityTokenManager.CreateSecurityTokenAuthenticator%2A> method in your custom security token manager implementation.</span></span>  
  
2.  <span data-ttu-id="5322b-140">Temel, özel güvenlik belirteci kimlik doğrulayıcı döndürülecek etkinleştirmek için yöntemi mantık eklemek <xref:System.IdentityModel.Selectors.SecurityTokenRequirement> parametresi.</span><span class="sxs-lookup"><span data-stu-id="5322b-140">Add logic to the method to enable it to return your custom security token authenticator based on the <xref:System.IdentityModel.Selectors.SecurityTokenRequirement> parameter.</span></span> <span data-ttu-id="5322b-141">Belirteç gereksinimlerini belirteç türü bir kullanıcı adı aşağıdaki örnekte bir özel güvenlik belirteci kimlik doğrulayıcı döndürür (tarafından temsil edilen <xref:System.IdentityModel.Tokens.SecurityTokenTypes.UserName%2A> özelliği) ve kendisi için güvenlik belirteci kimlik doğrulayıcı isteniyor ileti yönü giriş () tarafından temsil edilen <xref:System.ServiceModel.Description.MessageDirection.Input> alan).</span><span class="sxs-lookup"><span data-stu-id="5322b-141">The following example returns a custom security token authenticator if the token requirements token type is a user name (represented by the <xref:System.IdentityModel.Tokens.SecurityTokenTypes.UserName%2A> property) and the message direction for which the security token authenticator is being requested is input (represented by the <xref:System.ServiceModel.Description.MessageDirection.Input> field).</span></span>  
  
     [!code-csharp[c_CustomTokenAuthenticator#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_customtokenauthenticator/cs/source.cs#3)]
     [!code-vb[c_CustomTokenAuthenticator#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_customtokenauthenticator/vb/source.vb#3)]  
  
## <a name="see-also"></a><span data-ttu-id="5322b-142">Ayrıca Bkz.</span><span class="sxs-lookup"><span data-stu-id="5322b-142">See Also</span></span>  
 <xref:System.IdentityModel.Selectors.SecurityTokenAuthenticator>  
 <xref:System.IdentityModel.Selectors.SecurityTokenRequirement>  
 <xref:System.IdentityModel.Selectors.SecurityTokenManager>  
 <xref:System.IdentityModel.Tokens.UserNameSecurityToken>  
 [<span data-ttu-id="5322b-143">İzlenecek Yol: Özel İstemci ve Hizmet Kimlik Bilgileri Oluşturma</span><span class="sxs-lookup"><span data-stu-id="5322b-143">Walkthrough: Creating Custom Client and Service Credentials</span></span>](../../../../docs/framework/wcf/extending/walkthrough-creating-custom-client-and-service-credentials.md)  
 [<span data-ttu-id="5322b-144">Nasıl yapılır: Özel Güvenlik Belirteci Sağlayıcı Oluşturma</span><span class="sxs-lookup"><span data-stu-id="5322b-144">How to: Create a Custom Security Token Provider</span></span>](../../../../docs/framework/wcf/extending/how-to-create-a-custom-security-token-provider.md)  
 [<span data-ttu-id="5322b-145">Güvenlik mimarisi</span><span class="sxs-lookup"><span data-stu-id="5322b-145">Security Architecture</span></span>](http://msdn.microsoft.com/en-us/16593476-d36a-408d-808c-ae6fd483e28f)
